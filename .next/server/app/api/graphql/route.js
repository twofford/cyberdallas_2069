/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/graphql/route";
exports.ids = ["app/api/graphql/route"];
exports.modules = {

/***/ "(rsc)/./app/api/graphql/route.ts":
/*!**********************************!*\
  !*** ./app/api/graphql/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var _graphql_yoga__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/graphql/yoga */ \"(rsc)/./src/graphql/yoga.ts\");\n\nconst runtime = 'nodejs';\nconst dynamic = 'force-dynamic';\nconst yoga = (0,_graphql_yoga__WEBPACK_IMPORTED_MODULE_0__.createYogaServer)();\nasync function GET(request) {\n    return yoga.fetch(request);\n}\nasync function POST(request) {\n    return yoga.fetch(request);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2dyYXBocWwvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBa0Q7QUFFM0MsTUFBTUMsVUFBVSxTQUFTO0FBQ3pCLE1BQU1DLFVBQVUsZ0JBQWdCO0FBRXZDLE1BQU1DLE9BQU9ILCtEQUFnQkE7QUFFdEIsZUFBZUksSUFBSUMsT0FBZ0I7SUFDeEMsT0FBT0YsS0FBS0csS0FBSyxDQUFDRDtBQUNwQjtBQUVPLGVBQWVFLEtBQUtGLE9BQWdCO0lBQ3pDLE9BQU9GLEtBQUtHLEtBQUssQ0FBQ0Q7QUFDcEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9hcHAvYXBpL2dyYXBocWwvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlWW9nYVNlcnZlciB9IGZyb20gJ0AvZ3JhcGhxbC95b2dhJztcblxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSAnbm9kZWpzJztcbmV4cG9ydCBjb25zdCBkeW5hbWljID0gJ2ZvcmNlLWR5bmFtaWMnO1xuXG5jb25zdCB5b2dhID0gY3JlYXRlWW9nYVNlcnZlcigpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgcmV0dXJuIHlvZ2EuZmV0Y2gocmVxdWVzdCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgcmV0dXJuIHlvZ2EuZmV0Y2gocmVxdWVzdCk7XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlWW9nYVNlcnZlciIsInJ1bnRpbWUiLCJkeW5hbWljIiwieW9nYSIsIkdFVCIsInJlcXVlc3QiLCJmZXRjaCIsIlBPU1QiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/graphql/route.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/@whatwg-node/fetch/dist sync recursive":
/*!****************************************************!*\
  !*** ./node_modules/@whatwg-node/fetch/dist/ sync ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/@whatwg-node/fetch/dist sync recursive";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgraphql%2Froute&page=%2Fapi%2Fgraphql%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgraphql%2Froute.ts&appDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgraphql%2Froute&page=%2Fapi%2Fgraphql%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgraphql%2Froute.ts&appDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _Users_taylorwofford_Desktop_cyberdallas_2069_app_api_graphql_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/graphql/route.ts */ \"(rsc)/./app/api/graphql/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/graphql/route\",\n        pathname: \"/api/graphql\",\n        filename: \"route\",\n        bundlePath: \"app/api/graphql/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/Users/taylorwofford/Desktop/cyberdallas_2069/app/api/graphql/route.ts\",\n    nextConfigOutput,\n    userland: _Users_taylorwofford_Desktop_cyberdallas_2069_app_api_graphql_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/graphql/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZncmFwaHFsJTJGcm91dGUmcGFnZT0lMkZhcGklMkZncmFwaHFsJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZ3JhcGhxbCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnRheWxvcndvZmZvcmQlMkZEZXNrdG9wJTJGY3liZXJkYWxsYXNfMjA2OSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZ0YXlsb3J3b2Zmb3JkJTJGRGVza3RvcCUyRmN5YmVyZGFsbGFzXzIwNjkmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QmaXNHbG9iYWxOb3RGb3VuZEVuYWJsZWQ9ISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUNkO0FBQ1M7QUFDTztBQUNLO0FBQ21DO0FBQ2pEO0FBQ087QUFDZjtBQUNzQztBQUN6QjtBQUNNO0FBQ0M7QUFDaEI7QUFDaUM7QUFDbkc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsYUFBYSxPQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9EO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFD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QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ04sNkJBQTZCLDZGQUFlO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvdGF5bG9yd29mZm9yZC9EZXNrdG9wL2N5YmVyZGFsbGFzXzIwNjkvYXBwL2FwaS9ncmFwaHFsL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9ncmFwaHFsL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ3JhcGhxbFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ3JhcGhxbC9yb3V0ZVwiXG4gICAgfSxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvdGF5bG9yd29mZm9yZC9EZXNrdG9wL2N5YmVyZGFsbGFzXzIwNjkvYXBwL2FwaS9ncmFwaHFsL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIHZhciBfbmV4dENvbmZpZ19leHBlcmltZW50YWw7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvZ3JhcGhxbC9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgraphql%2Froute&page=%2Fapi%2Fgraphql%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgraphql%2Froute.ts&appDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/db/prisma.ts":
/*!**************************!*\
  !*** ./src/db/prisma.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getPrismaClient: () => (/* binding */ getPrismaClient)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction getPrismaClient() {\n    if (!globalThis.__prisma) {\n        globalThis.__prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n    }\n    return globalThis.__prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZGIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQU92QyxTQUFTQztJQUNkLElBQUksQ0FBQ0MsV0FBV0MsUUFBUSxFQUFFO1FBQ3hCRCxXQUFXQyxRQUFRLEdBQUcsSUFBSUgsd0RBQVlBO0lBQ3hDO0lBQ0EsT0FBT0UsV0FBV0MsUUFBUTtBQUM1QiIsInNvdXJjZXMiOlsiL1VzZXJzL3RheWxvcndvZmZvcmQvRGVza3RvcC9jeWJlcmRhbGxhc18yMDY5L3NyYy9kYi9wcmlzbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmlzbWFDbGllbnQoKSB7XG4gIGlmICghZ2xvYmFsVGhpcy5fX3ByaXNtYSkge1xuICAgIGdsb2JhbFRoaXMuX19wcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG4gIH1cbiAgcmV0dXJuIGdsb2JhbFRoaXMuX19wcmlzbWE7XG59XG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2V0UHJpc21hQ2xpZW50IiwiZ2xvYmFsVGhpcyIsIl9fcHJpc21hIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/db/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/email/mailer.ts":
/*!*****************************!*\
  !*** ./src/email/mailer.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendCampaignInviteEmail: () => (/* binding */ sendCampaignInviteEmail)\n/* harmony export */ });\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nodemailer */ \"(rsc)/./node_modules/nodemailer/lib/nodemailer.js\");\n\nfunction getEnv(name) {\n    const value = process.env[name];\n    if (!value) return undefined;\n    return value;\n}\nfunction parseBool(value) {\n    if (!value) return false;\n    return value.toLowerCase() === 'true' || value === '1';\n}\nasync function sendCampaignInviteEmail(input) {\n    // Keep tests hermetic.\n    if (false) {}\n    // Allow disabling email in environments like E2E.\n    if (process.env.DISABLE_EMAIL === 'true') return;\n    const host = getEnv('SMTP_HOST');\n    const port = Number(getEnv('SMTP_PORT') ?? '587');\n    const secure = parseBool(getEnv('SMTP_SECURE'));\n    const user = getEnv('SMTP_USER');\n    const pass = getEnv('SMTP_PASS');\n    const from = getEnv('SMTP_FROM');\n    if (!host) throw new Error('Email not configured: SMTP_HOST is missing');\n    if (!from) throw new Error('Email not configured: SMTP_FROM is missing');\n    const transporter = nodemailer__WEBPACK_IMPORTED_MODULE_0__.createTransport({\n        host,\n        port,\n        secure,\n        auth: user && pass ? {\n            user,\n            pass\n        } : undefined\n    });\n    const subject = `Youve been invited to join ${input.campaignName}`;\n    const text = [\n        `Youve been invited to join the campaign: ${input.campaignName}`,\n        '',\n        `Accept this invite: ${input.inviteUrl}`,\n        '',\n        `This invite expires at: ${input.expiresAtIso}`\n    ].join('\\n');\n    await transporter.sendMail({\n        from,\n        to: input.to,\n        subject,\n        text\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZW1haWwvbWFpbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQW9DO0FBU3BDLFNBQVNDLE9BQU9DLElBQVk7SUFDMUIsTUFBTUMsUUFBUUMsUUFBUUMsR0FBRyxDQUFDSCxLQUFLO0lBQy9CLElBQUksQ0FBQ0MsT0FBTyxPQUFPRztJQUNuQixPQUFPSDtBQUNUO0FBRUEsU0FBU0ksVUFBVUosS0FBeUI7SUFDMUMsSUFBSSxDQUFDQSxPQUFPLE9BQU87SUFDbkIsT0FBT0EsTUFBTUssV0FBVyxPQUFPLFVBQVVMLFVBQVU7QUFDckQ7QUFFTyxlQUFlTSx3QkFBd0JDLEtBQTJCO0lBQ3ZFLHVCQUF1QjtJQUN2QixJQUFJTixLQUErQixFQUFFLEVBQU87SUFFNUMsa0RBQWtEO0lBQ2xELElBQUlBLFFBQVFDLEdBQUcsQ0FBQ00sYUFBYSxLQUFLLFFBQVE7SUFFMUMsTUFBTUMsT0FBT1gsT0FBTztJQUNwQixNQUFNWSxPQUFPQyxPQUFPYixPQUFPLGdCQUFnQjtJQUMzQyxNQUFNYyxTQUFTUixVQUFVTixPQUFPO0lBQ2hDLE1BQU1lLE9BQU9mLE9BQU87SUFDcEIsTUFBTWdCLE9BQU9oQixPQUFPO0lBQ3BCLE1BQU1pQixPQUFPakIsT0FBTztJQUVwQixJQUFJLENBQUNXLE1BQU0sTUFBTSxJQUFJTyxNQUFNO0lBQzNCLElBQUksQ0FBQ0QsTUFBTSxNQUFNLElBQUlDLE1BQU07SUFFM0IsTUFBTUMsY0FBY3BCLHVEQUEwQixDQUFDO1FBQzdDWTtRQUNBQztRQUNBRTtRQUNBTyxNQUFNTixRQUFRQyxPQUFPO1lBQUVEO1lBQU1DO1FBQUssSUFBSVg7SUFDeEM7SUFFQSxNQUFNaUIsVUFBVSxDQUFDLDRCQUE0QixFQUFFYixNQUFNYyxZQUFZLEVBQUU7SUFDbkUsTUFBTUMsT0FBTztRQUNYLENBQUMsMENBQTBDLEVBQUVmLE1BQU1jLFlBQVksRUFBRTtRQUNqRTtRQUNBLENBQUMsb0JBQW9CLEVBQUVkLE1BQU1nQixTQUFTLEVBQUU7UUFDeEM7UUFDQSxDQUFDLHdCQUF3QixFQUFFaEIsTUFBTWlCLFlBQVksRUFBRTtLQUNoRCxDQUFDQyxJQUFJLENBQUM7SUFFUCxNQUFNUixZQUFZUyxRQUFRLENBQUM7UUFDekJYO1FBQ0FZLElBQUlwQixNQUFNb0IsRUFBRTtRQUNaUDtRQUNBRTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9zcmMvZW1haWwvbWFpbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyIGZyb20gJ25vZGVtYWlsZXInO1xuXG5leHBvcnQgdHlwZSBTZW5kSW52aXRlRW1haWxJbnB1dCA9IHtcbiAgdG86IHN0cmluZztcbiAgY2FtcGFpZ25OYW1lOiBzdHJpbmc7XG4gIGludml0ZVVybDogc3RyaW5nO1xuICBleHBpcmVzQXRJc286IHN0cmluZztcbn07XG5cbmZ1bmN0aW9uIGdldEVudihuYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W25hbWVdO1xuICBpZiAoIXZhbHVlKSByZXR1cm4gdW5kZWZpbmVkO1xuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQm9vbCh2YWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkKTogYm9vbGVhbiB7XG4gIGlmICghdmFsdWUpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJyB8fCB2YWx1ZSA9PT0gJzEnO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZENhbXBhaWduSW52aXRlRW1haWwoaW5wdXQ6IFNlbmRJbnZpdGVFbWFpbElucHV0KTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIEtlZXAgdGVzdHMgaGVybWV0aWMuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnKSByZXR1cm47XG5cbiAgLy8gQWxsb3cgZGlzYWJsaW5nIGVtYWlsIGluIGVudmlyb25tZW50cyBsaWtlIEUyRS5cbiAgaWYgKHByb2Nlc3MuZW52LkRJU0FCTEVfRU1BSUwgPT09ICd0cnVlJykgcmV0dXJuO1xuXG4gIGNvbnN0IGhvc3QgPSBnZXRFbnYoJ1NNVFBfSE9TVCcpO1xuICBjb25zdCBwb3J0ID0gTnVtYmVyKGdldEVudignU01UUF9QT1JUJykgPz8gJzU4NycpO1xuICBjb25zdCBzZWN1cmUgPSBwYXJzZUJvb2woZ2V0RW52KCdTTVRQX1NFQ1VSRScpKTtcbiAgY29uc3QgdXNlciA9IGdldEVudignU01UUF9VU0VSJyk7XG4gIGNvbnN0IHBhc3MgPSBnZXRFbnYoJ1NNVFBfUEFTUycpO1xuICBjb25zdCBmcm9tID0gZ2V0RW52KCdTTVRQX0ZST00nKTtcblxuICBpZiAoIWhvc3QpIHRocm93IG5ldyBFcnJvcignRW1haWwgbm90IGNvbmZpZ3VyZWQ6IFNNVFBfSE9TVCBpcyBtaXNzaW5nJyk7XG4gIGlmICghZnJvbSkgdGhyb3cgbmV3IEVycm9yKCdFbWFpbCBub3QgY29uZmlndXJlZDogU01UUF9GUk9NIGlzIG1pc3NpbmcnKTtcblxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0LFxuICAgIHBvcnQsXG4gICAgc2VjdXJlLFxuICAgIGF1dGg6IHVzZXIgJiYgcGFzcyA/IHsgdXNlciwgcGFzcyB9IDogdW5kZWZpbmVkLFxuICB9KTtcblxuICBjb25zdCBzdWJqZWN0ID0gYFlvdeKAmXZlIGJlZW4gaW52aXRlZCB0byBqb2luICR7aW5wdXQuY2FtcGFpZ25OYW1lfWA7XG4gIGNvbnN0IHRleHQgPSBbXG4gICAgYFlvdeKAmXZlIGJlZW4gaW52aXRlZCB0byBqb2luIHRoZSBjYW1wYWlnbjogJHtpbnB1dC5jYW1wYWlnbk5hbWV9YCxcbiAgICAnJyxcbiAgICBgQWNjZXB0IHRoaXMgaW52aXRlOiAke2lucHV0Lmludml0ZVVybH1gLFxuICAgICcnLFxuICAgIGBUaGlzIGludml0ZSBleHBpcmVzIGF0OiAke2lucHV0LmV4cGlyZXNBdElzb31gLFxuICBdLmpvaW4oJ1xcbicpO1xuXG4gIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tLFxuICAgIHRvOiBpbnB1dC50byxcbiAgICBzdWJqZWN0LFxuICAgIHRleHQsXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbIm5vZGVtYWlsZXIiLCJnZXRFbnYiLCJuYW1lIiwidmFsdWUiLCJwcm9jZXNzIiwiZW52IiwidW5kZWZpbmVkIiwicGFyc2VCb29sIiwidG9Mb3dlckNhc2UiLCJzZW5kQ2FtcGFpZ25JbnZpdGVFbWFpbCIsImlucHV0IiwiRElTQUJMRV9FTUFJTCIsImhvc3QiLCJwb3J0IiwiTnVtYmVyIiwic2VjdXJlIiwidXNlciIsInBhc3MiLCJmcm9tIiwiRXJyb3IiLCJ0cmFuc3BvcnRlciIsImNyZWF0ZVRyYW5zcG9ydCIsImF1dGgiLCJzdWJqZWN0IiwiY2FtcGFpZ25OYW1lIiwidGV4dCIsImludml0ZVVybCIsImV4cGlyZXNBdElzbyIsImpvaW4iLCJzZW5kTWFpbCIsInRvIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/email/mailer.ts\n");

/***/ }),

/***/ "(rsc)/./src/graphql/auth.ts":
/*!*****************************!*\
  !*** ./src/graphql/auth.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractBearerToken: () => (/* binding */ extractBearerToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   isValidEmail: () => (/* binding */ isValidEmail),\n/* harmony export */   issueAuthToken: () => (/* binding */ issueAuthToken),\n/* harmony export */   verifyAuthToken: () => (/* binding */ verifyAuthToken),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction isValidEmail(email) {\n    // Intentionally simple (no DNS/MX checks) for app-level validation.\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\nfunction parsePositiveInt(value) {\n    if (!value) return null;\n    const n = Number.parseInt(value, 10);\n    if (!Number.isFinite(n)) return null;\n    if (n <= 0) return null;\n    return n;\n}\nfunction getScryptParamsFromEnv() {\n    const n = parsePositiveInt(process.env.PASSWORD_SCRYPT_N);\n    const r = parsePositiveInt(process.env.PASSWORD_SCRYPT_R);\n    const p = parsePositiveInt(process.env.PASSWORD_SCRYPT_P);\n    if (n === null && r === null && p === null) return null;\n    return {\n        N: n ?? 16384,\n        r: r ?? 8,\n        p: p ?? 1\n    };\n}\nfunction serializeScryptParams(params) {\n    return `N=${params.N},r=${params.r},p=${params.p}`;\n}\nfunction parseScryptParams(serialized) {\n    const parts = serialized.split(',').map((p)=>p.trim());\n    const kv = {};\n    for (const part of parts){\n        const eq = part.indexOf('=');\n        if (eq === -1) continue;\n        const key = part.slice(0, eq).trim();\n        const value = part.slice(eq + 1).trim();\n        if (key) kv[key] = value;\n    }\n    const N = parsePositiveInt(kv.N);\n    const r = parsePositiveInt(kv.r);\n    const p = parsePositiveInt(kv.p);\n    if (N === null || r === null || p === null) return null;\n    return {\n        N,\n        r,\n        p\n    };\n}\nfunction scryptAsync(password, salt, keylen, params) {\n    return new Promise((resolve, reject)=>{\n        const callback = (err, derivedKey)=>{\n            if (err) reject(err);\n            else resolve(derivedKey);\n        };\n        if (!params) {\n            node_crypto__WEBPACK_IMPORTED_MODULE_0___default().scrypt(password, salt, keylen, callback);\n            return;\n        }\n        const options = {\n            N: params.N,\n            r: params.r,\n            p: params.p\n        };\n        node_crypto__WEBPACK_IMPORTED_MODULE_0___default().scrypt(password, salt, keylen, options, callback);\n    });\n}\nasync function hashPassword(password) {\n    const salt = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(16);\n    const params = getScryptParamsFromEnv();\n    const hash = await scryptAsync(password, salt, 32, params);\n    if (!params) {\n        return `scrypt$${salt.toString('base64url')}$${hash.toString('base64url')}`;\n    }\n    return `scrypt$${serializeScryptParams(params)}$${salt.toString('base64url')}$${hash.toString('base64url')}`;\n}\nasync function verifyPassword(password, passwordHash) {\n    const parts = passwordHash.split('$');\n    if (parts[0] !== 'scrypt') return false;\n    let params = null;\n    let saltPart;\n    let expectedPart;\n    if (parts.length === 3) {\n        // Legacy format: scrypt$<salt>$<hash>\n        saltPart = parts[1];\n        expectedPart = parts[2];\n    } else if (parts.length === 4) {\n        // Parameterized format: scrypt$N=...,r=...,p=...$<salt>$<hash>\n        params = parseScryptParams(parts[1] ?? '');\n        if (!params) return false;\n        saltPart = parts[2];\n        expectedPart = parts[3];\n    } else {\n        return false;\n    }\n    if (!saltPart || !expectedPart) return false;\n    const salt = Buffer.from(saltPart, 'base64url');\n    const expected = Buffer.from(expectedPart, 'base64url');\n    const actual = await scryptAsync(password, salt, expected.length, params);\n    if (actual.length !== expected.length) return false;\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(actual, expected);\n}\nfunction hmacSha256Base64Url(input, secret) {\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac('sha256', secret).update(input).digest('base64url');\n}\nconst DEFAULT_TOKEN_TTL_MS = 7 * 24 * 60 * 60 * 1000;\nfunction issueAuthToken(userId, secret, ttlMs = DEFAULT_TOKEN_TTL_MS, issuedAtMs = Date.now()) {\n    const iat = issuedAtMs;\n    const payload = {\n        sub: userId,\n        iat,\n        exp: iat + ttlMs\n    };\n    const payloadB64 = Buffer.from(JSON.stringify(payload)).toString('base64url');\n    const signature = hmacSha256Base64Url(payloadB64, secret);\n    return `${payloadB64}.${signature}`;\n}\nfunction verifyAuthToken(token, secret, nowMs = Date.now()) {\n    const [payloadB64, signature] = token.split('.');\n    if (!payloadB64 || !signature) return null;\n    const expected = hmacSha256Base64Url(payloadB64, secret);\n    const sigBuf = Buffer.from(signature);\n    const expectedBuf = Buffer.from(expected);\n    if (sigBuf.length !== expectedBuf.length) return null;\n    if (!node_crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(sigBuf, expectedBuf)) return null;\n    try {\n        const payloadJson = Buffer.from(payloadB64, 'base64url').toString('utf8');\n        const payload = JSON.parse(payloadJson);\n        if (typeof payload.sub !== 'string') return null;\n        if (typeof payload.exp !== 'number') return null;\n        if (nowMs >= payload.exp) return null;\n        return payload.sub;\n    } catch  {\n        return null;\n    }\n}\nfunction extractBearerToken(authorizationHeader) {\n    if (!authorizationHeader) return null;\n    const match = authorizationHeader.match(/^Bearer\\s+(.+)$/i);\n    return match?.[1] ?? null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTUMsY0FBYy9CLE9BQU9DLElBQUksQ0FBQ3FCLFlBQVksYUFBYTVCLFFBQVEsQ0FBQztRQUNsRSxNQUFNeUIsVUFBVUksS0FBS1MsS0FBSyxDQUFDRDtRQUMzQixJQUFJLE9BQU9aLFFBQVFDLEdBQUcsS0FBSyxVQUFVLE9BQU87UUFDNUMsSUFBSSxPQUFPRCxRQUFRRSxHQUFHLEtBQUssVUFBVSxPQUFPO1FBQzVDLElBQUlPLFNBQVNULFFBQVFFLEdBQUcsRUFBRSxPQUFPO1FBQ2pDLE9BQU9GLFFBQVFDLEdBQUc7SUFDcEIsRUFBRSxPQUFNO1FBQ04sT0FBTztJQUNUO0FBQ0Y7QUFFTyxTQUFTYSxtQkFBbUJDLG1CQUFrQztJQUNuRSxJQUFJLENBQUNBLHFCQUFxQixPQUFPO0lBQ2pDLE1BQU1DLFFBQVFELG9CQUFvQkMsS0FBSyxDQUFDO0lBQ3hDLE9BQU9BLE9BQU8sQ0FBQyxFQUFFLElBQUk7QUFDdkIiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9zcmMvZ3JhcGhxbC9hdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnbm9kZTpjcnlwdG8nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZEVtYWlsKGVtYWlsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgLy8gSW50ZW50aW9uYWxseSBzaW1wbGUgKG5vIEROUy9NWCBjaGVja3MpIGZvciBhcHAtbGV2ZWwgdmFsaWRhdGlvbi5cbiAgcmV0dXJuIC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvLnRlc3QoZW1haWwpO1xufVxuXG50eXBlIFNjcnlwdFBhcmFtcyA9IHsgTjogbnVtYmVyOyByOiBudW1iZXI7IHA6IG51bWJlciB9O1xuXG5mdW5jdGlvbiBwYXJzZVBvc2l0aXZlSW50KHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpOiBudW1iZXIgfCBudWxsIHtcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IG4gPSBOdW1iZXIucGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUobikpIHJldHVybiBudWxsO1xuICBpZiAobiA8PSAwKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIG47XG59XG5cbmZ1bmN0aW9uIGdldFNjcnlwdFBhcmFtc0Zyb21FbnYoKTogU2NyeXB0UGFyYW1zIHwgbnVsbCB7XG4gIGNvbnN0IG4gPSBwYXJzZVBvc2l0aXZlSW50KHByb2Nlc3MuZW52LlBBU1NXT1JEX1NDUllQVF9OKTtcbiAgY29uc3QgciA9IHBhcnNlUG9zaXRpdmVJbnQocHJvY2Vzcy5lbnYuUEFTU1dPUkRfU0NSWVBUX1IpO1xuICBjb25zdCBwID0gcGFyc2VQb3NpdGl2ZUludChwcm9jZXNzLmVudi5QQVNTV09SRF9TQ1JZUFRfUCk7XG5cbiAgaWYgKG4gPT09IG51bGwgJiYgciA9PT0gbnVsbCAmJiBwID09PSBudWxsKSByZXR1cm4gbnVsbDtcblxuICByZXR1cm4ge1xuICAgIE46IG4gPz8gMTYzODQsXG4gICAgcjogciA/PyA4LFxuICAgIHA6IHAgPz8gMSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gc2VyaWFsaXplU2NyeXB0UGFyYW1zKHBhcmFtczogU2NyeXB0UGFyYW1zKTogc3RyaW5nIHtcbiAgcmV0dXJuIGBOPSR7cGFyYW1zLk59LHI9JHtwYXJhbXMucn0scD0ke3BhcmFtcy5wfWA7XG59XG5cbmZ1bmN0aW9uIHBhcnNlU2NyeXB0UGFyYW1zKHNlcmlhbGl6ZWQ6IHN0cmluZyk6IFNjcnlwdFBhcmFtcyB8IG51bGwge1xuICBjb25zdCBwYXJ0cyA9IHNlcmlhbGl6ZWQuc3BsaXQoJywnKS5tYXAoKHApID0+IHAudHJpbSgpKTtcbiAgY29uc3Qga3Y6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XG4gICAgY29uc3QgZXEgPSBwYXJ0LmluZGV4T2YoJz0nKTtcbiAgICBpZiAoZXEgPT09IC0xKSBjb250aW51ZTtcbiAgICBjb25zdCBrZXkgPSBwYXJ0LnNsaWNlKDAsIGVxKS50cmltKCk7XG4gICAgY29uc3QgdmFsdWUgPSBwYXJ0LnNsaWNlKGVxICsgMSkudHJpbSgpO1xuICAgIGlmIChrZXkpIGt2W2tleV0gPSB2YWx1ZTtcbiAgfVxuXG4gIGNvbnN0IE4gPSBwYXJzZVBvc2l0aXZlSW50KGt2Lk4pO1xuICBjb25zdCByID0gcGFyc2VQb3NpdGl2ZUludChrdi5yKTtcbiAgY29uc3QgcCA9IHBhcnNlUG9zaXRpdmVJbnQoa3YucCk7XG4gIGlmIChOID09PSBudWxsIHx8IHIgPT09IG51bGwgfHwgcCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gIHJldHVybiB7IE4sIHIsIHAgfTtcbn1cblxuZnVuY3Rpb24gc2NyeXB0QXN5bmMocGFzc3dvcmQ6IHN0cmluZywgc2FsdDogQnVmZmVyLCBrZXlsZW46IG51bWJlciwgcGFyYW1zOiBTY3J5cHRQYXJhbXMgfCBudWxsKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBjYWxsYmFjayA9IChlcnI6IE5vZGVKUy5FcnJub0V4Y2VwdGlvbiB8IG51bGwsIGRlcml2ZWRLZXk6IHVua25vd24pID0+IHtcbiAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuICAgICAgZWxzZSByZXNvbHZlKGRlcml2ZWRLZXkgYXMgQnVmZmVyKTtcbiAgICB9O1xuXG4gICAgaWYgKCFwYXJhbXMpIHtcbiAgICAgIGNyeXB0by5zY3J5cHQocGFzc3dvcmQsIHNhbHQsIGtleWxlbiwgY2FsbGJhY2spO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG9wdGlvbnM6IGNyeXB0by5TY3J5cHRPcHRpb25zID0geyBOOiBwYXJhbXMuTiwgcjogcGFyYW1zLnIsIHA6IHBhcmFtcy5wIH07XG4gICAgY3J5cHRvLnNjcnlwdChwYXNzd29yZCwgc2FsdCwga2V5bGVuLCBvcHRpb25zLCBjYWxsYmFjayk7XG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaFBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBzYWx0ID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KTtcbiAgY29uc3QgcGFyYW1zID0gZ2V0U2NyeXB0UGFyYW1zRnJvbUVudigpO1xuICBjb25zdCBoYXNoID0gYXdhaXQgc2NyeXB0QXN5bmMocGFzc3dvcmQsIHNhbHQsIDMyLCBwYXJhbXMpO1xuXG4gIGlmICghcGFyYW1zKSB7XG4gICAgcmV0dXJuIGBzY3J5cHQkJHtzYWx0LnRvU3RyaW5nKCdiYXNlNjR1cmwnKX0kJHtoYXNoLnRvU3RyaW5nKCdiYXNlNjR1cmwnKX1gO1xuICB9XG5cbiAgcmV0dXJuIGBzY3J5cHQkJHtzZXJpYWxpemVTY3J5cHRQYXJhbXMocGFyYW1zKX0kJHtzYWx0LnRvU3RyaW5nKCdiYXNlNjR1cmwnKX0kJHtoYXNoLnRvU3RyaW5nKCdiYXNlNjR1cmwnKX1gO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZywgcGFzc3dvcmRIYXNoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgcGFydHMgPSBwYXNzd29yZEhhc2guc3BsaXQoJyQnKTtcblxuICBpZiAocGFydHNbMF0gIT09ICdzY3J5cHQnKSByZXR1cm4gZmFsc2U7XG5cbiAgbGV0IHBhcmFtczogU2NyeXB0UGFyYW1zIHwgbnVsbCA9IG51bGw7XG4gIGxldCBzYWx0UGFydDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBsZXQgZXhwZWN0ZWRQYXJ0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykge1xuICAgIC8vIExlZ2FjeSBmb3JtYXQ6IHNjcnlwdCQ8c2FsdD4kPGhhc2g+XG4gICAgc2FsdFBhcnQgPSBwYXJ0c1sxXTtcbiAgICBleHBlY3RlZFBhcnQgPSBwYXJ0c1syXTtcbiAgfSBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDQpIHtcbiAgICAvLyBQYXJhbWV0ZXJpemVkIGZvcm1hdDogc2NyeXB0JE49Li4uLHI9Li4uLHA9Li4uJDxzYWx0PiQ8aGFzaD5cbiAgICBwYXJhbXMgPSBwYXJzZVNjcnlwdFBhcmFtcyhwYXJ0c1sxXSA/PyAnJyk7XG4gICAgaWYgKCFwYXJhbXMpIHJldHVybiBmYWxzZTtcbiAgICBzYWx0UGFydCA9IHBhcnRzWzJdO1xuICAgIGV4cGVjdGVkUGFydCA9IHBhcnRzWzNdO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmICghc2FsdFBhcnQgfHwgIWV4cGVjdGVkUGFydCkgcmV0dXJuIGZhbHNlO1xuXG4gIGNvbnN0IHNhbHQgPSBCdWZmZXIuZnJvbShzYWx0UGFydCwgJ2Jhc2U2NHVybCcpO1xuICBjb25zdCBleHBlY3RlZCA9IEJ1ZmZlci5mcm9tKGV4cGVjdGVkUGFydCwgJ2Jhc2U2NHVybCcpO1xuICBjb25zdCBhY3R1YWwgPSBhd2FpdCBzY3J5cHRBc3luYyhwYXNzd29yZCwgc2FsdCwgZXhwZWN0ZWQubGVuZ3RoLCBwYXJhbXMpO1xuICBpZiAoYWN0dWFsLmxlbmd0aCAhPT0gZXhwZWN0ZWQubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBjcnlwdG8udGltaW5nU2FmZUVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpO1xufVxuXG50eXBlIFRva2VuUGF5bG9hZCA9IHtcbiAgc3ViOiBzdHJpbmc7XG4gIGlhdDogbnVtYmVyO1xuICBleHA6IG51bWJlcjtcbn07XG5cbmZ1bmN0aW9uIGhtYWNTaGEyNTZCYXNlNjRVcmwoaW5wdXQ6IHN0cmluZywgc2VjcmV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhtYWMoJ3NoYTI1NicsIHNlY3JldCkudXBkYXRlKGlucHV0KS5kaWdlc3QoJ2Jhc2U2NHVybCcpO1xufVxuXG5jb25zdCBERUZBVUxUX1RPS0VOX1RUTF9NUyA9IDcgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNzdWVBdXRoVG9rZW4oXG4gIHVzZXJJZDogc3RyaW5nLFxuICBzZWNyZXQ6IHN0cmluZyxcbiAgdHRsTXM6IG51bWJlciA9IERFRkFVTFRfVE9LRU5fVFRMX01TLFxuICBpc3N1ZWRBdE1zOiBudW1iZXIgPSBEYXRlLm5vdygpLFxuKTogc3RyaW5nIHtcbiAgY29uc3QgaWF0ID0gaXNzdWVkQXRNcztcbiAgY29uc3QgcGF5bG9hZDogVG9rZW5QYXlsb2FkID0geyBzdWI6IHVzZXJJZCwgaWF0LCBleHA6IGlhdCArIHR0bE1zIH07XG4gIGNvbnN0IHBheWxvYWRCNjQgPSBCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShwYXlsb2FkKSkudG9TdHJpbmcoJ2Jhc2U2NHVybCcpO1xuICBjb25zdCBzaWduYXR1cmUgPSBobWFjU2hhMjU2QmFzZTY0VXJsKHBheWxvYWRCNjQsIHNlY3JldCk7XG4gIHJldHVybiBgJHtwYXlsb2FkQjY0fS4ke3NpZ25hdHVyZX1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5QXV0aFRva2VuKHRva2VuOiBzdHJpbmcsIHNlY3JldDogc3RyaW5nLCBub3dNczogbnVtYmVyID0gRGF0ZS5ub3coKSk6IHN0cmluZyB8IG51bGwge1xuICBjb25zdCBbcGF5bG9hZEI2NCwgc2lnbmF0dXJlXSA9IHRva2VuLnNwbGl0KCcuJyk7XG4gIGlmICghcGF5bG9hZEI2NCB8fCAhc2lnbmF0dXJlKSByZXR1cm4gbnVsbDtcblxuICBjb25zdCBleHBlY3RlZCA9IGhtYWNTaGEyNTZCYXNlNjRVcmwocGF5bG9hZEI2NCwgc2VjcmV0KTtcbiAgY29uc3Qgc2lnQnVmID0gQnVmZmVyLmZyb20oc2lnbmF0dXJlKTtcbiAgY29uc3QgZXhwZWN0ZWRCdWYgPSBCdWZmZXIuZnJvbShleHBlY3RlZCk7XG4gIGlmIChzaWdCdWYubGVuZ3RoICE9PSBleHBlY3RlZEJ1Zi5sZW5ndGgpIHJldHVybiBudWxsO1xuICBpZiAoIWNyeXB0by50aW1pbmdTYWZlRXF1YWwoc2lnQnVmLCBleHBlY3RlZEJ1ZikpIHJldHVybiBudWxsO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcGF5bG9hZEpzb24gPSBCdWZmZXIuZnJvbShwYXlsb2FkQjY0LCAnYmFzZTY0dXJsJykudG9TdHJpbmcoJ3V0ZjgnKTtcbiAgICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShwYXlsb2FkSnNvbikgYXMgUGFydGlhbDxUb2tlblBheWxvYWQ+O1xuICAgIGlmICh0eXBlb2YgcGF5bG9hZC5zdWIgIT09ICdzdHJpbmcnKSByZXR1cm4gbnVsbDtcbiAgICBpZiAodHlwZW9mIHBheWxvYWQuZXhwICE9PSAnbnVtYmVyJykgcmV0dXJuIG51bGw7XG4gICAgaWYgKG5vd01zID49IHBheWxvYWQuZXhwKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gcGF5bG9hZC5zdWI7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0QmVhcmVyVG9rZW4oYXV0aG9yaXphdGlvbkhlYWRlcjogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB8IG51bGwge1xuICBpZiAoIWF1dGhvcml6YXRpb25IZWFkZXIpIHJldHVybiBudWxsO1xuICBjb25zdCBtYXRjaCA9IGF1dGhvcml6YXRpb25IZWFkZXIubWF0Y2goL15CZWFyZXJcXHMrKC4rKSQvaSk7XG4gIHJldHVybiBtYXRjaD8uWzFdID8/IG51bGw7XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiaXNWYWxpZEVtYWlsIiwiZW1haWwiLCJ0ZXN0IiwicGFyc2VQb3NpdGl2ZUludCIsInZhbHVlIiwibiIsIk51bWJlciIsInBhcnNlSW50IiwiaXNGaW5pdGUiLCJnZXRTY3J5cHRQYXJhbXNGcm9tRW52IiwicHJvY2VzcyIsImVudiIsIlBBU1NXT1JEX1NDUllQVF9OIiwiciIsIlBBU1NXT1JEX1NDUllQVF9SIiwicCIsIlBBU1NXT1JEX1NDUllQVF9QIiwiTiIsInNlcmlhbGl6ZVNjcnlwdFBhcmFtcyIsInBhcmFtcyIsInBhcnNlU2NyeXB0UGFyYW1zIiwic2VyaWFsaXplZCIsInBhcnRzIiwic3BsaXQiLCJtYXAiLCJ0cmltIiwia3YiLCJwYXJ0IiwiZXEiLCJpbmRleE9mIiwia2V5Iiwic2xpY2UiLCJzY3J5cHRBc3luYyIsInBhc3N3b3JkIiwic2FsdCIsImtleWxlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiY2FsbGJhY2siLCJlcnIiLCJkZXJpdmVkS2V5Iiwic2NyeXB0Iiwib3B0aW9ucyIsImhhc2hQYXNzd29yZCIsInJhbmRvbUJ5dGVzIiwiaGFzaCIsInRvU3RyaW5nIiwidmVyaWZ5UGFzc3dvcmQiLCJwYXNzd29yZEhhc2giLCJzYWx0UGFydCIsImV4cGVjdGVkUGFydCIsImxlbmd0aCIsIkJ1ZmZlciIsImZyb20iLCJleHBlY3RlZCIsImFjdHVhbCIsInRpbWluZ1NhZmVFcXVhbCIsImhtYWNTaGEyNTZCYXNlNjRVcmwiLCJpbnB1dCIsInNlY3JldCIsImNyZWF0ZUhtYWMiLCJ1cGRhdGUiLCJkaWdlc3QiLCJERUZBVUxUX1RPS0VOX1RUTF9NUyIsImlzc3VlQXV0aFRva2VuIiwidXNlcklkIiwidHRsTXMiLCJpc3N1ZWRBdE1zIiwiRGF0ZSIsIm5vdyIsImlhdCIsInBheWxvYWQiLCJzdWIiLCJleHAiLCJwYXlsb2FkQjY0IiwiSlNPTiIsInN0cmluZ2lmeSIsInNpZ25hdHVyZSIsInZlcmlmeUF1dGhUb2tlbiIsInRva2VuIiwibm93TXMiLCJzaWdCdWYiLCJleHBlY3RlZEJ1ZiIsInBheWxvYWRKc29uIiwicGFyc2UiLCJleHRyYWN0QmVhcmVyVG9rZW4iLCJhdXRob3JpemF0aW9uSGVhZGVyIiwibWF0Y2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/graphql/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/graphql/dataSource.ts":
/*!***********************************!*\
  !*** ./src/graphql/dataSource.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDataSource: () => (/* binding */ createDataSource)\n/* harmony export */ });\n/* harmony import */ var _db_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../db/prisma */ \"(rsc)/./src/db/prisma.ts\");\n/* harmony import */ var _seed__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./seed */ \"(rsc)/./src/graphql/seed.ts\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction generateInviteToken() {\n    // URL-safe token.\n    return node_crypto__WEBPACK_IMPORTED_MODULE_2___default().randomBytes(24).toString('base64url');\n}\nfunction normalizeEmail(email) {\n    return email.trim().toLowerCase();\n}\nfunction createInMemoryDataSource() {\n    const users = [];\n    const campaignMembers = new Map();\n    const invites = [];\n    function getMembershipsByUser(userId) {\n        const existing = campaignMembers.get(userId);\n        if (existing) return existing;\n        const created = new Map();\n        campaignMembers.set(userId, created);\n        return created;\n    }\n    function anyOwnerExists(campaignId) {\n        for (const memberships of campaignMembers.values()){\n            if (memberships.get(campaignId) === 'OWNER') return true;\n        }\n        return false;\n    }\n    function isPublicCharacter(character) {\n        return character.isPublic === true;\n    }\n    function isCharacterInMemberCampaign(character, userId) {\n        if (!character.campaignId) return false;\n        return getMembershipsByUser(userId).has(character.campaignId);\n    }\n    return {\n        kind: 'inMemory',\n        async getCampaignById (id) {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns.find((c)=>c.id === id) ?? null;\n        },\n        async listCampaigns () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns;\n        },\n        async listCampaignsForUser (userId) {\n            const memberships = getMembershipsByUser(userId);\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns.filter((c)=>memberships.has(c.id));\n        },\n        async listCharacters () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.characters;\n        },\n        async listCharactersForUser (userId) {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.characters.filter((c)=>isPublicCharacter(c) || isCharacterInMemberCampaign(c, userId));\n        },\n        async listCybernetics () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.cybernetics;\n        },\n        async listWeapons () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.weapons;\n        },\n        async listItems () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.items;\n        },\n        async listVehicles () {\n            return _seed__WEBPACK_IMPORTED_MODULE_1__.vehicles;\n        },\n        async addUserToCampaign (input) {\n            const campaign = _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns.find((c)=>c.id === input.campaignId);\n            if (!campaign) throw new Error('CAMPAIGN_NOT_FOUND');\n            const memberships = getMembershipsByUser(input.userId);\n            const desiredRole = input.role === 'OWNER' || input.role === 'MEMBER' ? input.role : anyOwnerExists(input.campaignId) ? 'MEMBER' : 'OWNER';\n            // Only upgrade; never downgrade.\n            const existing = memberships.get(input.campaignId);\n            if (existing === 'OWNER') return;\n            memberships.set(input.campaignId, desiredRole);\n        },\n        async getCampaignMembershipRole (input) {\n            const memberships = getMembershipsByUser(input.userId);\n            return memberships.get(input.campaignId) ?? null;\n        },\n        async createCampaignInvite (input) {\n            const campaign = _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns.find((c)=>c.id === input.campaignId);\n            if (!campaign) throw new Error('CAMPAIGN_NOT_FOUND');\n            const nowMs = Date.now();\n            const invite = {\n                id: `inv_${node_crypto__WEBPACK_IMPORTED_MODULE_2___default().randomUUID()}`,\n                token: generateInviteToken(),\n                email: normalizeEmail(input.email),\n                campaignId: input.campaignId,\n                expiresAtMs: nowMs + input.ttlMs,\n                acceptedAtMs: null,\n                acceptedByUserId: null,\n                createdAtMs: nowMs\n            };\n            invites.push(invite);\n            return {\n                token: invite.token,\n                expiresAt: new Date(invite.expiresAtMs).toISOString()\n            };\n        },\n        async acceptCampaignInvite (input) {\n            const invite = invites.find((i)=>i.token === input.token);\n            if (!invite) throw new Error('INVITE_NOT_FOUND');\n            if (invite.acceptedAtMs) throw new Error('INVITE_ALREADY_USED');\n            const nowMs = input.nowMs ?? Date.now();\n            if (nowMs > invite.expiresAtMs) throw new Error('INVITE_EXPIRED');\n            if (normalizeEmail(input.userEmail) !== invite.email) throw new Error('INVITE_EMAIL_MISMATCH');\n            await this.addUserToCampaign({\n                userId: input.userId,\n                campaignId: invite.campaignId,\n                role: 'MEMBER'\n            });\n            invite.acceptedAtMs = nowMs;\n            invite.acceptedByUserId = input.userId;\n            const campaign = _seed__WEBPACK_IMPORTED_MODULE_1__.campaigns.find((c)=>c.id === invite.campaignId);\n            if (!campaign) throw new Error('CAMPAIGN_NOT_FOUND');\n            return campaign;\n        },\n        async getUserById (id) {\n            const user = users.find((u)=>u.id === id);\n            return user ? {\n                id: user.id,\n                email: user.email\n            } : null;\n        },\n        async findUserByEmail (email) {\n            return users.find((u)=>u.email.toLowerCase() === email.toLowerCase()) ?? null;\n        },\n        async createUser (input) {\n            const existing = users.find((u)=>u.email.toLowerCase() === input.email.toLowerCase());\n            if (existing) {\n                throw new Error('DUPLICATE_EMAIL');\n            }\n            const id = `u_${users.length + 1}`;\n            const user = {\n                id,\n                email: input.email,\n                passwordHash: input.passwordHash\n            };\n            users.push(user);\n            return {\n                id: user.id,\n                email: user.email\n            };\n        }\n    };\n}\nfunction createPrismaDataSource() {\n    const prisma = (0,_db_prisma__WEBPACK_IMPORTED_MODULE_0__.getPrismaClient)();\n    return {\n        kind: 'prisma',\n        async getCampaignById (id) {\n            const row = await prisma.campaign.findUnique({\n                where: {\n                    id\n                },\n                select: {\n                    id: true,\n                    name: true\n                }\n            });\n            return row ?? null;\n        },\n        async listCampaigns () {\n            const rows = await prisma.campaign.findMany({\n                select: {\n                    id: true,\n                    name: true\n                }\n            });\n            return rows;\n        },\n        async listCampaignsForUser (userId) {\n            const rows = await prisma.campaign.findMany({\n                where: {\n                    memberships: {\n                        some: {\n                            userId\n                        }\n                    }\n                },\n                select: {\n                    id: true,\n                    name: true\n                }\n            });\n            return rows;\n        },\n        async listCharacters () {\n            const rows = await prisma.character.findMany({\n                select: {\n                    id: true,\n                    name: true,\n                    isPublic: true,\n                    speed: true,\n                    hitPoints: true,\n                    brawn: true,\n                    charm: true,\n                    intelligence: true,\n                    reflexes: true,\n                    tech: true,\n                    luck: true,\n                    campaignId: true,\n                    skills: {\n                        select: {\n                            name: true,\n                            level: true\n                        }\n                    },\n                    cybernetics: {\n                        select: {\n                            cyberneticId: true\n                        }\n                    },\n                    weapons: {\n                        select: {\n                            weaponId: true\n                        }\n                    },\n                    items: {\n                        select: {\n                            itemId: true\n                        }\n                    },\n                    vehicles: {\n                        select: {\n                            vehicleId: true\n                        }\n                    }\n                }\n            });\n            return rows.map((row)=>({\n                    id: row.id,\n                    name: row.name,\n                    isPublic: row.isPublic,\n                    speed: row.speed,\n                    hitPoints: row.hitPoints,\n                    campaignId: row.campaignId,\n                    stats: {\n                        brawn: row.brawn,\n                        charm: row.charm,\n                        intelligence: row.intelligence,\n                        reflexes: row.reflexes,\n                        tech: row.tech,\n                        luck: row.luck\n                    },\n                    skills: row.skills,\n                    cyberneticIds: row.cybernetics.map((c)=>c.cyberneticId),\n                    weaponIds: row.weapons.map((w)=>w.weaponId),\n                    itemIds: row.items.map((i)=>i.itemId),\n                    vehicleIds: row.vehicles.map((v)=>v.vehicleId)\n                }));\n        },\n        async listCharactersForUser (userId) {\n            const rows = await prisma.character.findMany({\n                where: {\n                    OR: [\n                        {\n                            isPublic: true\n                        },\n                        {\n                            campaign: {\n                                memberships: {\n                                    some: {\n                                        userId\n                                    }\n                                }\n                            }\n                        }\n                    ]\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    isPublic: true,\n                    speed: true,\n                    hitPoints: true,\n                    brawn: true,\n                    charm: true,\n                    intelligence: true,\n                    reflexes: true,\n                    tech: true,\n                    luck: true,\n                    campaignId: true,\n                    skills: {\n                        select: {\n                            name: true,\n                            level: true\n                        }\n                    },\n                    cybernetics: {\n                        select: {\n                            cyberneticId: true\n                        }\n                    },\n                    weapons: {\n                        select: {\n                            weaponId: true\n                        }\n                    },\n                    items: {\n                        select: {\n                            itemId: true\n                        }\n                    },\n                    vehicles: {\n                        select: {\n                            vehicleId: true\n                        }\n                    }\n                }\n            });\n            return rows.map((row)=>({\n                    id: row.id,\n                    name: row.name,\n                    isPublic: row.isPublic,\n                    speed: row.speed,\n                    hitPoints: row.hitPoints,\n                    campaignId: row.campaignId,\n                    stats: {\n                        brawn: row.brawn,\n                        charm: row.charm,\n                        intelligence: row.intelligence,\n                        reflexes: row.reflexes,\n                        tech: row.tech,\n                        luck: row.luck\n                    },\n                    skills: row.skills,\n                    cyberneticIds: row.cybernetics.map((c)=>c.cyberneticId),\n                    weaponIds: row.weapons.map((w)=>w.weaponId),\n                    itemIds: row.items.map((i)=>i.itemId),\n                    vehicleIds: row.vehicles.map((v)=>v.vehicleId)\n                }));\n        },\n        async listCybernetics () {\n            return prisma.cybernetic.findMany({\n                select: {\n                    id: true,\n                    name: true,\n                    shortDescription: true,\n                    longDescription: true,\n                    price: true,\n                    batteryLife: true\n                }\n            });\n        },\n        async listWeapons () {\n            const rows = await prisma.weapon.findMany({\n                select: {\n                    id: true,\n                    name: true,\n                    price: true,\n                    weight: true,\n                    maxRange: true,\n                    maxAmmoCount: true,\n                    type: true,\n                    condition: true,\n                    shortDescription: true,\n                    longDescription: true\n                }\n            });\n            return rows.map((row)=>({\n                    ...row,\n                    type: row.type\n                }));\n        },\n        async listItems () {\n            const rows = await prisma.item.findMany({\n                select: {\n                    id: true,\n                    name: true,\n                    price: true,\n                    weight: true,\n                    type: true,\n                    shortDescription: true,\n                    longDescription: true\n                }\n            });\n            return rows.map((row)=>({\n                    ...row,\n                    type: row.type\n                }));\n        },\n        async listVehicles () {\n            return prisma.vehicle.findMany({\n                select: {\n                    id: true,\n                    name: true,\n                    price: true,\n                    shortDescription: true,\n                    longDescription: true,\n                    speed: true,\n                    armor: true\n                }\n            });\n        },\n        async addUserToCampaign (input) {\n            await prisma.$transaction(async (tx)=>{\n                const ownerCount = await tx.campaignMembership.count({\n                    where: {\n                        campaignId: input.campaignId,\n                        role: 'OWNER'\n                    }\n                });\n                const desiredRole = input.role === 'OWNER' || input.role === 'MEMBER' ? input.role : ownerCount > 0 ? 'MEMBER' : 'OWNER';\n                await tx.campaignMembership.upsert({\n                    where: {\n                        userId_campaignId: {\n                            userId: input.userId,\n                            campaignId: input.campaignId\n                        }\n                    },\n                    update: desiredRole === 'OWNER' ? {\n                        role: 'OWNER'\n                    } : {},\n                    create: {\n                        userId: input.userId,\n                        campaignId: input.campaignId,\n                        role: desiredRole\n                    }\n                });\n            });\n        },\n        async getCampaignMembershipRole (input) {\n            const row = await prisma.campaignMembership.findUnique({\n                where: {\n                    userId_campaignId: {\n                        userId: input.userId,\n                        campaignId: input.campaignId\n                    }\n                },\n                select: {\n                    role: true\n                }\n            });\n            return row?.role ?? null;\n        },\n        async createCampaignInvite (input) {\n            const campaign = await prisma.campaign.findUnique({\n                where: {\n                    id: input.campaignId\n                },\n                select: {\n                    id: true\n                }\n            });\n            if (!campaign) throw new Error('CAMPAIGN_NOT_FOUND');\n            const token = generateInviteToken();\n            const expiresAt = new Date(Date.now() + input.ttlMs);\n            await prisma.campaignInvite.create({\n                data: {\n                    token,\n                    email: normalizeEmail(input.email),\n                    campaignId: input.campaignId,\n                    expiresAt\n                },\n                select: {\n                    id: true\n                }\n            });\n            return {\n                token,\n                expiresAt: expiresAt.toISOString()\n            };\n        },\n        async acceptCampaignInvite (input) {\n            const invite = await prisma.campaignInvite.findUnique({\n                where: {\n                    token: input.token\n                },\n                select: {\n                    token: true,\n                    email: true,\n                    campaignId: true,\n                    expiresAt: true,\n                    acceptedAt: true\n                }\n            });\n            if (!invite) throw new Error('INVITE_NOT_FOUND');\n            if (invite.acceptedAt) throw new Error('INVITE_ALREADY_USED');\n            const nowMs = input.nowMs ?? Date.now();\n            if (nowMs > invite.expiresAt.getTime()) throw new Error('INVITE_EXPIRED');\n            if (normalizeEmail(input.userEmail) !== normalizeEmail(invite.email)) throw new Error('INVITE_EMAIL_MISMATCH');\n            await prisma.$transaction(async (tx)=>{\n                await tx.campaignMembership.upsert({\n                    where: {\n                        userId_campaignId: {\n                            userId: input.userId,\n                            campaignId: invite.campaignId\n                        }\n                    },\n                    update: {},\n                    create: {\n                        userId: input.userId,\n                        campaignId: invite.campaignId,\n                        role: 'MEMBER'\n                    }\n                });\n                await tx.campaignInvite.update({\n                    where: {\n                        token: input.token\n                    },\n                    data: {\n                        acceptedAt: new Date(nowMs),\n                        acceptedByUserId: input.userId\n                    },\n                    select: {\n                        id: true\n                    }\n                });\n            });\n            const campaign = await prisma.campaign.findUnique({\n                where: {\n                    id: invite.campaignId\n                },\n                select: {\n                    id: true,\n                    name: true\n                }\n            });\n            if (!campaign) throw new Error('CAMPAIGN_NOT_FOUND');\n            return campaign;\n        },\n        async getUserById (id) {\n            const row = await prisma.user.findUnique({\n                where: {\n                    id\n                },\n                select: {\n                    id: true,\n                    email: true\n                }\n            });\n            return row ?? null;\n        },\n        async findUserByEmail (email) {\n            const row = await prisma.user.findUnique({\n                where: {\n                    email\n                },\n                select: {\n                    id: true,\n                    email: true,\n                    passwordHash: true\n                }\n            });\n            return row ?? null;\n        },\n        async createUser (input) {\n            const row = await prisma.user.create({\n                data: {\n                    email: input.email,\n                    passwordHash: input.passwordHash\n                },\n                select: {\n                    id: true,\n                    email: true\n                }\n            });\n            return row;\n        }\n    };\n}\nfunction createDataSource() {\n    const override = process.env.CYBERDALLAS_DATA_SOURCE;\n    if (override === 'inMemory') {\n        return createInMemoryDataSource();\n    }\n    if (override === 'prisma') {\n        return createPrismaDataSource();\n    }\n    const databaseUrl = process.env.DATABASE_URL;\n    if (!databaseUrl) {\n        return createInMemoryDataSource();\n    }\n    return createPrismaDataSource();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZ3JhcGhxbC9kYXRhU291cmNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQStDO0FBRXVDO0FBQ3JEO0FBc0RqQyxTQUFTUTtJQUNQLGtCQUFrQjtJQUNsQixPQUFPRCw4REFBa0IsQ0FBQyxJQUFJRyxRQUFRLENBQUM7QUFDekM7QUFFQSxTQUFTQyxlQUFlQyxLQUFhO0lBQ25DLE9BQU9BLE1BQU1DLElBQUksR0FBR0MsV0FBVztBQUNqQztBQUVBLFNBQVNDO0lBQ1AsTUFBTUMsUUFBc0IsRUFBRTtJQUM5QixNQUFNQyxrQkFBa0IsSUFBSUM7SUFDNUIsTUFBTUMsVUFBb0MsRUFBRTtJQUU1QyxTQUFTQyxxQkFBcUJDLE1BQWM7UUFDMUMsTUFBTUMsV0FBV0wsZ0JBQWdCTSxHQUFHLENBQUNGO1FBQ3JDLElBQUlDLFVBQVUsT0FBT0E7UUFDckIsTUFBTUUsVUFBVSxJQUFJTjtRQUNwQkQsZ0JBQWdCUSxHQUFHLENBQUNKLFFBQVFHO1FBQzVCLE9BQU9BO0lBQ1Q7SUFFQSxTQUFTRSxlQUFlQyxVQUFrQjtRQUN4QyxLQUFLLE1BQU1DLGVBQWVYLGdCQUFnQlksTUFBTSxHQUFJO1lBQ2xELElBQUlELFlBQVlMLEdBQUcsQ0FBQ0ksZ0JBQWdCLFNBQVMsT0FBTztRQUN0RDtRQUNBLE9BQU87SUFDVDtJQUVBLFNBQVNHLGtCQUFrQkMsU0FBMEI7UUFDbkQsT0FBT0EsVUFBVUMsUUFBUSxLQUFLO0lBQ2hDO0lBRUEsU0FBU0MsNEJBQTRCRixTQUEwQixFQUFFVixNQUFjO1FBQzdFLElBQUksQ0FBQ1UsVUFBVUosVUFBVSxFQUFFLE9BQU87UUFDbEMsT0FBT1AscUJBQXFCQyxRQUFRYSxHQUFHLENBQUNILFVBQVVKLFVBQVU7SUFDOUQ7SUFFQSxPQUFPO1FBQ0xRLE1BQU07UUFDTixNQUFNQyxpQkFBZ0JDLEVBQVU7WUFDOUIsT0FBT3BDLDRDQUFTQSxDQUFDcUMsSUFBSSxDQUFDLENBQUNDLElBQU1BLEVBQUVGLEVBQUUsS0FBS0EsT0FBTztRQUMvQztRQUNBLE1BQU1HO1lBQ0osT0FBT3ZDLDRDQUFTQTtRQUNsQjtRQUNBLE1BQU13QyxzQkFBcUJwQixNQUFjO1lBQ3ZDLE1BQU1PLGNBQWNSLHFCQUFxQkM7WUFDekMsT0FBT3BCLDRDQUFTQSxDQUFDeUMsTUFBTSxDQUFDLENBQUNILElBQU1YLFlBQVlNLEdBQUcsQ0FBQ0ssRUFBRUYsRUFBRTtRQUNyRDtRQUNBLE1BQU1NO1lBQ0osT0FBT3pDLDZDQUFVQTtRQUNuQjtRQUNBLE1BQU0wQyx1QkFBc0J2QixNQUFjO1lBQ3hDLE9BQU9uQiw2Q0FBVUEsQ0FBQ3dDLE1BQU0sQ0FBQyxDQUFDSCxJQUFNVCxrQkFBa0JTLE1BQU1OLDRCQUE0Qk0sR0FBR2xCO1FBQ3pGO1FBQ0EsTUFBTXdCO1lBQ0osT0FBTzFDLDhDQUFXQTtRQUNwQjtRQUNBLE1BQU0yQztZQUNKLE9BQU94QywwQ0FBT0E7UUFDaEI7UUFDQSxNQUFNeUM7WUFDSixPQUFPM0Msd0NBQUtBO1FBQ2Q7UUFDQSxNQUFNNEM7WUFDSixPQUFPM0MsMkNBQVFBO1FBQ2pCO1FBRUEsTUFBTTRDLG1CQUFrQkMsS0FBaUY7WUFDdkcsTUFBTUMsV0FBV2xELDRDQUFTQSxDQUFDcUMsSUFBSSxDQUFDLENBQUNDLElBQU1BLEVBQUVGLEVBQUUsS0FBS2EsTUFBTXZCLFVBQVU7WUFDaEUsSUFBSSxDQUFDd0IsVUFBVSxNQUFNLElBQUlDLE1BQU07WUFFL0IsTUFBTXhCLGNBQWNSLHFCQUFxQjhCLE1BQU03QixNQUFNO1lBQ3JELE1BQU1nQyxjQUNKSCxNQUFNSSxJQUFJLEtBQUssV0FBV0osTUFBTUksSUFBSSxLQUFLLFdBQ3JDSixNQUFNSSxJQUFJLEdBQ1Y1QixlQUFld0IsTUFBTXZCLFVBQVUsSUFDN0IsV0FDQTtZQUVSLGlDQUFpQztZQUNqQyxNQUFNTCxXQUFXTSxZQUFZTCxHQUFHLENBQUMyQixNQUFNdkIsVUFBVTtZQUNqRCxJQUFJTCxhQUFhLFNBQVM7WUFDMUJNLFlBQVlILEdBQUcsQ0FBQ3lCLE1BQU12QixVQUFVLEVBQUUwQjtRQUNwQztRQUVBLE1BQU1FLDJCQUEwQkwsS0FBNkM7WUFDM0UsTUFBTXRCLGNBQWNSLHFCQUFxQjhCLE1BQU03QixNQUFNO1lBQ3JELE9BQU9PLFlBQVlMLEdBQUcsQ0FBQzJCLE1BQU12QixVQUFVLEtBQUs7UUFDOUM7UUFFQSxNQUFNNkIsc0JBQXFCTixLQUEyRDtZQUNwRixNQUFNQyxXQUFXbEQsNENBQVNBLENBQUNxQyxJQUFJLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRUYsRUFBRSxLQUFLYSxNQUFNdkIsVUFBVTtZQUNoRSxJQUFJLENBQUN3QixVQUFVLE1BQU0sSUFBSUMsTUFBTTtZQUUvQixNQUFNSyxRQUFRQyxLQUFLQyxHQUFHO1lBQ3RCLE1BQU1DLFNBQWlDO2dCQUNyQ3ZCLElBQUksQ0FBQyxJQUFJLEVBQUU5Qiw2REFBaUIsSUFBSTtnQkFDaEN1RCxPQUFPdEQ7Z0JBQ1BJLE9BQU9ELGVBQWV1QyxNQUFNdEMsS0FBSztnQkFDakNlLFlBQVl1QixNQUFNdkIsVUFBVTtnQkFDNUJvQyxhQUFhTixRQUFRUCxNQUFNYyxLQUFLO2dCQUNoQ0MsY0FBYztnQkFDZEMsa0JBQWtCO2dCQUNsQkMsYUFBYVY7WUFDZjtZQUNBdEMsUUFBUWlELElBQUksQ0FBQ1I7WUFDYixPQUFPO2dCQUFFRSxPQUFPRixPQUFPRSxLQUFLO2dCQUFFTyxXQUFXLElBQUlYLEtBQUtFLE9BQU9HLFdBQVcsRUFBRU8sV0FBVztZQUFHO1FBQ3RGO1FBRUEsTUFBTUMsc0JBQXFCckIsS0FBMkU7WUFDcEcsTUFBTVUsU0FBU3pDLFFBQVFtQixJQUFJLENBQUMsQ0FBQ2tDLElBQU1BLEVBQUVWLEtBQUssS0FBS1osTUFBTVksS0FBSztZQUMxRCxJQUFJLENBQUNGLFFBQVEsTUFBTSxJQUFJUixNQUFNO1lBRTdCLElBQUlRLE9BQU9LLFlBQVksRUFBRSxNQUFNLElBQUliLE1BQU07WUFFekMsTUFBTUssUUFBUVAsTUFBTU8sS0FBSyxJQUFJQyxLQUFLQyxHQUFHO1lBQ3JDLElBQUlGLFFBQVFHLE9BQU9HLFdBQVcsRUFBRSxNQUFNLElBQUlYLE1BQU07WUFFaEQsSUFBSXpDLGVBQWV1QyxNQUFNdUIsU0FBUyxNQUFNYixPQUFPaEQsS0FBSyxFQUFFLE1BQU0sSUFBSXdDLE1BQU07WUFFdEUsTUFBTSxJQUFJLENBQUNILGlCQUFpQixDQUFDO2dCQUFFNUIsUUFBUTZCLE1BQU03QixNQUFNO2dCQUFFTSxZQUFZaUMsT0FBT2pDLFVBQVU7Z0JBQUUyQixNQUFNO1lBQVM7WUFDbkdNLE9BQU9LLFlBQVksR0FBR1I7WUFDdEJHLE9BQU9NLGdCQUFnQixHQUFHaEIsTUFBTTdCLE1BQU07WUFFdEMsTUFBTThCLFdBQVdsRCw0Q0FBU0EsQ0FBQ3FDLElBQUksQ0FBQyxDQUFDQyxJQUFNQSxFQUFFRixFQUFFLEtBQUt1QixPQUFPakMsVUFBVTtZQUNqRSxJQUFJLENBQUN3QixVQUFVLE1BQU0sSUFBSUMsTUFBTTtZQUMvQixPQUFPRDtRQUNUO1FBRUEsTUFBTXVCLGFBQVlyQyxFQUFVO1lBQzFCLE1BQU1zQyxPQUFPM0QsTUFBTXNCLElBQUksQ0FBQyxDQUFDc0MsSUFBTUEsRUFBRXZDLEVBQUUsS0FBS0E7WUFDeEMsT0FBT3NDLE9BQU87Z0JBQUV0QyxJQUFJc0MsS0FBS3RDLEVBQUU7Z0JBQUV6QixPQUFPK0QsS0FBSy9ELEtBQUs7WUFBQyxJQUFJO1FBQ3JEO1FBQ0EsTUFBTWlFLGlCQUFnQmpFLEtBQWE7WUFDakMsT0FBT0ksTUFBTXNCLElBQUksQ0FBQyxDQUFDc0MsSUFBTUEsRUFBRWhFLEtBQUssQ0FBQ0UsV0FBVyxPQUFPRixNQUFNRSxXQUFXLE9BQU87UUFDN0U7UUFDQSxNQUFNZ0UsWUFBVzVCLEtBQThDO1lBQzdELE1BQU01QixXQUFXTixNQUFNc0IsSUFBSSxDQUFDLENBQUNzQyxJQUFNQSxFQUFFaEUsS0FBSyxDQUFDRSxXQUFXLE9BQU9vQyxNQUFNdEMsS0FBSyxDQUFDRSxXQUFXO1lBQ3BGLElBQUlRLFVBQVU7Z0JBQ1osTUFBTSxJQUFJOEIsTUFBTTtZQUNsQjtZQUVBLE1BQU1mLEtBQUssQ0FBQyxFQUFFLEVBQUVyQixNQUFNK0QsTUFBTSxHQUFHLEdBQUc7WUFDbEMsTUFBTUosT0FBbUI7Z0JBQUV0QztnQkFBSXpCLE9BQU9zQyxNQUFNdEMsS0FBSztnQkFBRW9FLGNBQWM5QixNQUFNOEIsWUFBWTtZQUFDO1lBQ3BGaEUsTUFBTW9ELElBQUksQ0FBQ087WUFDWCxPQUFPO2dCQUFFdEMsSUFBSXNDLEtBQUt0QyxFQUFFO2dCQUFFekIsT0FBTytELEtBQUsvRCxLQUFLO1lBQUM7UUFDMUM7SUFDRjtBQUNGO0FBRUEsU0FBU3FFO0lBQ1AsTUFBTUMsU0FBU2xGLDJEQUFlQTtJQUM5QixPQUFPO1FBQ0xtQyxNQUFNO1FBQ04sTUFBTUMsaUJBQWdCQyxFQUFVO1lBQzlCLE1BQU04QyxNQUFNLE1BQU1ELE9BQU8vQixRQUFRLENBQUNpQyxVQUFVLENBQUM7Z0JBQUVDLE9BQU87b0JBQUVoRDtnQkFBRztnQkFBR2lELFFBQVE7b0JBQUVqRCxJQUFJO29CQUFNa0QsTUFBTTtnQkFBSztZQUFFO1lBQy9GLE9BQU9KLE9BQU87UUFDaEI7UUFDQSxNQUFNM0M7WUFDSixNQUFNZ0QsT0FBTyxNQUFNTixPQUFPL0IsUUFBUSxDQUFDc0MsUUFBUSxDQUFDO2dCQUMxQ0gsUUFBUTtvQkFBRWpELElBQUk7b0JBQU1rRCxNQUFNO2dCQUFLO1lBQ2pDO1lBQ0EsT0FBT0M7UUFDVDtRQUNBLE1BQU0vQyxzQkFBcUJwQixNQUFjO1lBQ3ZDLE1BQU1tRSxPQUFPLE1BQU1OLE9BQU8vQixRQUFRLENBQUNzQyxRQUFRLENBQUM7Z0JBQzFDSixPQUFPO29CQUNMekQsYUFBYTt3QkFDWDhELE1BQU07NEJBQUVyRTt3QkFBTztvQkFDakI7Z0JBQ0Y7Z0JBQ0FpRSxRQUFRO29CQUFFakQsSUFBSTtvQkFBTWtELE1BQU07Z0JBQUs7WUFDakM7WUFDQSxPQUFPQztRQUNUO1FBQ0EsTUFBTTdDO1lBQ0osTUFBTTZDLE9BQU8sTUFBTU4sT0FBT25ELFNBQVMsQ0FBQzBELFFBQVEsQ0FBQztnQkFDM0NILFFBQVE7b0JBQ05qRCxJQUFJO29CQUNKa0QsTUFBTTtvQkFDTnZELFVBQVU7b0JBQ1YyRCxPQUFPO29CQUNQQyxXQUFXO29CQUNYQyxPQUFPO29CQUNQQyxPQUFPO29CQUNQQyxjQUFjO29CQUNkQyxVQUFVO29CQUNWQyxNQUFNO29CQUNOQyxNQUFNO29CQUNOdkUsWUFBWTtvQkFDWndFLFFBQVE7d0JBQUViLFFBQVE7NEJBQUVDLE1BQU07NEJBQU1hLE9BQU87d0JBQUs7b0JBQUU7b0JBQzlDakcsYUFBYTt3QkFBRW1GLFFBQVE7NEJBQUVlLGNBQWM7d0JBQUs7b0JBQUU7b0JBQzlDL0YsU0FBUzt3QkFBRWdGLFFBQVE7NEJBQUVnQixVQUFVO3dCQUFLO29CQUFFO29CQUN0Q2xHLE9BQU87d0JBQUVrRixRQUFROzRCQUFFaUIsUUFBUTt3QkFBSztvQkFBRTtvQkFDbENsRyxVQUFVO3dCQUFFaUYsUUFBUTs0QkFBRWtCLFdBQVc7d0JBQUs7b0JBQUU7Z0JBQzFDO1lBQ0Y7WUFFQSxPQUFPaEIsS0FBS2lCLEdBQUcsQ0FBQyxDQUFDdEIsTUFBUztvQkFDeEI5QyxJQUFJOEMsSUFBSTlDLEVBQUU7b0JBQ1ZrRCxNQUFNSixJQUFJSSxJQUFJO29CQUNkdkQsVUFBVW1ELElBQUluRCxRQUFRO29CQUN0QjJELE9BQU9SLElBQUlRLEtBQUs7b0JBQ2hCQyxXQUFXVCxJQUFJUyxTQUFTO29CQUN4QmpFLFlBQVl3RCxJQUFJeEQsVUFBVTtvQkFDMUIrRSxPQUFPO3dCQUNMYixPQUFPVixJQUFJVSxLQUFLO3dCQUNoQkMsT0FBT1gsSUFBSVcsS0FBSzt3QkFDaEJDLGNBQWNaLElBQUlZLFlBQVk7d0JBQzlCQyxVQUFVYixJQUFJYSxRQUFRO3dCQUN0QkMsTUFBTWQsSUFBSWMsSUFBSTt3QkFDZEMsTUFBTWYsSUFBSWUsSUFBSTtvQkFDaEI7b0JBQ0FDLFFBQVFoQixJQUFJZ0IsTUFBTTtvQkFDbEJRLGVBQWV4QixJQUFJaEYsV0FBVyxDQUFDc0csR0FBRyxDQUFDLENBQUNsRSxJQUFNQSxFQUFFOEQsWUFBWTtvQkFDeERPLFdBQVd6QixJQUFJN0UsT0FBTyxDQUFDbUcsR0FBRyxDQUFDLENBQUNJLElBQU1BLEVBQUVQLFFBQVE7b0JBQzVDUSxTQUFTM0IsSUFBSS9FLEtBQUssQ0FBQ3FHLEdBQUcsQ0FBQyxDQUFDakMsSUFBTUEsRUFBRStCLE1BQU07b0JBQ3RDUSxZQUFZNUIsSUFBSTlFLFFBQVEsQ0FBQ29HLEdBQUcsQ0FBQyxDQUFDTyxJQUFNQSxFQUFFUixTQUFTO2dCQUNqRDtRQUNGO1FBQ0EsTUFBTTVELHVCQUFzQnZCLE1BQWM7WUFDeEMsTUFBTW1FLE9BQU8sTUFBTU4sT0FBT25ELFNBQVMsQ0FBQzBELFFBQVEsQ0FBQztnQkFDM0NKLE9BQU87b0JBQ0w0QixJQUFJO3dCQUNGOzRCQUFFakYsVUFBVTt3QkFBSzt3QkFDakI7NEJBQ0VtQixVQUFVO2dDQUNSdkIsYUFBYTtvQ0FDWDhELE1BQU07d0NBQUVyRTtvQ0FBTztnQ0FDakI7NEJBQ0Y7d0JBQ0Y7cUJBQ0Q7Z0JBQ0g7Z0JBQ0FpRSxRQUFRO29CQUNOakQsSUFBSTtvQkFDSmtELE1BQU07b0JBQ052RCxVQUFVO29CQUNWMkQsT0FBTztvQkFDUEMsV0FBVztvQkFDWEMsT0FBTztvQkFDUEMsT0FBTztvQkFDUEMsY0FBYztvQkFDZEMsVUFBVTtvQkFDVkMsTUFBTTtvQkFDTkMsTUFBTTtvQkFDTnZFLFlBQVk7b0JBQ1p3RSxRQUFRO3dCQUFFYixRQUFROzRCQUFFQyxNQUFNOzRCQUFNYSxPQUFPO3dCQUFLO29CQUFFO29CQUM5Q2pHLGFBQWE7d0JBQUVtRixRQUFROzRCQUFFZSxjQUFjO3dCQUFLO29CQUFFO29CQUM5Qy9GLFNBQVM7d0JBQUVnRixRQUFROzRCQUFFZ0IsVUFBVTt3QkFBSztvQkFBRTtvQkFDdENsRyxPQUFPO3dCQUFFa0YsUUFBUTs0QkFBRWlCLFFBQVE7d0JBQUs7b0JBQUU7b0JBQ2xDbEcsVUFBVTt3QkFBRWlGLFFBQVE7NEJBQUVrQixXQUFXO3dCQUFLO29CQUFFO2dCQUMxQztZQUNGO1lBRUEsT0FBT2hCLEtBQUtpQixHQUFHLENBQUMsQ0FBQ3RCLE1BQVM7b0JBQ3hCOUMsSUFBSThDLElBQUk5QyxFQUFFO29CQUNWa0QsTUFBTUosSUFBSUksSUFBSTtvQkFDZHZELFVBQVVtRCxJQUFJbkQsUUFBUTtvQkFDdEIyRCxPQUFPUixJQUFJUSxLQUFLO29CQUNoQkMsV0FBV1QsSUFBSVMsU0FBUztvQkFDeEJqRSxZQUFZd0QsSUFBSXhELFVBQVU7b0JBQzFCK0UsT0FBTzt3QkFDTGIsT0FBT1YsSUFBSVUsS0FBSzt3QkFDaEJDLE9BQU9YLElBQUlXLEtBQUs7d0JBQ2hCQyxjQUFjWixJQUFJWSxZQUFZO3dCQUM5QkMsVUFBVWIsSUFBSWEsUUFBUTt3QkFDdEJDLE1BQU1kLElBQUljLElBQUk7d0JBQ2RDLE1BQU1mLElBQUllLElBQUk7b0JBQ2hCO29CQUNBQyxRQUFRaEIsSUFBSWdCLE1BQU07b0JBQ2xCUSxlQUFleEIsSUFBSWhGLFdBQVcsQ0FBQ3NHLEdBQUcsQ0FBQyxDQUFDbEUsSUFBTUEsRUFBRThELFlBQVk7b0JBQ3hETyxXQUFXekIsSUFBSTdFLE9BQU8sQ0FBQ21HLEdBQUcsQ0FBQyxDQUFDSSxJQUFNQSxFQUFFUCxRQUFRO29CQUM1Q1EsU0FBUzNCLElBQUkvRSxLQUFLLENBQUNxRyxHQUFHLENBQUMsQ0FBQ2pDLElBQU1BLEVBQUUrQixNQUFNO29CQUN0Q1EsWUFBWTVCLElBQUk5RSxRQUFRLENBQUNvRyxHQUFHLENBQUMsQ0FBQ08sSUFBTUEsRUFBRVIsU0FBUztnQkFDakQ7UUFDRjtRQUNBLE1BQU0zRDtZQUNKLE9BQU9xQyxPQUFPZ0MsVUFBVSxDQUFDekIsUUFBUSxDQUFDO2dCQUNoQ0gsUUFBUTtvQkFDTmpELElBQUk7b0JBQ0prRCxNQUFNO29CQUNONEIsa0JBQWtCO29CQUNsQkMsaUJBQWlCO29CQUNqQkMsT0FBTztvQkFDUEMsYUFBYTtnQkFDZjtZQUNGO1FBQ0Y7UUFDQSxNQUFNeEU7WUFDSixNQUFNMEMsT0FBTyxNQUFNTixPQUFPcUMsTUFBTSxDQUFDOUIsUUFBUSxDQUFDO2dCQUN4Q0gsUUFBUTtvQkFDTmpELElBQUk7b0JBQ0prRCxNQUFNO29CQUNOOEIsT0FBTztvQkFDUEcsUUFBUTtvQkFDUkMsVUFBVTtvQkFDVkMsY0FBYztvQkFDZEMsTUFBTTtvQkFDTkMsV0FBVztvQkFDWFQsa0JBQWtCO29CQUNsQkMsaUJBQWlCO2dCQUNuQjtZQUNGO1lBQ0EsT0FBTzVCLEtBQUtpQixHQUFHLENBQUMsQ0FBQ3RCLE1BQVM7b0JBQ3hCLEdBQUdBLEdBQUc7b0JBQ053QyxNQUFNeEMsSUFBSXdDLElBQUk7Z0JBQ2hCO1FBQ0Y7UUFDQSxNQUFNNUU7WUFDSixNQUFNeUMsT0FBTyxNQUFNTixPQUFPMkMsSUFBSSxDQUFDcEMsUUFBUSxDQUFDO2dCQUN0Q0gsUUFBUTtvQkFDTmpELElBQUk7b0JBQ0prRCxNQUFNO29CQUNOOEIsT0FBTztvQkFDUEcsUUFBUTtvQkFDUkcsTUFBTTtvQkFDTlIsa0JBQWtCO29CQUNsQkMsaUJBQWlCO2dCQUNuQjtZQUNGO1lBQ0EsT0FBTzVCLEtBQUtpQixHQUFHLENBQUMsQ0FBQ3RCLE1BQVM7b0JBQ3hCLEdBQUdBLEdBQUc7b0JBQ053QyxNQUFNeEMsSUFBSXdDLElBQUk7Z0JBQ2hCO1FBQ0Y7UUFDQSxNQUFNM0U7WUFDSixPQUFPa0MsT0FBTzRDLE9BQU8sQ0FBQ3JDLFFBQVEsQ0FBQztnQkFDN0JILFFBQVE7b0JBQ05qRCxJQUFJO29CQUNKa0QsTUFBTTtvQkFDTjhCLE9BQU87b0JBQ1BGLGtCQUFrQjtvQkFDbEJDLGlCQUFpQjtvQkFDakJ6QixPQUFPO29CQUNQb0MsT0FBTztnQkFDVDtZQUNGO1FBQ0Y7UUFFQSxNQUFNOUUsbUJBQWtCQyxLQUFpRjtZQUN2RyxNQUFNZ0MsT0FBTzhDLFlBQVksQ0FBQyxPQUFPQztnQkFDL0IsTUFBTUMsYUFBYSxNQUFNRCxHQUFHRSxrQkFBa0IsQ0FBQ0MsS0FBSyxDQUFDO29CQUNuRC9DLE9BQU87d0JBQUUxRCxZQUFZdUIsTUFBTXZCLFVBQVU7d0JBQUUyQixNQUFNO29CQUFRO2dCQUN2RDtnQkFFQSxNQUFNRCxjQUNKSCxNQUFNSSxJQUFJLEtBQUssV0FBV0osTUFBTUksSUFBSSxLQUFLLFdBQ3JDSixNQUFNSSxJQUFJLEdBQ1Y0RSxhQUFhLElBQ1gsV0FDQTtnQkFFUixNQUFNRCxHQUFHRSxrQkFBa0IsQ0FBQ0UsTUFBTSxDQUFDO29CQUNqQ2hELE9BQU87d0JBQUVpRCxtQkFBbUI7NEJBQUVqSCxRQUFRNkIsTUFBTTdCLE1BQU07NEJBQUVNLFlBQVl1QixNQUFNdkIsVUFBVTt3QkFBQztvQkFBRTtvQkFDbkY0RyxRQUFRbEYsZ0JBQWdCLFVBQVU7d0JBQUVDLE1BQU07b0JBQVEsSUFBSSxDQUFDO29CQUN2RGtGLFFBQVE7d0JBQUVuSCxRQUFRNkIsTUFBTTdCLE1BQU07d0JBQUVNLFlBQVl1QixNQUFNdkIsVUFBVTt3QkFBRTJCLE1BQU1EO29CQUFZO2dCQUNsRjtZQUNGO1FBQ0Y7UUFFQSxNQUFNRSwyQkFBMEJMLEtBQTZDO1lBQzNFLE1BQU1pQyxNQUFNLE1BQU1ELE9BQU9pRCxrQkFBa0IsQ0FBQy9DLFVBQVUsQ0FBQztnQkFDckRDLE9BQU87b0JBQUVpRCxtQkFBbUI7d0JBQUVqSCxRQUFRNkIsTUFBTTdCLE1BQU07d0JBQUVNLFlBQVl1QixNQUFNdkIsVUFBVTtvQkFBQztnQkFBRTtnQkFDbkYyRCxRQUFRO29CQUFFaEMsTUFBTTtnQkFBSztZQUN2QjtZQUNBLE9BQU82QixLQUFLN0IsUUFBUTtRQUN0QjtRQUVBLE1BQU1FLHNCQUFxQk4sS0FBMkQ7WUFDcEYsTUFBTUMsV0FBVyxNQUFNK0IsT0FBTy9CLFFBQVEsQ0FBQ2lDLFVBQVUsQ0FBQztnQkFBRUMsT0FBTztvQkFBRWhELElBQUlhLE1BQU12QixVQUFVO2dCQUFDO2dCQUFHMkQsUUFBUTtvQkFBRWpELElBQUk7Z0JBQUs7WUFBRTtZQUMxRyxJQUFJLENBQUNjLFVBQVUsTUFBTSxJQUFJQyxNQUFNO1lBRS9CLE1BQU1VLFFBQVF0RDtZQUNkLE1BQU02RCxZQUFZLElBQUlYLEtBQUtBLEtBQUtDLEdBQUcsS0FBS1QsTUFBTWMsS0FBSztZQUVuRCxNQUFNa0IsT0FBT3VELGNBQWMsQ0FBQ0QsTUFBTSxDQUFDO2dCQUNqQ0UsTUFBTTtvQkFDSjVFO29CQUNBbEQsT0FBT0QsZUFBZXVDLE1BQU10QyxLQUFLO29CQUNqQ2UsWUFBWXVCLE1BQU12QixVQUFVO29CQUM1QjBDO2dCQUNGO2dCQUNBaUIsUUFBUTtvQkFBRWpELElBQUk7Z0JBQUs7WUFDckI7WUFFQSxPQUFPO2dCQUFFeUI7Z0JBQU9PLFdBQVdBLFVBQVVDLFdBQVc7WUFBRztRQUNyRDtRQUVBLE1BQU1DLHNCQUFxQnJCLEtBQTJFO1lBQ3BHLE1BQU1VLFNBQVMsTUFBTXNCLE9BQU91RCxjQUFjLENBQUNyRCxVQUFVLENBQUM7Z0JBQ3BEQyxPQUFPO29CQUFFdkIsT0FBT1osTUFBTVksS0FBSztnQkFBQztnQkFDNUJ3QixRQUFRO29CQUNOeEIsT0FBTztvQkFDUGxELE9BQU87b0JBQ1BlLFlBQVk7b0JBQ1owQyxXQUFXO29CQUNYc0UsWUFBWTtnQkFDZDtZQUNGO1lBRUEsSUFBSSxDQUFDL0UsUUFBUSxNQUFNLElBQUlSLE1BQU07WUFDN0IsSUFBSVEsT0FBTytFLFVBQVUsRUFBRSxNQUFNLElBQUl2RixNQUFNO1lBRXZDLE1BQU1LLFFBQVFQLE1BQU1PLEtBQUssSUFBSUMsS0FBS0MsR0FBRztZQUNyQyxJQUFJRixRQUFRRyxPQUFPUyxTQUFTLENBQUN1RSxPQUFPLElBQUksTUFBTSxJQUFJeEYsTUFBTTtZQUV4RCxJQUFJekMsZUFBZXVDLE1BQU11QixTQUFTLE1BQU05RCxlQUFlaUQsT0FBT2hELEtBQUssR0FBRyxNQUFNLElBQUl3QyxNQUFNO1lBRXRGLE1BQU04QixPQUFPOEMsWUFBWSxDQUFDLE9BQU9DO2dCQUMvQixNQUFNQSxHQUFHRSxrQkFBa0IsQ0FBQ0UsTUFBTSxDQUFDO29CQUNqQ2hELE9BQU87d0JBQUVpRCxtQkFBbUI7NEJBQUVqSCxRQUFRNkIsTUFBTTdCLE1BQU07NEJBQUVNLFlBQVlpQyxPQUFPakMsVUFBVTt3QkFBQztvQkFBRTtvQkFDcEY0RyxRQUFRLENBQUM7b0JBQ1RDLFFBQVE7d0JBQUVuSCxRQUFRNkIsTUFBTTdCLE1BQU07d0JBQUVNLFlBQVlpQyxPQUFPakMsVUFBVTt3QkFBRTJCLE1BQU07b0JBQVM7Z0JBQ2hGO2dCQUVBLE1BQU0yRSxHQUFHUSxjQUFjLENBQUNGLE1BQU0sQ0FBQztvQkFDN0JsRCxPQUFPO3dCQUFFdkIsT0FBT1osTUFBTVksS0FBSztvQkFBQztvQkFDNUI0RSxNQUFNO3dCQUNKQyxZQUFZLElBQUlqRixLQUFLRDt3QkFDckJTLGtCQUFrQmhCLE1BQU03QixNQUFNO29CQUNoQztvQkFDQWlFLFFBQVE7d0JBQUVqRCxJQUFJO29CQUFLO2dCQUNyQjtZQUNGO1lBRUEsTUFBTWMsV0FBVyxNQUFNK0IsT0FBTy9CLFFBQVEsQ0FBQ2lDLFVBQVUsQ0FBQztnQkFBRUMsT0FBTztvQkFBRWhELElBQUl1QixPQUFPakMsVUFBVTtnQkFBQztnQkFBRzJELFFBQVE7b0JBQUVqRCxJQUFJO29CQUFNa0QsTUFBTTtnQkFBSztZQUFFO1lBQ3ZILElBQUksQ0FBQ3BDLFVBQVUsTUFBTSxJQUFJQyxNQUFNO1lBQy9CLE9BQU9EO1FBQ1Q7UUFFQSxNQUFNdUIsYUFBWXJDLEVBQVU7WUFDMUIsTUFBTThDLE1BQU0sTUFBTUQsT0FBT1AsSUFBSSxDQUFDUyxVQUFVLENBQUM7Z0JBQ3ZDQyxPQUFPO29CQUFFaEQ7Z0JBQUc7Z0JBQ1ppRCxRQUFRO29CQUFFakQsSUFBSTtvQkFBTXpCLE9BQU87Z0JBQUs7WUFDbEM7WUFDQSxPQUFPdUUsT0FBTztRQUNoQjtRQUNBLE1BQU1OLGlCQUFnQmpFLEtBQWE7WUFDakMsTUFBTXVFLE1BQU0sTUFBTUQsT0FBT1AsSUFBSSxDQUFDUyxVQUFVLENBQUM7Z0JBQ3ZDQyxPQUFPO29CQUFFekU7Z0JBQU07Z0JBQ2YwRSxRQUFRO29CQUFFakQsSUFBSTtvQkFBTXpCLE9BQU87b0JBQU1vRSxjQUFjO2dCQUFLO1lBQ3REO1lBQ0EsT0FBT0csT0FBTztRQUNoQjtRQUNBLE1BQU1MLFlBQVc1QixLQUE4QztZQUM3RCxNQUFNaUMsTUFBTSxNQUFNRCxPQUFPUCxJQUFJLENBQUM2RCxNQUFNLENBQUM7Z0JBQ25DRSxNQUFNO29CQUFFOUgsT0FBT3NDLE1BQU10QyxLQUFLO29CQUFFb0UsY0FBYzlCLE1BQU04QixZQUFZO2dCQUFDO2dCQUM3RE0sUUFBUTtvQkFBRWpELElBQUk7b0JBQU16QixPQUFPO2dCQUFLO1lBQ2xDO1lBQ0EsT0FBT3VFO1FBQ1Q7SUFDRjtBQUNGO0FBRU8sU0FBUzBEO0lBQ2QsTUFBTUMsV0FBV0MsUUFBUUMsR0FBRyxDQUFDQyx1QkFBdUI7SUFDcEQsSUFBSUgsYUFBYSxZQUFZO1FBQzNCLE9BQU8vSDtJQUNUO0lBQ0EsSUFBSStILGFBQWEsVUFBVTtRQUN6QixPQUFPN0Q7SUFDVDtJQUVBLE1BQU1pRSxjQUFjSCxRQUFRQyxHQUFHLENBQUNHLFlBQVk7SUFDNUMsSUFBSSxDQUFDRCxhQUFhO1FBQ2hCLE9BQU9uSTtJQUNUO0lBQ0EsT0FBT2tFO0FBQ1QiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9zcmMvZ3JhcGhxbC9kYXRhU291cmNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFByaXNtYUNsaWVudCB9IGZyb20gJy4uL2RiL3ByaXNtYSc7XG5pbXBvcnQgdHlwZSB7IENhbXBhaWduUmVjb3JkLCBDaGFyYWN0ZXJSZWNvcmQsIEN5YmVybmV0aWNSZWNvcmQsIEl0ZW1SZWNvcmQsIFZlaGljbGVSZWNvcmQsIFdlYXBvblJlY29yZCB9IGZyb20gJy4vc2VlZCc7XG5pbXBvcnQgeyBjYW1wYWlnbnMsIGNoYXJhY3RlcnMsIGN5YmVybmV0aWNzLCBpdGVtcywgdmVoaWNsZXMsIHdlYXBvbnMgfSBmcm9tICcuL3NlZWQnO1xuaW1wb3J0IGNyeXB0byBmcm9tICdub2RlOmNyeXB0byc7XG5cbmV4cG9ydCB0eXBlIFVzZXJSZWNvcmQgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHBhc3N3b3JkSGFzaDogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgRGF0YVNvdXJjZUtpbmQgPSAnaW5NZW1vcnknIHwgJ3ByaXNtYSc7XG5cbmV4cG9ydCB0eXBlIERhdGFTb3VyY2UgPSB7XG4gIGtpbmQ6IERhdGFTb3VyY2VLaW5kO1xuICBnZXRDYW1wYWlnbkJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Q2FtcGFpZ25SZWNvcmQgfCBudWxsPjtcbiAgbGlzdENhbXBhaWducygpOiBQcm9taXNlPENhbXBhaWduUmVjb3JkW10+O1xuICBsaXN0Q2FtcGFpZ25zRm9yVXNlcih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Q2FtcGFpZ25SZWNvcmRbXT47XG4gIGxpc3RDaGFyYWN0ZXJzKCk6IFByb21pc2U8Q2hhcmFjdGVyUmVjb3JkW10+O1xuICBsaXN0Q2hhcmFjdGVyc0ZvclVzZXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPENoYXJhY3RlclJlY29yZFtdPjtcbiAgbGlzdEN5YmVybmV0aWNzKCk6IFByb21pc2U8Q3liZXJuZXRpY1JlY29yZFtdPjtcbiAgbGlzdFdlYXBvbnMoKTogUHJvbWlzZTxXZWFwb25SZWNvcmRbXT47XG4gIGxpc3RJdGVtcygpOiBQcm9taXNlPEl0ZW1SZWNvcmRbXT47XG4gIGxpc3RWZWhpY2xlcygpOiBQcm9taXNlPFZlaGljbGVSZWNvcmRbXT47XG5cbiAgYWRkVXNlclRvQ2FtcGFpZ24oaW5wdXQ6IHtcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICBjYW1wYWlnbklkOiBzdHJpbmc7XG4gICAgcm9sZT86ICdBVVRPJyB8ICdPV05FUicgfCAnTUVNQkVSJztcbiAgfSk6IFByb21pc2U8dm9pZD47XG5cbiAgZ2V0Q2FtcGFpZ25NZW1iZXJzaGlwUm9sZShpbnB1dDogeyB1c2VySWQ6IHN0cmluZzsgY2FtcGFpZ25JZDogc3RyaW5nIH0pOiBQcm9taXNlPCdPV05FUicgfCAnTUVNQkVSJyB8IG51bGw+O1xuXG4gIGNyZWF0ZUNhbXBhaWduSW52aXRlKGlucHV0OiB7IGNhbXBhaWduSWQ6IHN0cmluZzsgZW1haWw6IHN0cmluZzsgdHRsTXM6IG51bWJlciB9KTogUHJvbWlzZTx7IHRva2VuOiBzdHJpbmc7IGV4cGlyZXNBdDogc3RyaW5nIH0+O1xuICBhY2NlcHRDYW1wYWlnbkludml0ZShpbnB1dDoge1xuICAgIHRva2VuOiBzdHJpbmc7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgdXNlckVtYWlsOiBzdHJpbmc7XG4gICAgbm93TXM/OiBudW1iZXI7XG4gIH0pOiBQcm9taXNlPENhbXBhaWduUmVjb3JkPjtcblxuICBnZXRVc2VyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxQaWNrPFVzZXJSZWNvcmQsICdpZCcgfCAnZW1haWwnPiB8IG51bGw+O1xuICBmaW5kVXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlclJlY29yZCB8IG51bGw+O1xuICBjcmVhdGVVc2VyKGlucHV0OiB7IGVtYWlsOiBzdHJpbmc7IHBhc3N3b3JkSGFzaDogc3RyaW5nIH0pOiBQcm9taXNlPFBpY2s8VXNlclJlY29yZCwgJ2lkJyB8ICdlbWFpbCc+Pjtcbn07XG5cbnR5cGUgSW5NZW1vcnlDYW1wYWlnbkludml0ZSA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdG9rZW46IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgY2FtcGFpZ25JZDogc3RyaW5nO1xuICBleHBpcmVzQXRNczogbnVtYmVyO1xuICBhY2NlcHRlZEF0TXM6IG51bWJlciB8IG51bGw7XG4gIGFjY2VwdGVkQnlVc2VySWQ6IHN0cmluZyB8IG51bGw7XG4gIGNyZWF0ZWRBdE1zOiBudW1iZXI7XG59O1xuXG5mdW5jdGlvbiBnZW5lcmF0ZUludml0ZVRva2VuKCk6IHN0cmluZyB7XG4gIC8vIFVSTC1zYWZlIHRva2VuLlxuICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKDI0KS50b1N0cmluZygnYmFzZTY0dXJsJyk7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZUVtYWlsKGVtYWlsOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUluTWVtb3J5RGF0YVNvdXJjZSgpOiBEYXRhU291cmNlIHtcbiAgY29uc3QgdXNlcnM6IFVzZXJSZWNvcmRbXSA9IFtdO1xuICBjb25zdCBjYW1wYWlnbk1lbWJlcnMgPSBuZXcgTWFwPHN0cmluZywgTWFwPHN0cmluZywgJ09XTkVSJyB8ICdNRU1CRVInPj4oKTtcbiAgY29uc3QgaW52aXRlczogSW5NZW1vcnlDYW1wYWlnbkludml0ZVtdID0gW107XG5cbiAgZnVuY3Rpb24gZ2V0TWVtYmVyc2hpcHNCeVVzZXIodXNlcklkOiBzdHJpbmcpOiBNYXA8c3RyaW5nLCAnT1dORVInIHwgJ01FTUJFUic+IHtcbiAgICBjb25zdCBleGlzdGluZyA9IGNhbXBhaWduTWVtYmVycy5nZXQodXNlcklkKTtcbiAgICBpZiAoZXhpc3RpbmcpIHJldHVybiBleGlzdGluZztcbiAgICBjb25zdCBjcmVhdGVkID0gbmV3IE1hcDxzdHJpbmcsICdPV05FUicgfCAnTUVNQkVSJz4oKTtcbiAgICBjYW1wYWlnbk1lbWJlcnMuc2V0KHVzZXJJZCwgY3JlYXRlZCk7XG4gICAgcmV0dXJuIGNyZWF0ZWQ7XG4gIH1cblxuICBmdW5jdGlvbiBhbnlPd25lckV4aXN0cyhjYW1wYWlnbklkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBmb3IgKGNvbnN0IG1lbWJlcnNoaXBzIG9mIGNhbXBhaWduTWVtYmVycy52YWx1ZXMoKSkge1xuICAgICAgaWYgKG1lbWJlcnNoaXBzLmdldChjYW1wYWlnbklkKSA9PT0gJ09XTkVSJykgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUHVibGljQ2hhcmFjdGVyKGNoYXJhY3RlcjogQ2hhcmFjdGVyUmVjb3JkKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGNoYXJhY3Rlci5pc1B1YmxpYyA9PT0gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzQ2hhcmFjdGVySW5NZW1iZXJDYW1wYWlnbihjaGFyYWN0ZXI6IENoYXJhY3RlclJlY29yZCwgdXNlcklkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIWNoYXJhY3Rlci5jYW1wYWlnbklkKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIGdldE1lbWJlcnNoaXBzQnlVc2VyKHVzZXJJZCkuaGFzKGNoYXJhY3Rlci5jYW1wYWlnbklkKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAga2luZDogJ2luTWVtb3J5JyxcbiAgICBhc3luYyBnZXRDYW1wYWlnbkJ5SWQoaWQ6IHN0cmluZykge1xuICAgICAgcmV0dXJuIGNhbXBhaWducy5maW5kKChjKSA9PiBjLmlkID09PSBpZCkgPz8gbnVsbDtcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RDYW1wYWlnbnMoKSB7XG4gICAgICByZXR1cm4gY2FtcGFpZ25zO1xuICAgIH0sXG4gICAgYXN5bmMgbGlzdENhbXBhaWduc0ZvclVzZXIodXNlcklkOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IG1lbWJlcnNoaXBzID0gZ2V0TWVtYmVyc2hpcHNCeVVzZXIodXNlcklkKTtcbiAgICAgIHJldHVybiBjYW1wYWlnbnMuZmlsdGVyKChjKSA9PiBtZW1iZXJzaGlwcy5oYXMoYy5pZCkpO1xuICAgIH0sXG4gICAgYXN5bmMgbGlzdENoYXJhY3RlcnMoKSB7XG4gICAgICByZXR1cm4gY2hhcmFjdGVycztcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RDaGFyYWN0ZXJzRm9yVXNlcih1c2VySWQ6IHN0cmluZykge1xuICAgICAgcmV0dXJuIGNoYXJhY3RlcnMuZmlsdGVyKChjKSA9PiBpc1B1YmxpY0NoYXJhY3RlcihjKSB8fCBpc0NoYXJhY3RlckluTWVtYmVyQ2FtcGFpZ24oYywgdXNlcklkKSk7XG4gICAgfSxcbiAgICBhc3luYyBsaXN0Q3liZXJuZXRpY3MoKSB7XG4gICAgICByZXR1cm4gY3liZXJuZXRpY3M7XG4gICAgfSxcbiAgICBhc3luYyBsaXN0V2VhcG9ucygpIHtcbiAgICAgIHJldHVybiB3ZWFwb25zO1xuICAgIH0sXG4gICAgYXN5bmMgbGlzdEl0ZW1zKCkge1xuICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH0sXG4gICAgYXN5bmMgbGlzdFZlaGljbGVzKCkge1xuICAgICAgcmV0dXJuIHZlaGljbGVzO1xuICAgIH0sXG5cbiAgICBhc3luYyBhZGRVc2VyVG9DYW1wYWlnbihpbnB1dDogeyB1c2VySWQ6IHN0cmluZzsgY2FtcGFpZ25JZDogc3RyaW5nOyByb2xlPzogJ0FVVE8nIHwgJ09XTkVSJyB8ICdNRU1CRVInIH0pIHtcbiAgICAgIGNvbnN0IGNhbXBhaWduID0gY2FtcGFpZ25zLmZpbmQoKGMpID0+IGMuaWQgPT09IGlucHV0LmNhbXBhaWduSWQpO1xuICAgICAgaWYgKCFjYW1wYWlnbikgdGhyb3cgbmV3IEVycm9yKCdDQU1QQUlHTl9OT1RfRk9VTkQnKTtcblxuICAgICAgY29uc3QgbWVtYmVyc2hpcHMgPSBnZXRNZW1iZXJzaGlwc0J5VXNlcihpbnB1dC51c2VySWQpO1xuICAgICAgY29uc3QgZGVzaXJlZFJvbGUgPVxuICAgICAgICBpbnB1dC5yb2xlID09PSAnT1dORVInIHx8IGlucHV0LnJvbGUgPT09ICdNRU1CRVInXG4gICAgICAgICAgPyBpbnB1dC5yb2xlXG4gICAgICAgICAgOiBhbnlPd25lckV4aXN0cyhpbnB1dC5jYW1wYWlnbklkKVxuICAgICAgICAgICAgPyAnTUVNQkVSJ1xuICAgICAgICAgICAgOiAnT1dORVInO1xuXG4gICAgICAvLyBPbmx5IHVwZ3JhZGU7IG5ldmVyIGRvd25ncmFkZS5cbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gbWVtYmVyc2hpcHMuZ2V0KGlucHV0LmNhbXBhaWduSWQpO1xuICAgICAgaWYgKGV4aXN0aW5nID09PSAnT1dORVInKSByZXR1cm47XG4gICAgICBtZW1iZXJzaGlwcy5zZXQoaW5wdXQuY2FtcGFpZ25JZCwgZGVzaXJlZFJvbGUpO1xuICAgIH0sXG5cbiAgICBhc3luYyBnZXRDYW1wYWlnbk1lbWJlcnNoaXBSb2xlKGlucHV0OiB7IHVzZXJJZDogc3RyaW5nOyBjYW1wYWlnbklkOiBzdHJpbmcgfSkge1xuICAgICAgY29uc3QgbWVtYmVyc2hpcHMgPSBnZXRNZW1iZXJzaGlwc0J5VXNlcihpbnB1dC51c2VySWQpO1xuICAgICAgcmV0dXJuIG1lbWJlcnNoaXBzLmdldChpbnB1dC5jYW1wYWlnbklkKSA/PyBudWxsO1xuICAgIH0sXG5cbiAgICBhc3luYyBjcmVhdGVDYW1wYWlnbkludml0ZShpbnB1dDogeyBjYW1wYWlnbklkOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmc7IHR0bE1zOiBudW1iZXIgfSkge1xuICAgICAgY29uc3QgY2FtcGFpZ24gPSBjYW1wYWlnbnMuZmluZCgoYykgPT4gYy5pZCA9PT0gaW5wdXQuY2FtcGFpZ25JZCk7XG4gICAgICBpZiAoIWNhbXBhaWduKSB0aHJvdyBuZXcgRXJyb3IoJ0NBTVBBSUdOX05PVF9GT1VORCcpO1xuXG4gICAgICBjb25zdCBub3dNcyA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBpbnZpdGU6IEluTWVtb3J5Q2FtcGFpZ25JbnZpdGUgPSB7XG4gICAgICAgIGlkOiBgaW52XyR7Y3J5cHRvLnJhbmRvbVVVSUQoKX1gLFxuICAgICAgICB0b2tlbjogZ2VuZXJhdGVJbnZpdGVUb2tlbigpLFxuICAgICAgICBlbWFpbDogbm9ybWFsaXplRW1haWwoaW5wdXQuZW1haWwpLFxuICAgICAgICBjYW1wYWlnbklkOiBpbnB1dC5jYW1wYWlnbklkLFxuICAgICAgICBleHBpcmVzQXRNczogbm93TXMgKyBpbnB1dC50dGxNcyxcbiAgICAgICAgYWNjZXB0ZWRBdE1zOiBudWxsLFxuICAgICAgICBhY2NlcHRlZEJ5VXNlcklkOiBudWxsLFxuICAgICAgICBjcmVhdGVkQXRNczogbm93TXMsXG4gICAgICB9O1xuICAgICAgaW52aXRlcy5wdXNoKGludml0ZSk7XG4gICAgICByZXR1cm4geyB0b2tlbjogaW52aXRlLnRva2VuLCBleHBpcmVzQXQ6IG5ldyBEYXRlKGludml0ZS5leHBpcmVzQXRNcykudG9JU09TdHJpbmcoKSB9O1xuICAgIH0sXG5cbiAgICBhc3luYyBhY2NlcHRDYW1wYWlnbkludml0ZShpbnB1dDogeyB0b2tlbjogc3RyaW5nOyB1c2VySWQ6IHN0cmluZzsgdXNlckVtYWlsOiBzdHJpbmc7IG5vd01zPzogbnVtYmVyIH0pIHtcbiAgICAgIGNvbnN0IGludml0ZSA9IGludml0ZXMuZmluZCgoaSkgPT4gaS50b2tlbiA9PT0gaW5wdXQudG9rZW4pO1xuICAgICAgaWYgKCFpbnZpdGUpIHRocm93IG5ldyBFcnJvcignSU5WSVRFX05PVF9GT1VORCcpO1xuXG4gICAgICBpZiAoaW52aXRlLmFjY2VwdGVkQXRNcykgdGhyb3cgbmV3IEVycm9yKCdJTlZJVEVfQUxSRUFEWV9VU0VEJyk7XG5cbiAgICAgIGNvbnN0IG5vd01zID0gaW5wdXQubm93TXMgPz8gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChub3dNcyA+IGludml0ZS5leHBpcmVzQXRNcykgdGhyb3cgbmV3IEVycm9yKCdJTlZJVEVfRVhQSVJFRCcpO1xuXG4gICAgICBpZiAobm9ybWFsaXplRW1haWwoaW5wdXQudXNlckVtYWlsKSAhPT0gaW52aXRlLmVtYWlsKSB0aHJvdyBuZXcgRXJyb3IoJ0lOVklURV9FTUFJTF9NSVNNQVRDSCcpO1xuXG4gICAgICBhd2FpdCB0aGlzLmFkZFVzZXJUb0NhbXBhaWduKHsgdXNlcklkOiBpbnB1dC51c2VySWQsIGNhbXBhaWduSWQ6IGludml0ZS5jYW1wYWlnbklkLCByb2xlOiAnTUVNQkVSJyB9KTtcbiAgICAgIGludml0ZS5hY2NlcHRlZEF0TXMgPSBub3dNcztcbiAgICAgIGludml0ZS5hY2NlcHRlZEJ5VXNlcklkID0gaW5wdXQudXNlcklkO1xuXG4gICAgICBjb25zdCBjYW1wYWlnbiA9IGNhbXBhaWducy5maW5kKChjKSA9PiBjLmlkID09PSBpbnZpdGUuY2FtcGFpZ25JZCk7XG4gICAgICBpZiAoIWNhbXBhaWduKSB0aHJvdyBuZXcgRXJyb3IoJ0NBTVBBSUdOX05PVF9GT1VORCcpO1xuICAgICAgcmV0dXJuIGNhbXBhaWduO1xuICAgIH0sXG5cbiAgICBhc3luYyBnZXRVc2VyQnlJZChpZDogc3RyaW5nKSB7XG4gICAgICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gaWQpO1xuICAgICAgcmV0dXJuIHVzZXIgPyB7IGlkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCB9IDogbnVsbDtcbiAgICB9LFxuICAgIGFzeW5jIGZpbmRVc2VyQnlFbWFpbChlbWFpbDogc3RyaW5nKSB7XG4gICAgICByZXR1cm4gdXNlcnMuZmluZCgodSkgPT4gdS5lbWFpbC50b0xvd2VyQ2FzZSgpID09PSBlbWFpbC50b0xvd2VyQ2FzZSgpKSA/PyBudWxsO1xuICAgIH0sXG4gICAgYXN5bmMgY3JlYXRlVXNlcihpbnB1dDogeyBlbWFpbDogc3RyaW5nOyBwYXNzd29yZEhhc2g6IHN0cmluZyB9KSB7XG4gICAgICBjb25zdCBleGlzdGluZyA9IHVzZXJzLmZpbmQoKHUpID0+IHUuZW1haWwudG9Mb3dlckNhc2UoKSA9PT0gaW5wdXQuZW1haWwudG9Mb3dlckNhc2UoKSk7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEVVBMSUNBVEVfRU1BSUwnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaWQgPSBgdV8ke3VzZXJzLmxlbmd0aCArIDF9YDtcbiAgICAgIGNvbnN0IHVzZXI6IFVzZXJSZWNvcmQgPSB7IGlkLCBlbWFpbDogaW5wdXQuZW1haWwsIHBhc3N3b3JkSGFzaDogaW5wdXQucGFzc3dvcmRIYXNoIH07XG4gICAgICB1c2Vycy5wdXNoKHVzZXIpO1xuICAgICAgcmV0dXJuIHsgaWQ6IHVzZXIuaWQsIGVtYWlsOiB1c2VyLmVtYWlsIH07XG4gICAgfSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUHJpc21hRGF0YVNvdXJjZSgpOiBEYXRhU291cmNlIHtcbiAgY29uc3QgcHJpc21hID0gZ2V0UHJpc21hQ2xpZW50KCk7XG4gIHJldHVybiB7XG4gICAga2luZDogJ3ByaXNtYScsXG4gICAgYXN5bmMgZ2V0Q2FtcGFpZ25CeUlkKGlkOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IHJvdyA9IGF3YWl0IHByaXNtYS5jYW1wYWlnbi5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQgfSwgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlIH0gfSk7XG4gICAgICByZXR1cm4gcm93ID8/IG51bGw7XG4gICAgfSxcbiAgICBhc3luYyBsaXN0Q2FtcGFpZ25zKCkge1xuICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHByaXNtYS5jYW1wYWlnbi5maW5kTWFueSh7XG4gICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcm93cztcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RDYW1wYWlnbnNGb3JVc2VyKHVzZXJJZDogc3RyaW5nKSB7XG4gICAgICBjb25zdCByb3dzID0gYXdhaXQgcHJpc21hLmNhbXBhaWduLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBtZW1iZXJzaGlwczoge1xuICAgICAgICAgICAgc29tZTogeyB1c2VySWQgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJvd3M7XG4gICAgfSxcbiAgICBhc3luYyBsaXN0Q2hhcmFjdGVycygpIHtcbiAgICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBwcmlzbWEuY2hhcmFjdGVyLmZpbmRNYW55KHtcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBpc1B1YmxpYzogdHJ1ZSxcbiAgICAgICAgICBzcGVlZDogdHJ1ZSxcbiAgICAgICAgICBoaXRQb2ludHM6IHRydWUsXG4gICAgICAgICAgYnJhd246IHRydWUsXG4gICAgICAgICAgY2hhcm06IHRydWUsXG4gICAgICAgICAgaW50ZWxsaWdlbmNlOiB0cnVlLFxuICAgICAgICAgIHJlZmxleGVzOiB0cnVlLFxuICAgICAgICAgIHRlY2g6IHRydWUsXG4gICAgICAgICAgbHVjazogdHJ1ZSxcbiAgICAgICAgICBjYW1wYWlnbklkOiB0cnVlLFxuICAgICAgICAgIHNraWxsczogeyBzZWxlY3Q6IHsgbmFtZTogdHJ1ZSwgbGV2ZWw6IHRydWUgfSB9LFxuICAgICAgICAgIGN5YmVybmV0aWNzOiB7IHNlbGVjdDogeyBjeWJlcm5ldGljSWQ6IHRydWUgfSB9LFxuICAgICAgICAgIHdlYXBvbnM6IHsgc2VsZWN0OiB7IHdlYXBvbklkOiB0cnVlIH0gfSxcbiAgICAgICAgICBpdGVtczogeyBzZWxlY3Q6IHsgaXRlbUlkOiB0cnVlIH0gfSxcbiAgICAgICAgICB2ZWhpY2xlczogeyBzZWxlY3Q6IHsgdmVoaWNsZUlkOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcm93cy5tYXAoKHJvdykgPT4gKHtcbiAgICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgICAgbmFtZTogcm93Lm5hbWUsXG4gICAgICAgIGlzUHVibGljOiByb3cuaXNQdWJsaWMsXG4gICAgICAgIHNwZWVkOiByb3cuc3BlZWQsXG4gICAgICAgIGhpdFBvaW50czogcm93LmhpdFBvaW50cyxcbiAgICAgICAgY2FtcGFpZ25JZDogcm93LmNhbXBhaWduSWQsXG4gICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgYnJhd246IHJvdy5icmF3bixcbiAgICAgICAgICBjaGFybTogcm93LmNoYXJtLFxuICAgICAgICAgIGludGVsbGlnZW5jZTogcm93LmludGVsbGlnZW5jZSxcbiAgICAgICAgICByZWZsZXhlczogcm93LnJlZmxleGVzLFxuICAgICAgICAgIHRlY2g6IHJvdy50ZWNoLFxuICAgICAgICAgIGx1Y2s6IHJvdy5sdWNrLFxuICAgICAgICB9LFxuICAgICAgICBza2lsbHM6IHJvdy5za2lsbHMsXG4gICAgICAgIGN5YmVybmV0aWNJZHM6IHJvdy5jeWJlcm5ldGljcy5tYXAoKGMpID0+IGMuY3liZXJuZXRpY0lkKSxcbiAgICAgICAgd2VhcG9uSWRzOiByb3cud2VhcG9ucy5tYXAoKHcpID0+IHcud2VhcG9uSWQpLFxuICAgICAgICBpdGVtSWRzOiByb3cuaXRlbXMubWFwKChpKSA9PiBpLml0ZW1JZCksXG4gICAgICAgIHZlaGljbGVJZHM6IHJvdy52ZWhpY2xlcy5tYXAoKHYpID0+IHYudmVoaWNsZUlkKSxcbiAgICAgIH0pKTtcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RDaGFyYWN0ZXJzRm9yVXNlcih1c2VySWQ6IHN0cmluZykge1xuICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHByaXNtYS5jaGFyYWN0ZXIuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IGlzUHVibGljOiB0cnVlIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGNhbXBhaWduOiB7XG4gICAgICAgICAgICAgICAgbWVtYmVyc2hpcHM6IHtcbiAgICAgICAgICAgICAgICAgIHNvbWU6IHsgdXNlcklkIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBpc1B1YmxpYzogdHJ1ZSxcbiAgICAgICAgICBzcGVlZDogdHJ1ZSxcbiAgICAgICAgICBoaXRQb2ludHM6IHRydWUsXG4gICAgICAgICAgYnJhd246IHRydWUsXG4gICAgICAgICAgY2hhcm06IHRydWUsXG4gICAgICAgICAgaW50ZWxsaWdlbmNlOiB0cnVlLFxuICAgICAgICAgIHJlZmxleGVzOiB0cnVlLFxuICAgICAgICAgIHRlY2g6IHRydWUsXG4gICAgICAgICAgbHVjazogdHJ1ZSxcbiAgICAgICAgICBjYW1wYWlnbklkOiB0cnVlLFxuICAgICAgICAgIHNraWxsczogeyBzZWxlY3Q6IHsgbmFtZTogdHJ1ZSwgbGV2ZWw6IHRydWUgfSB9LFxuICAgICAgICAgIGN5YmVybmV0aWNzOiB7IHNlbGVjdDogeyBjeWJlcm5ldGljSWQ6IHRydWUgfSB9LFxuICAgICAgICAgIHdlYXBvbnM6IHsgc2VsZWN0OiB7IHdlYXBvbklkOiB0cnVlIH0gfSxcbiAgICAgICAgICBpdGVtczogeyBzZWxlY3Q6IHsgaXRlbUlkOiB0cnVlIH0gfSxcbiAgICAgICAgICB2ZWhpY2xlczogeyBzZWxlY3Q6IHsgdmVoaWNsZUlkOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcm93cy5tYXAoKHJvdykgPT4gKHtcbiAgICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgICAgbmFtZTogcm93Lm5hbWUsXG4gICAgICAgIGlzUHVibGljOiByb3cuaXNQdWJsaWMsXG4gICAgICAgIHNwZWVkOiByb3cuc3BlZWQsXG4gICAgICAgIGhpdFBvaW50czogcm93LmhpdFBvaW50cyxcbiAgICAgICAgY2FtcGFpZ25JZDogcm93LmNhbXBhaWduSWQsXG4gICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgYnJhd246IHJvdy5icmF3bixcbiAgICAgICAgICBjaGFybTogcm93LmNoYXJtLFxuICAgICAgICAgIGludGVsbGlnZW5jZTogcm93LmludGVsbGlnZW5jZSxcbiAgICAgICAgICByZWZsZXhlczogcm93LnJlZmxleGVzLFxuICAgICAgICAgIHRlY2g6IHJvdy50ZWNoLFxuICAgICAgICAgIGx1Y2s6IHJvdy5sdWNrLFxuICAgICAgICB9LFxuICAgICAgICBza2lsbHM6IHJvdy5za2lsbHMsXG4gICAgICAgIGN5YmVybmV0aWNJZHM6IHJvdy5jeWJlcm5ldGljcy5tYXAoKGMpID0+IGMuY3liZXJuZXRpY0lkKSxcbiAgICAgICAgd2VhcG9uSWRzOiByb3cud2VhcG9ucy5tYXAoKHcpID0+IHcud2VhcG9uSWQpLFxuICAgICAgICBpdGVtSWRzOiByb3cuaXRlbXMubWFwKChpKSA9PiBpLml0ZW1JZCksXG4gICAgICAgIHZlaGljbGVJZHM6IHJvdy52ZWhpY2xlcy5tYXAoKHYpID0+IHYudmVoaWNsZUlkKSxcbiAgICAgIH0pKTtcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RDeWJlcm5ldGljcygpIHtcbiAgICAgIHJldHVybiBwcmlzbWEuY3liZXJuZXRpYy5maW5kTWFueSh7XG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgc2hvcnREZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgICBsb25nRGVzY3JpcHRpb246IHRydWUsXG4gICAgICAgICAgcHJpY2U6IHRydWUsXG4gICAgICAgICAgYmF0dGVyeUxpZmU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RXZWFwb25zKCkge1xuICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHByaXNtYS53ZWFwb24uZmluZE1hbnkoe1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIHByaWNlOiB0cnVlLFxuICAgICAgICAgIHdlaWdodDogdHJ1ZSxcbiAgICAgICAgICBtYXhSYW5nZTogdHJ1ZSxcbiAgICAgICAgICBtYXhBbW1vQ291bnQ6IHRydWUsXG4gICAgICAgICAgdHlwZTogdHJ1ZSxcbiAgICAgICAgICBjb25kaXRpb246IHRydWUsXG4gICAgICAgICAgc2hvcnREZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgICBsb25nRGVzY3JpcHRpb246IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByb3dzLm1hcCgocm93KSA9PiAoe1xuICAgICAgICAuLi5yb3csXG4gICAgICAgIHR5cGU6IHJvdy50eXBlLFxuICAgICAgfSkpO1xuICAgIH0sXG4gICAgYXN5bmMgbGlzdEl0ZW1zKCkge1xuICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHByaXNtYS5pdGVtLmZpbmRNYW55KHtcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBwcmljZTogdHJ1ZSxcbiAgICAgICAgICB3ZWlnaHQ6IHRydWUsXG4gICAgICAgICAgdHlwZTogdHJ1ZSxcbiAgICAgICAgICBzaG9ydERlc2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgIGxvbmdEZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJvd3MubWFwKChyb3cpID0+ICh7XG4gICAgICAgIC4uLnJvdyxcbiAgICAgICAgdHlwZTogcm93LnR5cGUsXG4gICAgICB9KSk7XG4gICAgfSxcbiAgICBhc3luYyBsaXN0VmVoaWNsZXMoKSB7XG4gICAgICByZXR1cm4gcHJpc21hLnZlaGljbGUuZmluZE1hbnkoe1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIHByaWNlOiB0cnVlLFxuICAgICAgICAgIHNob3J0RGVzY3JpcHRpb246IHRydWUsXG4gICAgICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgIHNwZWVkOiB0cnVlLFxuICAgICAgICAgIGFybW9yOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGFzeW5jIGFkZFVzZXJUb0NhbXBhaWduKGlucHV0OiB7IHVzZXJJZDogc3RyaW5nOyBjYW1wYWlnbklkOiBzdHJpbmc7IHJvbGU/OiAnQVVUTycgfCAnT1dORVInIHwgJ01FTUJFUicgfSkge1xuICAgICAgYXdhaXQgcHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcbiAgICAgICAgY29uc3Qgb3duZXJDb3VudCA9IGF3YWl0IHR4LmNhbXBhaWduTWVtYmVyc2hpcC5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHsgY2FtcGFpZ25JZDogaW5wdXQuY2FtcGFpZ25JZCwgcm9sZTogJ09XTkVSJyB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBkZXNpcmVkUm9sZSA9XG4gICAgICAgICAgaW5wdXQucm9sZSA9PT0gJ09XTkVSJyB8fCBpbnB1dC5yb2xlID09PSAnTUVNQkVSJ1xuICAgICAgICAgICAgPyBpbnB1dC5yb2xlXG4gICAgICAgICAgICA6IG93bmVyQ291bnQgPiAwXG4gICAgICAgICAgICAgID8gJ01FTUJFUidcbiAgICAgICAgICAgICAgOiAnT1dORVInO1xuXG4gICAgICAgIGF3YWl0IHR4LmNhbXBhaWduTWVtYmVyc2hpcC51cHNlcnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHVzZXJJZF9jYW1wYWlnbklkOiB7IHVzZXJJZDogaW5wdXQudXNlcklkLCBjYW1wYWlnbklkOiBpbnB1dC5jYW1wYWlnbklkIH0gfSxcbiAgICAgICAgICB1cGRhdGU6IGRlc2lyZWRSb2xlID09PSAnT1dORVInID8geyByb2xlOiAnT1dORVInIH0gOiB7fSxcbiAgICAgICAgICBjcmVhdGU6IHsgdXNlcklkOiBpbnB1dC51c2VySWQsIGNhbXBhaWduSWQ6IGlucHV0LmNhbXBhaWduSWQsIHJvbGU6IGRlc2lyZWRSb2xlIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGFzeW5jIGdldENhbXBhaWduTWVtYmVyc2hpcFJvbGUoaW5wdXQ6IHsgdXNlcklkOiBzdHJpbmc7IGNhbXBhaWduSWQ6IHN0cmluZyB9KSB7XG4gICAgICBjb25zdCByb3cgPSBhd2FpdCBwcmlzbWEuY2FtcGFpZ25NZW1iZXJzaGlwLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWRfY2FtcGFpZ25JZDogeyB1c2VySWQ6IGlucHV0LnVzZXJJZCwgY2FtcGFpZ25JZDogaW5wdXQuY2FtcGFpZ25JZCB9IH0sXG4gICAgICAgIHNlbGVjdDogeyByb2xlOiB0cnVlIH0sXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByb3c/LnJvbGUgPz8gbnVsbDtcbiAgICB9LFxuXG4gICAgYXN5bmMgY3JlYXRlQ2FtcGFpZ25JbnZpdGUoaW5wdXQ6IHsgY2FtcGFpZ25JZDogc3RyaW5nOyBlbWFpbDogc3RyaW5nOyB0dGxNczogbnVtYmVyIH0pIHtcbiAgICAgIGNvbnN0IGNhbXBhaWduID0gYXdhaXQgcHJpc21hLmNhbXBhaWduLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogaW5wdXQuY2FtcGFpZ25JZCB9LCBzZWxlY3Q6IHsgaWQ6IHRydWUgfSB9KTtcbiAgICAgIGlmICghY2FtcGFpZ24pIHRocm93IG5ldyBFcnJvcignQ0FNUEFJR05fTk9UX0ZPVU5EJyk7XG5cbiAgICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVJbnZpdGVUb2tlbigpO1xuICAgICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIGlucHV0LnR0bE1zKTtcblxuICAgICAgYXdhaXQgcHJpc21hLmNhbXBhaWduSW52aXRlLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0b2tlbixcbiAgICAgICAgICBlbWFpbDogbm9ybWFsaXplRW1haWwoaW5wdXQuZW1haWwpLFxuICAgICAgICAgIGNhbXBhaWduSWQ6IGlucHV0LmNhbXBhaWduSWQsXG4gICAgICAgICAgZXhwaXJlc0F0LFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4geyB0b2tlbiwgZXhwaXJlc0F0OiBleHBpcmVzQXQudG9JU09TdHJpbmcoKSB9O1xuICAgIH0sXG5cbiAgICBhc3luYyBhY2NlcHRDYW1wYWlnbkludml0ZShpbnB1dDogeyB0b2tlbjogc3RyaW5nOyB1c2VySWQ6IHN0cmluZzsgdXNlckVtYWlsOiBzdHJpbmc7IG5vd01zPzogbnVtYmVyIH0pIHtcbiAgICAgIGNvbnN0IGludml0ZSA9IGF3YWl0IHByaXNtYS5jYW1wYWlnbkludml0ZS5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgdG9rZW46IGlucHV0LnRva2VuIH0sXG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIHRva2VuOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIGNhbXBhaWduSWQ6IHRydWUsXG4gICAgICAgICAgZXhwaXJlc0F0OiB0cnVlLFxuICAgICAgICAgIGFjY2VwdGVkQXQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFpbnZpdGUpIHRocm93IG5ldyBFcnJvcignSU5WSVRFX05PVF9GT1VORCcpO1xuICAgICAgaWYgKGludml0ZS5hY2NlcHRlZEF0KSB0aHJvdyBuZXcgRXJyb3IoJ0lOVklURV9BTFJFQURZX1VTRUQnKTtcblxuICAgICAgY29uc3Qgbm93TXMgPSBpbnB1dC5ub3dNcyA/PyBEYXRlLm5vdygpO1xuICAgICAgaWYgKG5vd01zID4gaW52aXRlLmV4cGlyZXNBdC5nZXRUaW1lKCkpIHRocm93IG5ldyBFcnJvcignSU5WSVRFX0VYUElSRUQnKTtcblxuICAgICAgaWYgKG5vcm1hbGl6ZUVtYWlsKGlucHV0LnVzZXJFbWFpbCkgIT09IG5vcm1hbGl6ZUVtYWlsKGludml0ZS5lbWFpbCkpIHRocm93IG5ldyBFcnJvcignSU5WSVRFX0VNQUlMX01JU01BVENIJyk7XG5cbiAgICAgIGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgIGF3YWl0IHR4LmNhbXBhaWduTWVtYmVyc2hpcC51cHNlcnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHVzZXJJZF9jYW1wYWlnbklkOiB7IHVzZXJJZDogaW5wdXQudXNlcklkLCBjYW1wYWlnbklkOiBpbnZpdGUuY2FtcGFpZ25JZCB9IH0sXG4gICAgICAgICAgdXBkYXRlOiB7fSxcbiAgICAgICAgICBjcmVhdGU6IHsgdXNlcklkOiBpbnB1dC51c2VySWQsIGNhbXBhaWduSWQ6IGludml0ZS5jYW1wYWlnbklkLCByb2xlOiAnTUVNQkVSJyB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCB0eC5jYW1wYWlnbkludml0ZS51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IHRva2VuOiBpbnB1dC50b2tlbiB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGFjY2VwdGVkQXQ6IG5ldyBEYXRlKG5vd01zKSxcbiAgICAgICAgICAgIGFjY2VwdGVkQnlVc2VySWQ6IGlucHV0LnVzZXJJZCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjYW1wYWlnbiA9IGF3YWl0IHByaXNtYS5jYW1wYWlnbi5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IGludml0ZS5jYW1wYWlnbklkIH0sIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0pO1xuICAgICAgaWYgKCFjYW1wYWlnbikgdGhyb3cgbmV3IEVycm9yKCdDQU1QQUlHTl9OT1RfRk9VTkQnKTtcbiAgICAgIHJldHVybiBjYW1wYWlnbjtcbiAgICB9LFxuXG4gICAgYXN5bmMgZ2V0VXNlckJ5SWQoaWQ6IHN0cmluZykge1xuICAgICAgY29uc3Qgcm93ID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkIH0sXG4gICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgZW1haWw6IHRydWUgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJvdyA/PyBudWxsO1xuICAgIH0sXG4gICAgYXN5bmMgZmluZFVzZXJCeUVtYWlsKGVtYWlsOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IHJvdyA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBlbWFpbCB9LFxuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIGVtYWlsOiB0cnVlLCBwYXNzd29yZEhhc2g6IHRydWUgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJvdyA/PyBudWxsO1xuICAgIH0sXG4gICAgYXN5bmMgY3JlYXRlVXNlcihpbnB1dDogeyBlbWFpbDogc3RyaW5nOyBwYXNzd29yZEhhc2g6IHN0cmluZyB9KSB7XG4gICAgICBjb25zdCByb3cgPSBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7IGVtYWlsOiBpbnB1dC5lbWFpbCwgcGFzc3dvcmRIYXNoOiBpbnB1dC5wYXNzd29yZEhhc2ggfSxcbiAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBlbWFpbDogdHJ1ZSB9LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcm93O1xuICAgIH0sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEYXRhU291cmNlKCk6IERhdGFTb3VyY2Uge1xuICBjb25zdCBvdmVycmlkZSA9IHByb2Nlc3MuZW52LkNZQkVSREFMTEFTX0RBVEFfU09VUkNFO1xuICBpZiAob3ZlcnJpZGUgPT09ICdpbk1lbW9yeScpIHtcbiAgICByZXR1cm4gY3JlYXRlSW5NZW1vcnlEYXRhU291cmNlKCk7XG4gIH1cbiAgaWYgKG92ZXJyaWRlID09PSAncHJpc21hJykge1xuICAgIHJldHVybiBjcmVhdGVQcmlzbWFEYXRhU291cmNlKCk7XG4gIH1cblxuICBjb25zdCBkYXRhYmFzZVVybCA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcbiAgaWYgKCFkYXRhYmFzZVVybCkge1xuICAgIHJldHVybiBjcmVhdGVJbk1lbW9yeURhdGFTb3VyY2UoKTtcbiAgfVxuICByZXR1cm4gY3JlYXRlUHJpc21hRGF0YVNvdXJjZSgpO1xufVxuIl0sIm5hbWVzIjpbImdldFByaXNtYUNsaWVudCIsImNhbXBhaWducyIsImNoYXJhY3RlcnMiLCJjeWJlcm5ldGljcyIsIml0ZW1zIiwidmVoaWNsZXMiLCJ3ZWFwb25zIiwiY3J5cHRvIiwiZ2VuZXJhdGVJbnZpdGVUb2tlbiIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJub3JtYWxpemVFbWFpbCIsImVtYWlsIiwidHJpbSIsInRvTG93ZXJDYXNlIiwiY3JlYXRlSW5NZW1vcnlEYXRhU291cmNlIiwidXNlcnMiLCJjYW1wYWlnbk1lbWJlcnMiLCJNYXAiLCJpbnZpdGVzIiwiZ2V0TWVtYmVyc2hpcHNCeVVzZXIiLCJ1c2VySWQiLCJleGlzdGluZyIsImdldCIsImNyZWF0ZWQiLCJzZXQiLCJhbnlPd25lckV4aXN0cyIsImNhbXBhaWduSWQiLCJtZW1iZXJzaGlwcyIsInZhbHVlcyIsImlzUHVibGljQ2hhcmFjdGVyIiwiY2hhcmFjdGVyIiwiaXNQdWJsaWMiLCJpc0NoYXJhY3RlckluTWVtYmVyQ2FtcGFpZ24iLCJoYXMiLCJraW5kIiwiZ2V0Q2FtcGFpZ25CeUlkIiwiaWQiLCJmaW5kIiwiYyIsImxpc3RDYW1wYWlnbnMiLCJsaXN0Q2FtcGFpZ25zRm9yVXNlciIsImZpbHRlciIsImxpc3RDaGFyYWN0ZXJzIiwibGlzdENoYXJhY3RlcnNGb3JVc2VyIiwibGlzdEN5YmVybmV0aWNzIiwibGlzdFdlYXBvbnMiLCJsaXN0SXRlbXMiLCJsaXN0VmVoaWNsZXMiLCJhZGRVc2VyVG9DYW1wYWlnbiIsImlucHV0IiwiY2FtcGFpZ24iLCJFcnJvciIsImRlc2lyZWRSb2xlIiwicm9sZSIsImdldENhbXBhaWduTWVtYmVyc2hpcFJvbGUiLCJjcmVhdGVDYW1wYWlnbkludml0ZSIsIm5vd01zIiwiRGF0ZSIsIm5vdyIsImludml0ZSIsInJhbmRvbVVVSUQiLCJ0b2tlbiIsImV4cGlyZXNBdE1zIiwidHRsTXMiLCJhY2NlcHRlZEF0TXMiLCJhY2NlcHRlZEJ5VXNlcklkIiwiY3JlYXRlZEF0TXMiLCJwdXNoIiwiZXhwaXJlc0F0IiwidG9JU09TdHJpbmciLCJhY2NlcHRDYW1wYWlnbkludml0ZSIsImkiLCJ1c2VyRW1haWwiLCJnZXRVc2VyQnlJZCIsInVzZXIiLCJ1IiwiZmluZFVzZXJCeUVtYWlsIiwiY3JlYXRlVXNlciIsImxlbmd0aCIsInBhc3N3b3JkSGFzaCIsImNyZWF0ZVByaXNtYURhdGFTb3VyY2UiLCJwcmlzbWEiLCJyb3ciLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJzZWxlY3QiLCJuYW1lIiwicm93cyIsImZpbmRNYW55Iiwic29tZSIsInNwZWVkIiwiaGl0UG9pbnRzIiwiYnJhd24iLCJjaGFybSIsImludGVsbGlnZW5jZSIsInJlZmxleGVzIiwidGVjaCIsImx1Y2siLCJza2lsbHMiLCJsZXZlbCIsImN5YmVybmV0aWNJZCIsIndlYXBvbklkIiwiaXRlbUlkIiwidmVoaWNsZUlkIiwibWFwIiwic3RhdHMiLCJjeWJlcm5ldGljSWRzIiwid2VhcG9uSWRzIiwidyIsIml0ZW1JZHMiLCJ2ZWhpY2xlSWRzIiwidiIsIk9SIiwiY3liZXJuZXRpYyIsInNob3J0RGVzY3JpcHRpb24iLCJsb25nRGVzY3JpcHRpb24iLCJwcmljZSIsImJhdHRlcnlMaWZlIiwid2VhcG9uIiwid2VpZ2h0IiwibWF4UmFuZ2UiLCJtYXhBbW1vQ291bnQiLCJ0eXBlIiwiY29uZGl0aW9uIiwiaXRlbSIsInZlaGljbGUiLCJhcm1vciIsIiR0cmFuc2FjdGlvbiIsInR4Iiwib3duZXJDb3VudCIsImNhbXBhaWduTWVtYmVyc2hpcCIsImNvdW50IiwidXBzZXJ0IiwidXNlcklkX2NhbXBhaWduSWQiLCJ1cGRhdGUiLCJjcmVhdGUiLCJjYW1wYWlnbkludml0ZSIsImRhdGEiLCJhY2NlcHRlZEF0IiwiZ2V0VGltZSIsImNyZWF0ZURhdGFTb3VyY2UiLCJvdmVycmlkZSIsInByb2Nlc3MiLCJlbnYiLCJDWUJFUkRBTExBU19EQVRBX1NPVVJDRSIsImRhdGFiYXNlVXJsIiwiREFUQUJBU0VfVVJMIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/graphql/dataSource.ts\n");

/***/ }),

/***/ "(rsc)/./src/graphql/seed.ts":
/*!*****************************!*\
  !*** ./src/graphql/seed.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   campaigns: () => (/* binding */ campaigns),\n/* harmony export */   characters: () => (/* binding */ characters),\n/* harmony export */   cybernetics: () => (/* binding */ cybernetics),\n/* harmony export */   items: () => (/* binding */ items),\n/* harmony export */   vehicles: () => (/* binding */ vehicles),\n/* harmony export */   weapons: () => (/* binding */ weapons)\n/* harmony export */ });\n// Minimal in-memory seed data for tests/dev.\nconst campaigns = [\n    {\n        id: 'camp_1',\n        name: 'Neon Rain'\n    },\n    {\n        id: 'camp_2',\n        name: 'Chrome Syndicate'\n    },\n    {\n        id: 'camp_3',\n        name: 'Synthetic Dawn'\n    }\n];\nconst cybernetics = [\n    {\n        id: 'cy_1',\n        name: 'Reflex Booster',\n        shortDescription: 'Boostes reflex response time.',\n        longDescription: 'A spinal tap that accelerates motor response under stress.',\n        price: 1200,\n        batteryLife: 3,\n        statBonuses: [\n            {\n                stat: 'REFLEXES',\n                amount: 1\n            }\n        ],\n        skillBonuses: []\n    }\n];\nconst weapons = [\n    {\n        id: 'w_1',\n        name: 'Mono-Katana',\n        price: 900,\n        weight: 3,\n        maxRange: 1,\n        maxAmmoCount: 0,\n        type: 'MELEE',\n        condition: 100,\n        shortDescription: 'A molecular-edged blade.',\n        longDescription: 'A mono-molecular katana with a near-frictionless edge.'\n    },\n    {\n        id: 'w_2',\n        name: 'Smartpistol',\n        price: 650,\n        weight: 2,\n        maxRange: 40,\n        maxAmmoCount: 12,\n        type: 'RANGED',\n        condition: 100,\n        shortDescription: 'A pistol with smart-link.',\n        longDescription: 'A compact sidearm compatible with smart targeting links.'\n    }\n];\nconst vehicles = [\n    {\n        id: 'v_1',\n        name: 'Street Bike',\n        price: 2200,\n        shortDescription: 'A loud, fast street bike.',\n        longDescription: 'A stripped-down bike built for speed in tight alleys.',\n        speed: 80,\n        armor: 1\n    }\n];\nconst items = [\n    {\n        id: 'i_1',\n        name: 'Cyberdeck (Starter)',\n        price: 1500,\n        weight: 2,\n        shortDescription: 'A starter-grade cyberdeck.',\n        longDescription: 'A basic cyberdeck with limited RAM and disk space.',\n        type: 'CYBERDECK'\n    }\n];\nconst characters = [\n    {\n        id: 'c_1',\n        name: 'Nova',\n        isPublic: false,\n        speed: 30,\n        hitPoints: 5,\n        campaignId: 'camp_1',\n        stats: {\n            brawn: 2,\n            charm: 4,\n            intelligence: 6,\n            reflexes: 7,\n            tech: 5,\n            luck: 1\n        },\n        skills: [\n            {\n                name: 'Hacking',\n                level: 6\n            },\n            {\n                name: 'Awareness',\n                level: 4\n            }\n        ],\n        cyberneticIds: [\n            'cy_1'\n        ],\n        weaponIds: [\n            'w_1',\n            'w_2'\n        ],\n        vehicleIds: [\n            'v_1'\n        ],\n        itemIds: [\n            'i_1'\n        ]\n    },\n    {\n        id: 'c_2',\n        name: 'Street Thug',\n        isPublic: true,\n        speed: 30,\n        hitPoints: 3,\n        stats: {\n            brawn: 3,\n            charm: 1,\n            intelligence: 1,\n            reflexes: 3,\n            tech: 0,\n            luck: 0\n        },\n        skills: [\n            {\n                name: 'Intimidation',\n                level: 2\n            }\n        ]\n    },\n    {\n        id: 'c_3',\n        name: 'Ghost',\n        isPublic: false,\n        speed: 30,\n        hitPoints: 5,\n        campaignId: 'camp_2',\n        stats: {\n            brawn: 1,\n            charm: 2,\n            intelligence: 7,\n            reflexes: 6,\n            tech: 8,\n            luck: 1\n        },\n        skills: [\n            {\n                name: 'Hacking',\n                level: 8\n            }\n        ]\n    }\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZ3JhcGhxbC9zZWVkLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQThGQSw2Q0FBNkM7QUFFdEMsTUFBTUEsWUFBOEI7SUFDekM7UUFDRUMsSUFBSTtRQUNKQyxNQUFNO0lBQ1I7SUFDQTtRQUNFRCxJQUFJO1FBQ0pDLE1BQU07SUFDUjtJQUNBO1FBQ0VELElBQUk7UUFDSkMsTUFBTTtJQUNSO0NBQ0QsQ0FBQztBQUVLLE1BQU1DLGNBQWtDO0lBQzdDO1FBQ0VGLElBQUk7UUFDSkMsTUFBTTtRQUNORSxrQkFBa0I7UUFDbEJDLGlCQUFpQjtRQUNqQkMsT0FBTztRQUNQQyxhQUFhO1FBQ2JDLGFBQWE7WUFBQztnQkFBRUMsTUFBTTtnQkFBWUMsUUFBUTtZQUFFO1NBQUU7UUFDOUNDLGNBQWMsRUFBRTtJQUNsQjtDQUNELENBQUM7QUFFSyxNQUFNQyxVQUEwQjtJQUNyQztRQUNFWCxJQUFJO1FBQ0pDLE1BQU07UUFDTkksT0FBTztRQUNQTyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsY0FBYztRQUNkQyxNQUFNO1FBQ05DLFdBQVc7UUFDWGIsa0JBQWtCO1FBQ2xCQyxpQkFBaUI7SUFDbkI7SUFDQTtRQUNFSixJQUFJO1FBQ0pDLE1BQU07UUFDTkksT0FBTztRQUNQTyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsY0FBYztRQUNkQyxNQUFNO1FBQ05DLFdBQVc7UUFDWGIsa0JBQWtCO1FBQ2xCQyxpQkFBaUI7SUFDbkI7Q0FDRCxDQUFDO0FBRUssTUFBTWEsV0FBNEI7SUFDdkM7UUFDRWpCLElBQUk7UUFDSkMsTUFBTTtRQUNOSSxPQUFPO1FBQ1BGLGtCQUFrQjtRQUNsQkMsaUJBQWlCO1FBQ2pCYyxPQUFPO1FBQ1BDLE9BQU87SUFDVDtDQUNELENBQUM7QUFFSyxNQUFNQyxRQUFzQjtJQUNqQztRQUNFcEIsSUFBSTtRQUNKQyxNQUFNO1FBQ05JLE9BQU87UUFDUE8sUUFBUTtRQUNSVCxrQkFBa0I7UUFDbEJDLGlCQUFpQjtRQUNqQlcsTUFBTTtJQUNSO0NBQ0QsQ0FBQztBQUVLLE1BQU1NLGFBQWdDO0lBQzNDO1FBQ0VyQixJQUFJO1FBQ0pDLE1BQU07UUFDTnFCLFVBQVU7UUFDVkosT0FBTztRQUNQSyxXQUFXO1FBQ1hDLFlBQVk7UUFDWkMsT0FBTztZQUNMQyxPQUFPO1lBQ1BDLE9BQU87WUFDUEMsY0FBYztZQUNkQyxVQUFVO1lBQ1ZDLE1BQU07WUFDTkMsTUFBTTtRQUNSO1FBQ0FDLFFBQVE7WUFDTjtnQkFBRS9CLE1BQU07Z0JBQVdnQyxPQUFPO1lBQUU7WUFDNUI7Z0JBQUVoQyxNQUFNO2dCQUFhZ0MsT0FBTztZQUFFO1NBQy9CO1FBQ0RDLGVBQWU7WUFBQztTQUFPO1FBQ3ZCQyxXQUFXO1lBQUM7WUFBTztTQUFNO1FBQ3pCQyxZQUFZO1lBQUM7U0FBTTtRQUNuQkMsU0FBUztZQUFDO1NBQU07SUFDbEI7SUFDQTtRQUNFckMsSUFBSTtRQUNKQyxNQUFNO1FBQ05xQixVQUFVO1FBQ1ZKLE9BQU87UUFDUEssV0FBVztRQUNYRSxPQUFPO1lBQ0xDLE9BQU87WUFDUEMsT0FBTztZQUNQQyxjQUFjO1lBQ2RDLFVBQVU7WUFDVkMsTUFBTTtZQUNOQyxNQUFNO1FBQ1I7UUFDQUMsUUFBUTtZQUFDO2dCQUFFL0IsTUFBTTtnQkFBZ0JnQyxPQUFPO1lBQUU7U0FBRTtJQUM5QztJQUNBO1FBQ0VqQyxJQUFJO1FBQ0pDLE1BQU07UUFDTnFCLFVBQVU7UUFDVkosT0FBTztRQUNQSyxXQUFXO1FBQ1hDLFlBQVk7UUFDWkMsT0FBTztZQUNMQyxPQUFPO1lBQ1BDLE9BQU87WUFDUEMsY0FBYztZQUNkQyxVQUFVO1lBQ1ZDLE1BQU07WUFDTkMsTUFBTTtRQUNSO1FBQ0FDLFFBQVE7WUFBQztnQkFBRS9CLE1BQU07Z0JBQVdnQyxPQUFPO1lBQUU7U0FBRTtJQUN6QztDQUNELENBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9zcmMvZ3JhcGhxbC9zZWVkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIFN0YXROYW1lID0gJ0JSQVdOJyB8ICdDSEFSTScgfCAnSU5URUxMSUdFTkNFJyB8ICdSRUZMRVhFUycgfCAnVEVDSCcgfCAnTFVDSyc7XG5cbmV4cG9ydCB0eXBlIFN0YXRzUmVjb3JkID0ge1xuICBicmF3bjogbnVtYmVyO1xuICBjaGFybTogbnVtYmVyO1xuICBpbnRlbGxpZ2VuY2U6IG51bWJlcjtcbiAgcmVmbGV4ZXM6IG51bWJlcjtcbiAgdGVjaDogbnVtYmVyO1xuICBsdWNrOiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBTa2lsbFJlY29yZCA9IHtcbiAgbmFtZTogc3RyaW5nO1xuICBsZXZlbDogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgU3RhdEJvbnVzUmVjb3JkID0ge1xuICBzdGF0OiBTdGF0TmFtZTtcbiAgYW1vdW50OiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBTa2lsbEJvbnVzUmVjb3JkID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIGFtb3VudDogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgQ3liZXJuZXRpY1JlY29yZCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzaG9ydERlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGxvbmdEZXNjcmlwdGlvbjogc3RyaW5nO1xuICBwcmljZTogbnVtYmVyO1xuICBiYXR0ZXJ5TGlmZTogbnVtYmVyO1xuICBzdGF0Qm9udXNlcz86IFN0YXRCb251c1JlY29yZFtdO1xuICBza2lsbEJvbnVzZXM/OiBTa2lsbEJvbnVzUmVjb3JkW107XG59O1xuXG5leHBvcnQgdHlwZSBXZWFwb25UeXBlID0gJ01FTEVFJyB8ICdSQU5HRUQnO1xuXG5leHBvcnQgdHlwZSBXZWFwb25SZWNvcmQgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgcHJpY2U6IG51bWJlcjtcbiAgd2VpZ2h0OiBudW1iZXI7XG4gIG1heFJhbmdlOiBudW1iZXI7XG4gIG1heEFtbW9Db3VudDogbnVtYmVyO1xuICB0eXBlOiBXZWFwb25UeXBlO1xuICBjb25kaXRpb246IG51bWJlcjtcbiAgc2hvcnREZXNjcmlwdGlvbjogc3RyaW5nO1xuICBsb25nRGVzY3JpcHRpb246IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIFZlaGljbGVSZWNvcmQgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgcHJpY2U6IG51bWJlcjtcbiAgc2hvcnREZXNjcmlwdGlvbjogc3RyaW5nO1xuICBsb25nRGVzY3JpcHRpb246IHN0cmluZztcbiAgc3BlZWQ6IG51bWJlcjtcbiAgYXJtb3I6IG51bWJlcjtcbn07XG5cbmV4cG9ydCB0eXBlIEl0ZW1UeXBlID0gJ0dFTkVSQUwnIHwgJ0NZQkVSREVDSycgfCAnQ09OU1VNQUJMRScgfCAnQU1NTycgfCAnT1RIRVInO1xuXG5leHBvcnQgdHlwZSBJdGVtUmVjb3JkID0ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHByaWNlOiBudW1iZXI7XG4gIHdlaWdodDogbnVtYmVyO1xuICBzaG9ydERlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGxvbmdEZXNjcmlwdGlvbjogc3RyaW5nO1xuICB0eXBlOiBJdGVtVHlwZTtcbn07XG5cbmV4cG9ydCB0eXBlIENhbXBhaWduUmVjb3JkID0ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBDaGFyYWN0ZXJSZWNvcmQgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgaXNQdWJsaWM/OiBib29sZWFuO1xuICBzcGVlZD86IG51bWJlcjtcbiAgaGl0UG9pbnRzPzogbnVtYmVyO1xuICBzdGF0cz86IFBhcnRpYWw8U3RhdHNSZWNvcmQ+O1xuICBza2lsbHM/OiBTa2lsbFJlY29yZFtdO1xuICBjYW1wYWlnbklkPzogc3RyaW5nO1xuICBjeWJlcm5ldGljSWRzPzogc3RyaW5nW107XG4gIHdlYXBvbklkcz86IHN0cmluZ1tdO1xuICB2ZWhpY2xlSWRzPzogc3RyaW5nW107XG4gIGl0ZW1JZHM/OiBzdHJpbmdbXTtcbn07XG5cbi8vIE1pbmltYWwgaW4tbWVtb3J5IHNlZWQgZGF0YSBmb3IgdGVzdHMvZGV2LlxuXG5leHBvcnQgY29uc3QgY2FtcGFpZ25zOiBDYW1wYWlnblJlY29yZFtdID0gW1xuICB7XG4gICAgaWQ6ICdjYW1wXzEnLFxuICAgIG5hbWU6ICdOZW9uIFJhaW4nLFxuICB9LFxuICB7XG4gICAgaWQ6ICdjYW1wXzInLFxuICAgIG5hbWU6ICdDaHJvbWUgU3luZGljYXRlJyxcbiAgfSxcbiAge1xuICAgIGlkOiAnY2FtcF8zJyxcbiAgICBuYW1lOiAnU3ludGhldGljIERhd24nLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGN5YmVybmV0aWNzOiBDeWJlcm5ldGljUmVjb3JkW10gPSBbXG4gIHtcbiAgICBpZDogJ2N5XzEnLFxuICAgIG5hbWU6ICdSZWZsZXggQm9vc3RlcicsXG4gICAgc2hvcnREZXNjcmlwdGlvbjogJ0Jvb3N0ZXMgcmVmbGV4IHJlc3BvbnNlIHRpbWUuJyxcbiAgICBsb25nRGVzY3JpcHRpb246ICdBIHNwaW5hbCB0YXAgdGhhdCBhY2NlbGVyYXRlcyBtb3RvciByZXNwb25zZSB1bmRlciBzdHJlc3MuJyxcbiAgICBwcmljZTogMTIwMCxcbiAgICBiYXR0ZXJ5TGlmZTogMyxcbiAgICBzdGF0Qm9udXNlczogW3sgc3RhdDogJ1JFRkxFWEVTJywgYW1vdW50OiAxIH1dLFxuICAgIHNraWxsQm9udXNlczogW10sXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3Qgd2VhcG9uczogV2VhcG9uUmVjb3JkW10gPSBbXG4gIHtcbiAgICBpZDogJ3dfMScsXG4gICAgbmFtZTogJ01vbm8tS2F0YW5hJyxcbiAgICBwcmljZTogOTAwLFxuICAgIHdlaWdodDogMyxcbiAgICBtYXhSYW5nZTogMSxcbiAgICBtYXhBbW1vQ291bnQ6IDAsXG4gICAgdHlwZTogJ01FTEVFJyxcbiAgICBjb25kaXRpb246IDEwMCxcbiAgICBzaG9ydERlc2NyaXB0aW9uOiAnQSBtb2xlY3VsYXItZWRnZWQgYmxhZGUuJyxcbiAgICBsb25nRGVzY3JpcHRpb246ICdBIG1vbm8tbW9sZWN1bGFyIGthdGFuYSB3aXRoIGEgbmVhci1mcmljdGlvbmxlc3MgZWRnZS4nLFxuICB9LFxuICB7XG4gICAgaWQ6ICd3XzInLFxuICAgIG5hbWU6ICdTbWFydHBpc3RvbCcsXG4gICAgcHJpY2U6IDY1MCxcbiAgICB3ZWlnaHQ6IDIsXG4gICAgbWF4UmFuZ2U6IDQwLFxuICAgIG1heEFtbW9Db3VudDogMTIsXG4gICAgdHlwZTogJ1JBTkdFRCcsXG4gICAgY29uZGl0aW9uOiAxMDAsXG4gICAgc2hvcnREZXNjcmlwdGlvbjogJ0EgcGlzdG9sIHdpdGggc21hcnQtbGluay4nLFxuICAgIGxvbmdEZXNjcmlwdGlvbjogJ0EgY29tcGFjdCBzaWRlYXJtIGNvbXBhdGlibGUgd2l0aCBzbWFydCB0YXJnZXRpbmcgbGlua3MuJyxcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2ZWhpY2xlczogVmVoaWNsZVJlY29yZFtdID0gW1xuICB7XG4gICAgaWQ6ICd2XzEnLFxuICAgIG5hbWU6ICdTdHJlZXQgQmlrZScsXG4gICAgcHJpY2U6IDIyMDAsXG4gICAgc2hvcnREZXNjcmlwdGlvbjogJ0EgbG91ZCwgZmFzdCBzdHJlZXQgYmlrZS4nLFxuICAgIGxvbmdEZXNjcmlwdGlvbjogJ0Egc3RyaXBwZWQtZG93biBiaWtlIGJ1aWx0IGZvciBzcGVlZCBpbiB0aWdodCBhbGxleXMuJyxcbiAgICBzcGVlZDogODAsXG4gICAgYXJtb3I6IDEsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgaXRlbXM6IEl0ZW1SZWNvcmRbXSA9IFtcbiAge1xuICAgIGlkOiAnaV8xJyxcbiAgICBuYW1lOiAnQ3liZXJkZWNrIChTdGFydGVyKScsXG4gICAgcHJpY2U6IDE1MDAsXG4gICAgd2VpZ2h0OiAyLFxuICAgIHNob3J0RGVzY3JpcHRpb246ICdBIHN0YXJ0ZXItZ3JhZGUgY3liZXJkZWNrLicsXG4gICAgbG9uZ0Rlc2NyaXB0aW9uOiAnQSBiYXNpYyBjeWJlcmRlY2sgd2l0aCBsaW1pdGVkIFJBTSBhbmQgZGlzayBzcGFjZS4nLFxuICAgIHR5cGU6ICdDWUJFUkRFQ0snLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGNoYXJhY3RlcnM6IENoYXJhY3RlclJlY29yZFtdID0gW1xuICB7XG4gICAgaWQ6ICdjXzEnLFxuICAgIG5hbWU6ICdOb3ZhJyxcbiAgICBpc1B1YmxpYzogZmFsc2UsXG4gICAgc3BlZWQ6IDMwLFxuICAgIGhpdFBvaW50czogNSxcbiAgICBjYW1wYWlnbklkOiAnY2FtcF8xJyxcbiAgICBzdGF0czoge1xuICAgICAgYnJhd246IDIsXG4gICAgICBjaGFybTogNCxcbiAgICAgIGludGVsbGlnZW5jZTogNixcbiAgICAgIHJlZmxleGVzOiA3LFxuICAgICAgdGVjaDogNSxcbiAgICAgIGx1Y2s6IDEsXG4gICAgfSxcbiAgICBza2lsbHM6IFtcbiAgICAgIHsgbmFtZTogJ0hhY2tpbmcnLCBsZXZlbDogNiB9LFxuICAgICAgeyBuYW1lOiAnQXdhcmVuZXNzJywgbGV2ZWw6IDQgfSxcbiAgICBdLFxuICAgIGN5YmVybmV0aWNJZHM6IFsnY3lfMSddLFxuICAgIHdlYXBvbklkczogWyd3XzEnLCAnd18yJ10sXG4gICAgdmVoaWNsZUlkczogWyd2XzEnXSxcbiAgICBpdGVtSWRzOiBbJ2lfMSddLFxuICB9LFxuICB7XG4gICAgaWQ6ICdjXzInLFxuICAgIG5hbWU6ICdTdHJlZXQgVGh1ZycsXG4gICAgaXNQdWJsaWM6IHRydWUsXG4gICAgc3BlZWQ6IDMwLFxuICAgIGhpdFBvaW50czogMyxcbiAgICBzdGF0czoge1xuICAgICAgYnJhd246IDMsXG4gICAgICBjaGFybTogMSxcbiAgICAgIGludGVsbGlnZW5jZTogMSxcbiAgICAgIHJlZmxleGVzOiAzLFxuICAgICAgdGVjaDogMCxcbiAgICAgIGx1Y2s6IDAsXG4gICAgfSxcbiAgICBza2lsbHM6IFt7IG5hbWU6ICdJbnRpbWlkYXRpb24nLCBsZXZlbDogMiB9XSxcbiAgfSxcbiAge1xuICAgIGlkOiAnY18zJyxcbiAgICBuYW1lOiAnR2hvc3QnLFxuICAgIGlzUHVibGljOiBmYWxzZSxcbiAgICBzcGVlZDogMzAsXG4gICAgaGl0UG9pbnRzOiA1LFxuICAgIGNhbXBhaWduSWQ6ICdjYW1wXzInLFxuICAgIHN0YXRzOiB7XG4gICAgICBicmF3bjogMSxcbiAgICAgIGNoYXJtOiAyLFxuICAgICAgaW50ZWxsaWdlbmNlOiA3LFxuICAgICAgcmVmbGV4ZXM6IDYsXG4gICAgICB0ZWNoOiA4LFxuICAgICAgbHVjazogMSxcbiAgICB9LFxuICAgIHNraWxsczogW3sgbmFtZTogJ0hhY2tpbmcnLCBsZXZlbDogOCB9XSxcbiAgfSxcbl07XG4iXSwibmFtZXMiOlsiY2FtcGFpZ25zIiwiaWQiLCJuYW1lIiwiY3liZXJuZXRpY3MiLCJzaG9ydERlc2NyaXB0aW9uIiwibG9uZ0Rlc2NyaXB0aW9uIiwicHJpY2UiLCJiYXR0ZXJ5TGlmZSIsInN0YXRCb251c2VzIiwic3RhdCIsImFtb3VudCIsInNraWxsQm9udXNlcyIsIndlYXBvbnMiLCJ3ZWlnaHQiLCJtYXhSYW5nZSIsIm1heEFtbW9Db3VudCIsInR5cGUiLCJjb25kaXRpb24iLCJ2ZWhpY2xlcyIsInNwZWVkIiwiYXJtb3IiLCJpdGVtcyIsImNoYXJhY3RlcnMiLCJpc1B1YmxpYyIsImhpdFBvaW50cyIsImNhbXBhaWduSWQiLCJzdGF0cyIsImJyYXduIiwiY2hhcm0iLCJpbnRlbGxpZ2VuY2UiLCJyZWZsZXhlcyIsInRlY2giLCJsdWNrIiwic2tpbGxzIiwibGV2ZWwiLCJjeWJlcm5ldGljSWRzIiwid2VhcG9uSWRzIiwidmVoaWNsZUlkcyIsIml0ZW1JZHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/graphql/seed.ts\n");

/***/ }),

/***/ "(rsc)/./src/graphql/yoga.ts":
/*!*****************************!*\
  !*** ./src/graphql/yoga.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createYogaServer: () => (/* binding */ createYogaServer)\n/* harmony export */ });\n/* harmony import */ var graphql_yoga__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! graphql-yoga */ \"(rsc)/./node_modules/graphql-yoga/esm/schema.js\");\n/* harmony import */ var graphql_yoga__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! graphql-yoga */ \"(rsc)/./node_modules/graphql-yoga/esm/server.js\");\n/* harmony import */ var graphql__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! graphql */ \"(rsc)/./node_modules/graphql/error/GraphQLError.mjs\");\n/* harmony import */ var _dataSource__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dataSource */ \"(rsc)/./src/graphql/dataSource.ts\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/graphql/auth.ts\");\n/* harmony import */ var _email_mailer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../email/mailer */ \"(rsc)/./src/email/mailer.ts\");\n\n\n\n\n\nfunction createYogaServer() {\n    const dataSource = (0,_dataSource__WEBPACK_IMPORTED_MODULE_0__.createDataSource)();\n    const SESSION_COOKIE_NAME = 'cyberdallasSession';\n    function parseCookies(cookieHeader) {\n        if (!cookieHeader) return {};\n        const out = {};\n        for (const part of cookieHeader.split(';')){\n            const trimmed = part.trim();\n            if (!trimmed) continue;\n            const eq = trimmed.indexOf('=');\n            if (eq === -1) continue;\n            const key = trimmed.slice(0, eq).trim();\n            const value = trimmed.slice(eq + 1).trim();\n            if (!key) continue;\n            out[key] = value;\n        }\n        return out;\n    }\n    function getTokenFromRequest(request) {\n        const cookieHeader = request.headers.get('cookie');\n        const cookies = parseCookies(cookieHeader);\n        const fromCookie = cookies[SESSION_COOKIE_NAME];\n        if (fromCookie) return fromCookie;\n        return null;\n    }\n    function getExpectedOriginsForRequest(request) {\n        const allowed = new Set();\n        try {\n            allowed.add(new URL(request.url).origin);\n        } catch  {\n        // Ignore.\n        }\n        const appBaseUrl = process.env.APP_BASE_URL;\n        if (appBaseUrl) {\n            try {\n                allowed.add(new URL(appBaseUrl).origin);\n            } catch  {\n            // Ignore.\n            }\n        }\n        return allowed;\n    }\n    function getHeaderOriginValue(request) {\n        const origin = request.headers.get('origin');\n        if (origin) return origin;\n        const referer = request.headers.get('referer');\n        if (!referer) return null;\n        try {\n            return new URL(referer).origin;\n        } catch  {\n            return null;\n        }\n    }\n    async function isGraphQLMutationRequest(request) {\n        if (request.method.toUpperCase() !== 'POST') return false;\n        const contentType = request.headers.get('content-type') ?? '';\n        if (!/application\\/json/i.test(contentType)) return true;\n        try {\n            const cloned = request.clone();\n            const body = await cloned.json();\n            const query = typeof body.query === 'string' ? body.query : '';\n            return /^\\s*mutation\\b/.test(query);\n        } catch  {\n            // If we can't parse the body, treat it as potentially state-changing.\n            return true;\n        }\n    }\n    function buildSessionCookie(token, nowMs = Date.now()) {\n        // Token payload is base64url JSON.\n        const [payloadB64] = token.split('.');\n        let maxAgeSeconds = 7 * 24 * 60 * 60;\n        try {\n            if (payloadB64) {\n                const payloadJson = Buffer.from(payloadB64, 'base64url').toString('utf8');\n                const payload = JSON.parse(payloadJson);\n                if (typeof payload.exp === 'number') {\n                    const deltaMs = payload.exp - nowMs;\n                    maxAgeSeconds = Math.max(0, Math.floor(deltaMs / 1000));\n                }\n            }\n        } catch  {\n        // Fall back to default max-age.\n        }\n        const parts = [\n            `${SESSION_COOKIE_NAME}=${token}`,\n            'Path=/',\n            `Max-Age=${maxAgeSeconds}`,\n            'HttpOnly',\n            'SameSite=Lax'\n        ];\n        if (false) {}\n        return parts.join('; ');\n    }\n    function clearSessionCookie() {\n        const parts = [\n            `${SESSION_COOKIE_NAME}=`,\n            'Path=/',\n            'Max-Age=0',\n            'HttpOnly',\n            'SameSite=Lax'\n        ];\n        if (false) {}\n        return parts.join('; ');\n    }\n    function requireUser(ctx) {\n        if (!ctx.user) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Not authenticated');\n        return ctx.user;\n    }\n    async function getUserFromRequest(request) {\n        const secret = process.env.AUTH_SECRET;\n        if (!secret) return null;\n        const token = getTokenFromRequest(request);\n        if (!token) return null;\n        const userId = (0,_auth__WEBPACK_IMPORTED_MODULE_1__.verifyAuthToken)(token, secret);\n        if (!userId) return null;\n        return dataSource.getUserById(userId);\n    }\n    const schema = (0,graphql_yoga__WEBPACK_IMPORTED_MODULE_4__.createSchema)({\n        typeDefs: /* GraphQL */ `\n      enum StatName {\n        BRAWN\n        CHARM\n        INTELLIGENCE\n        REFLEXES\n        TECH\n        LUCK\n      }\n\n      type Stats {\n        brawn: Int!\n        charm: Int!\n        intelligence: Int!\n        reflexes: Int!\n        tech: Int!\n        luck: Int!\n      }\n\n      type Skill {\n        name: String!\n        level: Int!\n      }\n\n      type StatBonus {\n        stat: StatName!\n        amount: Int!\n      }\n\n      type SkillBonus {\n        name: String!\n        amount: Int!\n      }\n\n      type Cybernetic {\n        id: ID!\n        name: String!\n        shortDescription: String!\n        longDescription: String!\n        price: Int!\n        batteryLife: Int!\n        statBonuses: [StatBonus!]!\n        skillBonuses: [SkillBonus!]!\n      }\n\n      enum WeaponType {\n        MELEE\n        RANGED\n      }\n\n      type Weapon {\n        id: ID!\n        name: String!\n        price: Int!\n        weight: Int!\n        maxRange: Int!\n        maxAmmoCount: Int!\n        type: WeaponType!\n        condition: Int!\n        shortDescription: String!\n        longDescription: String!\n      }\n\n      type Vehicle {\n        id: ID!\n        name: String!\n        price: Int!\n        shortDescription: String!\n        longDescription: String!\n        speed: Int!\n        armor: Int!\n      }\n\n      enum ItemType {\n        GENERAL\n        CYBERDECK\n        CONSUMABLE\n        AMMO\n        OTHER\n      }\n\n      type Item {\n        id: ID!\n        name: String!\n        price: Int!\n        weight: Int!\n        shortDescription: String!\n        longDescription: String!\n        type: ItemType!\n      }\n\n      type Character {\n        id: ID!\n        name: String!\n        isPublic: Boolean!\n        speed: Int!\n        hitPoints: Int!\n        campaign: Campaign\n        stats: Stats!\n        skills: [Skill!]!\n        cybernetics: [Cybernetic!]!\n        weapons: [Weapon!]!\n        items: [Item!]!\n        vehicles: [Vehicle!]!\n      }\n\n      type Campaign {\n        id: ID!\n        name: String!\n        characters: [Character!]!\n      }\n\n      type User {\n        id: ID!\n        email: String!\n      }\n\n      type AuthPayload {\n        user: User!\n      }\n\n      type CampaignInviteToken {\n        token: String!\n        expiresAt: String!\n      }\n\n      type Query {\n        characters: [Character!]!\n        campaigns: [Campaign!]!\n        ownerCampaigns: [Campaign!]!\n        cybernetics: [Cybernetic!]!\n        weapons: [Weapon!]!\n        items: [Item!]!\n        vehicles: [Vehicle!]!\n\n        me: User\n      }\n\n      type Mutation {\n        register(email: String!, password: String!): AuthPayload!\n        login(email: String!, password: String!): AuthPayload!\n        logout: Boolean!\n        joinCampaign(campaignId: ID!): Campaign!\n        createCampaignInvite(campaignId: ID!, email: String!): CampaignInviteToken!\n        acceptCampaignInvite(token: String!): Campaign!\n      }\n    `,\n        resolvers: {\n            Query: {\n                characters: async (_parent, _args, ctx)=>{\n                    const user = requireUser(ctx);\n                    return ctx.dataSource.listCharactersForUser(user.id);\n                },\n                campaigns: async (_parent, _args, ctx)=>{\n                    const user = requireUser(ctx);\n                    return ctx.dataSource.listCampaignsForUser(user.id);\n                },\n                ownerCampaigns: async (_parent, _args, ctx)=>{\n                    const user = requireUser(ctx);\n                    const campaigns = await ctx.dataSource.listCampaignsForUser(user.id);\n                    const owned = [];\n                    for (const campaign of campaigns){\n                        const role = await ctx.dataSource.getCampaignMembershipRole({\n                            userId: user.id,\n                            campaignId: campaign.id\n                        });\n                        if (role === 'OWNER') owned.push(campaign);\n                    }\n                    return owned;\n                },\n                cybernetics: async (_parent, _args, ctx)=>ctx.dataSource.listCybernetics(),\n                weapons: async (_parent, _args, ctx)=>ctx.dataSource.listWeapons(),\n                items: async (_parent, _args, ctx)=>ctx.dataSource.listItems(),\n                vehicles: async (_parent, _args, ctx)=>ctx.dataSource.listVehicles(),\n                me: async (_parent, _args, ctx)=>ctx.user\n            },\n            Mutation: {\n                register: async (_parent, args, ctx)=>{\n                    const email = args.email.trim().toLowerCase();\n                    const password = args.password;\n                    if (!(0,_auth__WEBPACK_IMPORTED_MODULE_1__.isValidEmail)(email)) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invalid email');\n                    if (password.length < 8) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Password must be at least 8 characters');\n                    const existing = await ctx.dataSource.findUserByEmail(email);\n                    if (existing) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('User already exists');\n                    const passwordHash = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.hashPassword)(password);\n                    let user;\n                    try {\n                        user = await ctx.dataSource.createUser({\n                            email,\n                            passwordHash\n                        });\n                    } catch (error) {\n                        if (error instanceof Error && error.message === 'DUPLICATE_EMAIL') {\n                            throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('User already exists');\n                        }\n                        throw error;\n                    }\n                    const secret = process.env.AUTH_SECRET;\n                    if (!secret) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Server misconfigured: AUTH_SECRET is missing');\n                    const token = (0,_auth__WEBPACK_IMPORTED_MODULE_1__.issueAuthToken)(user.id, secret);\n                    ctx.httpHeaders['set-cookie'] = buildSessionCookie(token);\n                    return {\n                        user\n                    };\n                },\n                login: async (_parent, args, ctx)=>{\n                    const email = args.email.trim().toLowerCase();\n                    const password = args.password;\n                    const user = await ctx.dataSource.findUserByEmail(email);\n                    if (!user) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invalid credentials');\n                    const ok = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.verifyPassword)(password, user.passwordHash);\n                    if (!ok) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invalid credentials');\n                    const secret = process.env.AUTH_SECRET;\n                    if (!secret) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Server misconfigured: AUTH_SECRET is missing');\n                    const token = (0,_auth__WEBPACK_IMPORTED_MODULE_1__.issueAuthToken)(user.id, secret);\n                    ctx.httpHeaders['set-cookie'] = buildSessionCookie(token);\n                    return {\n                        user: {\n                            id: user.id,\n                            email: user.email\n                        }\n                    };\n                },\n                logout: async (_parent, _args, ctx)=>{\n                    ctx.httpHeaders['set-cookie'] = clearSessionCookie();\n                    return true;\n                },\n                joinCampaign: async (_parent, args, ctx)=>{\n                    const user = requireUser(ctx);\n                    const campaignId = String(args.campaignId);\n                    const campaign = await ctx.dataSource.getCampaignById(campaignId);\n                    if (!campaign) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Campaign not found');\n                    await ctx.dataSource.addUserToCampaign({\n                        userId: user.id,\n                        campaignId\n                    });\n                    return campaign;\n                },\n                createCampaignInvite: async (_parent, args, ctx)=>{\n                    const user = requireUser(ctx);\n                    const campaignId = String(args.campaignId);\n                    const email = args.email.trim().toLowerCase();\n                    if (!(0,_auth__WEBPACK_IMPORTED_MODULE_1__.isValidEmail)(email)) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invalid email');\n                    const role = await ctx.dataSource.getCampaignMembershipRole({\n                        userId: user.id,\n                        campaignId\n                    });\n                    if (role !== 'OWNER') throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Not authorized');\n                    const ttlMs = 7 * 24 * 60 * 60 * 1000;\n                    const invite = await ctx.dataSource.createCampaignInvite({\n                        campaignId,\n                        email,\n                        ttlMs\n                    });\n                    const baseUrl = process.env.APP_BASE_URL ?? 'http://localhost:3000';\n                    const inviteUrl = `${baseUrl.replace(/\\/$/, '')}/invite?token=${encodeURIComponent(invite.token)}`;\n                    const campaign = await ctx.dataSource.getCampaignById(campaignId);\n                    if (!campaign) throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Campaign not found');\n                    await (0,_email_mailer__WEBPACK_IMPORTED_MODULE_2__.sendCampaignInviteEmail)({\n                        to: email,\n                        campaignName: campaign.name,\n                        inviteUrl,\n                        expiresAtIso: invite.expiresAt\n                    });\n                    return invite;\n                },\n                acceptCampaignInvite: async (_parent, args, ctx)=>{\n                    const user = requireUser(ctx);\n                    const token = String(args.token);\n                    try {\n                        return await ctx.dataSource.acceptCampaignInvite({\n                            token,\n                            userId: user.id,\n                            userEmail: user.email\n                        });\n                    } catch (error) {\n                        if (error instanceof Error && error.message === 'INVITE_EMAIL_MISMATCH') {\n                            throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invite is for a different email');\n                        }\n                        if (error instanceof Error && error.message === 'INVITE_EXPIRED') {\n                            throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invite has expired');\n                        }\n                        if (error instanceof Error && error.message === 'INVITE_ALREADY_USED') {\n                            throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invite has already been used');\n                        }\n                        if (error instanceof Error && error.message === 'INVITE_NOT_FOUND') {\n                            throw new graphql__WEBPACK_IMPORTED_MODULE_3__.GraphQLError('Invite not found');\n                        }\n                        throw error;\n                    }\n                }\n            },\n            Character: {\n                isPublic: (character)=>character.isPublic ?? false,\n                speed: (character)=>character.speed ?? 30,\n                hitPoints: (character)=>character.hitPoints ?? 5,\n                campaign: async (character, _args, ctx)=>{\n                    const campaignId = character.campaignId;\n                    if (!campaignId) return null;\n                    return ctx.dataSource.getCampaignById(campaignId);\n                },\n                stats: (character)=>{\n                    const stats = character.stats ?? {};\n                    return {\n                        brawn: stats.brawn ?? 0,\n                        charm: stats.charm ?? 0,\n                        intelligence: stats.intelligence ?? 0,\n                        reflexes: stats.reflexes ?? 0,\n                        tech: stats.tech ?? 0,\n                        luck: stats.luck ?? 0\n                    };\n                },\n                skills: (character)=>character.skills ?? [],\n                cybernetics: async (character, _args, ctx)=>{\n                    const allCybernetics = await ctx.dataSource.listCybernetics();\n                    const ids = character.cyberneticIds ?? [];\n                    return ids.map((id)=>allCybernetics.find((cybernetic)=>cybernetic.id === id)).filter((cybernetic)=>Boolean(cybernetic));\n                },\n                weapons: async (character, _args, ctx)=>{\n                    const allWeapons = await ctx.dataSource.listWeapons();\n                    const ids = character.weaponIds ?? [];\n                    return ids.map((id)=>allWeapons.find((weapon)=>weapon.id === id)).filter((weapon)=>Boolean(weapon));\n                },\n                items: async (character, _args, ctx)=>{\n                    const allItems = await ctx.dataSource.listItems();\n                    const ids = character.itemIds ?? [];\n                    return ids.map((id)=>allItems.find((item)=>item.id === id)).filter((item)=>Boolean(item));\n                },\n                vehicles: async (character, _args, ctx)=>{\n                    const allVehicles = await ctx.dataSource.listVehicles();\n                    const ids = character.vehicleIds ?? [];\n                    return ids.map((id)=>allVehicles.find((vehicle)=>vehicle.id === id)).filter((vehicle)=>Boolean(vehicle));\n                }\n            },\n            Campaign: {\n                characters: async (campaign, _args, ctx)=>{\n                    const user = requireUser(ctx);\n                    const visibleCharacters = await ctx.dataSource.listCharactersForUser(user.id);\n                    return visibleCharacters.filter((character)=>character.campaignId === campaign.id);\n                }\n            },\n            Cybernetic: {\n                statBonuses: (cybernetic)=>cybernetic.statBonuses ?? [],\n                skillBonuses: (cybernetic)=>cybernetic.skillBonuses ?? []\n            }\n        }\n    });\n    return (0,graphql_yoga__WEBPACK_IMPORTED_MODULE_5__.createYoga)({\n        schema,\n        graphqlEndpoint: '/api/graphql',\n        context: async ({ request })=>({\n                dataSource,\n                user: await getUserFromRequest(request),\n                httpHeaders: {}\n            }),\n        maskedErrors: false,\n        plugins: [\n            {\n                async onRequest ({ request, endResponse }) {\n                    if (!await isGraphQLMutationRequest(request)) return;\n                    const headerOrigin = getHeaderOriginValue(request);\n                    const allowed = getExpectedOriginsForRequest(request);\n                    // Enforce Origin/Referer checks for mutation requests to mitigate CSRF.\n                    if (!headerOrigin) {\n                        // Browsers include Origin for fetch POSTs; missing Origin is suspicious in production.\n                        if (false) {}\n                        return;\n                    }\n                    if (!allowed.has(headerOrigin)) {\n                        endResponse(new Response('Forbidden', {\n                            status: 403\n                        }));\n                    }\n                }\n            },\n            {\n                onExecutionResult ({ result, setResult, context }) {\n                    const httpHeaders = context.httpHeaders;\n                    if (!httpHeaders || Object.keys(httpHeaders).length === 0) return;\n                    if (!result) return;\n                    const isAsyncIterable = typeof result[Symbol.asyncIterator] === 'function';\n                    if (isAsyncIterable) return;\n                    const res = result;\n                    const next = {\n                        ...res,\n                        extensions: {\n                            ...res.extensions ?? {},\n                            http: {\n                                ...res.extensions?.http ?? {},\n                                headers: {\n                                    ...res.extensions?.http?.headers ?? {},\n                                    ...httpHeaders\n                                }\n                            }\n                        }\n                    };\n                    setResult(next);\n                }\n            }\n        ]\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksQ0FBQ3ZFLGFBQWFSLE1BQU0sS0FBSyxHQUFHO29CQUUzRCxJQUFJLENBQUM0RSxRQUFRO29CQUNiLE1BQU1JLGtCQUFrQixPQUFPLE1BQWUsQ0FBQ0MsT0FBT0MsYUFBYSxDQUFDLEtBQUs7b0JBQ3pFLElBQUlGLGlCQUFpQjtvQkFFckIsTUFBTUcsTUFBTVA7b0JBQ1osTUFBTVEsT0FBTzt3QkFDWCxHQUFHRCxHQUFHO3dCQUNORSxZQUFZOzRCQUNWLEdBQUlGLElBQUlFLFVBQVUsSUFBSSxDQUFDLENBQUM7NEJBQ3hCQyxNQUFNO2dDQUNKLEdBQUlILElBQUlFLFVBQVUsRUFBRUMsUUFBUSxDQUFDLENBQUM7Z0NBQzlCaEwsU0FBUztvQ0FDUCxHQUFJNkssSUFBSUUsVUFBVSxFQUFFQyxNQUFNaEwsV0FBVyxDQUFDLENBQUM7b0NBQ3ZDLEdBQUdrRyxXQUFXO2dDQUNoQjs0QkFDRjt3QkFDRjtvQkFDRjtvQkFDQXFFLFVBQVVPO2dCQUNaO1lBQ0Y7U0FDRDtJQUNIO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YXlsb3J3b2Zmb3JkL0Rlc2t0b3AvY3liZXJkYWxsYXNfMjA2OS9zcmMvZ3JhcGhxbC95b2dhLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNjaGVtYSwgY3JlYXRlWW9nYSB9IGZyb20gJ2dyYXBocWwteW9nYSc7XG5pbXBvcnQgeyBHcmFwaFFMRXJyb3IgfSBmcm9tICdncmFwaHFsJztcblxuaW1wb3J0IHsgY3JlYXRlRGF0YVNvdXJjZSwgdHlwZSBEYXRhU291cmNlIH0gZnJvbSAnLi9kYXRhU291cmNlJztcbmltcG9ydCB7IGhhc2hQYXNzd29yZCwgaXNWYWxpZEVtYWlsLCBpc3N1ZUF1dGhUb2tlbiwgdmVyaWZ5QXV0aFRva2VuLCB2ZXJpZnlQYXNzd29yZCB9IGZyb20gJy4vYXV0aCc7XG5pbXBvcnQgeyBzZW5kQ2FtcGFpZ25JbnZpdGVFbWFpbCB9IGZyb20gJy4uL2VtYWlsL21haWxlcic7XG5pbXBvcnQgdHlwZSB7XG4gIENhbXBhaWduUmVjb3JkLFxuICBDaGFyYWN0ZXJSZWNvcmQsXG4gIEN5YmVybmV0aWNSZWNvcmQsXG4gIEl0ZW1SZWNvcmQsXG4gIFN0YXRzUmVjb3JkLFxuICBWZWhpY2xlUmVjb3JkLFxuICBXZWFwb25SZWNvcmQsXG59IGZyb20gJy4vc2VlZCc7XG5cbnR5cGUgWW9nYUNvbnRleHQgPSB7XG4gIGRhdGFTb3VyY2U6IERhdGFTb3VyY2U7XG4gIHVzZXI6IHsgaWQ6IHN0cmluZzsgZW1haWw6IHN0cmluZyB9IHwgbnVsbDtcbiAgaHR0cEhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlWW9nYVNlcnZlcigpIHtcbiAgY29uc3QgZGF0YVNvdXJjZSA9IGNyZWF0ZURhdGFTb3VyY2UoKTtcblxuICBjb25zdCBTRVNTSU9OX0NPT0tJRV9OQU1FID0gJ2N5YmVyZGFsbGFzU2Vzc2lvbic7XG5cbiAgZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcjogc3RyaW5nIHwgbnVsbCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIGlmICghY29va2llSGVhZGVyKSByZXR1cm4ge307XG4gICAgY29uc3Qgb3V0OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIGNvb2tpZUhlYWRlci5zcGxpdCgnOycpKSB7XG4gICAgICBjb25zdCB0cmltbWVkID0gcGFydC50cmltKCk7XG4gICAgICBpZiAoIXRyaW1tZWQpIGNvbnRpbnVlO1xuICAgICAgY29uc3QgZXEgPSB0cmltbWVkLmluZGV4T2YoJz0nKTtcbiAgICAgIGlmIChlcSA9PT0gLTEpIGNvbnRpbnVlO1xuICAgICAgY29uc3Qga2V5ID0gdHJpbW1lZC5zbGljZSgwLCBlcSkudHJpbSgpO1xuICAgICAgY29uc3QgdmFsdWUgPSB0cmltbWVkLnNsaWNlKGVxICsgMSkudHJpbSgpO1xuICAgICAgaWYgKCFrZXkpIGNvbnRpbnVlO1xuICAgICAgb3V0W2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFRva2VuRnJvbVJlcXVlc3QocmVxdWVzdDogUmVxdWVzdCk6IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IGNvb2tpZUhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2Nvb2tpZScpO1xuICAgIGNvbnN0IGNvb2tpZXMgPSBwYXJzZUNvb2tpZXMoY29va2llSGVhZGVyKTtcbiAgICBjb25zdCBmcm9tQ29va2llID0gY29va2llc1tTRVNTSU9OX0NPT0tJRV9OQU1FXTtcbiAgICBpZiAoZnJvbUNvb2tpZSkgcmV0dXJuIGZyb21Db29raWU7XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEV4cGVjdGVkT3JpZ2luc0ZvclJlcXVlc3QocmVxdWVzdDogUmVxdWVzdCk6IFNldDxzdHJpbmc+IHtcbiAgICBjb25zdCBhbGxvd2VkID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgdHJ5IHtcbiAgICAgIGFsbG93ZWQuYWRkKG5ldyBVUkwocmVxdWVzdC51cmwpLm9yaWdpbik7XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBJZ25vcmUuXG4gICAgfVxuXG4gICAgY29uc3QgYXBwQmFzZVVybCA9IHByb2Nlc3MuZW52LkFQUF9CQVNFX1VSTDtcbiAgICBpZiAoYXBwQmFzZVVybCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYWxsb3dlZC5hZGQobmV3IFVSTChhcHBCYXNlVXJsKS5vcmlnaW4pO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIElnbm9yZS5cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYWxsb3dlZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEhlYWRlck9yaWdpblZhbHVlKHJlcXVlc3Q6IFJlcXVlc3QpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBvcmlnaW4gPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdvcmlnaW4nKTtcbiAgICBpZiAob3JpZ2luKSByZXR1cm4gb3JpZ2luO1xuXG4gICAgY29uc3QgcmVmZXJlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3JlZmVyZXInKTtcbiAgICBpZiAoIXJlZmVyZXIpIHJldHVybiBudWxsO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbmV3IFVSTChyZWZlcmVyKS5vcmlnaW47XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBpc0dyYXBoUUxNdXRhdGlvblJlcXVlc3QocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmIChyZXF1ZXN0Lm1ldGhvZC50b1VwcGVyQ2FzZSgpICE9PSAnUE9TVCcpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpID8/ICcnO1xuICAgIGlmICghL2FwcGxpY2F0aW9uXFwvanNvbi9pLnRlc3QoY29udGVudFR5cGUpKSByZXR1cm4gdHJ1ZTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbG9uZWQgPSByZXF1ZXN0LmNsb25lKCk7XG4gICAgICBjb25zdCBib2R5ID0gKGF3YWl0IGNsb25lZC5qc29uKCkpIGFzIHsgcXVlcnk/OiB1bmtub3duIH07XG4gICAgICBjb25zdCBxdWVyeSA9IHR5cGVvZiBib2R5LnF1ZXJ5ID09PSAnc3RyaW5nJyA/IGJvZHkucXVlcnkgOiAnJztcbiAgICAgIHJldHVybiAvXlxccyptdXRhdGlvblxcYi8udGVzdChxdWVyeSk7XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBJZiB3ZSBjYW4ndCBwYXJzZSB0aGUgYm9keSwgdHJlYXQgaXQgYXMgcG90ZW50aWFsbHkgc3RhdGUtY2hhbmdpbmcuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBidWlsZFNlc3Npb25Db29raWUodG9rZW46IHN0cmluZywgbm93TXM6IG51bWJlciA9IERhdGUubm93KCkpOiBzdHJpbmcge1xuICAgIC8vIFRva2VuIHBheWxvYWQgaXMgYmFzZTY0dXJsIEpTT04uXG4gICAgY29uc3QgW3BheWxvYWRCNjRdID0gdG9rZW4uc3BsaXQoJy4nKTtcbiAgICBsZXQgbWF4QWdlU2Vjb25kcyA9IDcgKiAyNCAqIDYwICogNjA7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChwYXlsb2FkQjY0KSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWRKc29uID0gQnVmZmVyLmZyb20ocGF5bG9hZEI2NCwgJ2Jhc2U2NHVybCcpLnRvU3RyaW5nKCd1dGY4Jyk7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnBhcnNlKHBheWxvYWRKc29uKSBhcyB7IGV4cD86IG51bWJlciB9O1xuICAgICAgICBpZiAodHlwZW9mIHBheWxvYWQuZXhwID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIGNvbnN0IGRlbHRhTXMgPSBwYXlsb2FkLmV4cCAtIG5vd01zO1xuICAgICAgICAgIG1heEFnZVNlY29uZHMgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGRlbHRhTXMgLyAxMDAwKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIEZhbGwgYmFjayB0byBkZWZhdWx0IG1heC1hZ2UuXG4gICAgfVxuXG4gICAgY29uc3QgcGFydHMgPSBbYCR7U0VTU0lPTl9DT09LSUVfTkFNRX09JHt0b2tlbn1gLCAnUGF0aD0vJywgYE1heC1BZ2U9JHttYXhBZ2VTZWNvbmRzfWAsICdIdHRwT25seScsICdTYW1lU2l0ZT1MYXgnXTtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykgcGFydHMucHVzaCgnU2VjdXJlJyk7XG4gICAgcmV0dXJuIHBhcnRzLmpvaW4oJzsgJyk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhclNlc3Npb25Db29raWUoKTogc3RyaW5nIHtcbiAgICBjb25zdCBwYXJ0cyA9IFtgJHtTRVNTSU9OX0NPT0tJRV9OQU1FfT1gLCAnUGF0aD0vJywgJ01heC1BZ2U9MCcsICdIdHRwT25seScsICdTYW1lU2l0ZT1MYXgnXTtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykgcGFydHMucHVzaCgnU2VjdXJlJyk7XG4gICAgcmV0dXJuIHBhcnRzLmpvaW4oJzsgJyk7XG4gIH1cblxuICBmdW5jdGlvbiByZXF1aXJlVXNlcihjdHg6IFlvZ2FDb250ZXh0KSB7XG4gICAgaWYgKCFjdHgudXNlcikgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignTm90IGF1dGhlbnRpY2F0ZWQnKTtcbiAgICByZXR1cm4gY3R4LnVzZXI7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBnZXRVc2VyRnJvbVJlcXVlc3QocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8WW9nYUNvbnRleHRbJ3VzZXInXT4ge1xuICAgIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LkFVVEhfU0VDUkVUO1xuICAgIGlmICghc2VjcmV0KSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IHRva2VuID0gZ2V0VG9rZW5Gcm9tUmVxdWVzdChyZXF1ZXN0KTtcbiAgICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IHVzZXJJZCA9IHZlcmlmeUF1dGhUb2tlbih0b2tlbiwgc2VjcmV0KTtcbiAgICBpZiAoIXVzZXJJZCkgcmV0dXJuIG51bGw7XG5cbiAgICByZXR1cm4gZGF0YVNvdXJjZS5nZXRVc2VyQnlJZCh1c2VySWQpO1xuICB9XG5cbiAgY29uc3Qgc2NoZW1hID0gY3JlYXRlU2NoZW1hKHtcbiAgICB0eXBlRGVmczogLyogR3JhcGhRTCAqLyBgXG4gICAgICBlbnVtIFN0YXROYW1lIHtcbiAgICAgICAgQlJBV05cbiAgICAgICAgQ0hBUk1cbiAgICAgICAgSU5URUxMSUdFTkNFXG4gICAgICAgIFJFRkxFWEVTXG4gICAgICAgIFRFQ0hcbiAgICAgICAgTFVDS1xuICAgICAgfVxuXG4gICAgICB0eXBlIFN0YXRzIHtcbiAgICAgICAgYnJhd246IEludCFcbiAgICAgICAgY2hhcm06IEludCFcbiAgICAgICAgaW50ZWxsaWdlbmNlOiBJbnQhXG4gICAgICAgIHJlZmxleGVzOiBJbnQhXG4gICAgICAgIHRlY2g6IEludCFcbiAgICAgICAgbHVjazogSW50IVxuICAgICAgfVxuXG4gICAgICB0eXBlIFNraWxsIHtcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgICBsZXZlbDogSW50IVxuICAgICAgfVxuXG4gICAgICB0eXBlIFN0YXRCb251cyB7XG4gICAgICAgIHN0YXQ6IFN0YXROYW1lIVxuICAgICAgICBhbW91bnQ6IEludCFcbiAgICAgIH1cblxuICAgICAgdHlwZSBTa2lsbEJvbnVzIHtcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgICBhbW91bnQ6IEludCFcbiAgICAgIH1cblxuICAgICAgdHlwZSBDeWJlcm5ldGljIHtcbiAgICAgICAgaWQ6IElEIVxuICAgICAgICBuYW1lOiBTdHJpbmchXG4gICAgICAgIHNob3J0RGVzY3JpcHRpb246IFN0cmluZyFcbiAgICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBTdHJpbmchXG4gICAgICAgIHByaWNlOiBJbnQhXG4gICAgICAgIGJhdHRlcnlMaWZlOiBJbnQhXG4gICAgICAgIHN0YXRCb251c2VzOiBbU3RhdEJvbnVzIV0hXG4gICAgICAgIHNraWxsQm9udXNlczogW1NraWxsQm9udXMhXSFcbiAgICAgIH1cblxuICAgICAgZW51bSBXZWFwb25UeXBlIHtcbiAgICAgICAgTUVMRUVcbiAgICAgICAgUkFOR0VEXG4gICAgICB9XG5cbiAgICAgIHR5cGUgV2VhcG9uIHtcbiAgICAgICAgaWQ6IElEIVxuICAgICAgICBuYW1lOiBTdHJpbmchXG4gICAgICAgIHByaWNlOiBJbnQhXG4gICAgICAgIHdlaWdodDogSW50IVxuICAgICAgICBtYXhSYW5nZTogSW50IVxuICAgICAgICBtYXhBbW1vQ291bnQ6IEludCFcbiAgICAgICAgdHlwZTogV2VhcG9uVHlwZSFcbiAgICAgICAgY29uZGl0aW9uOiBJbnQhXG4gICAgICAgIHNob3J0RGVzY3JpcHRpb246IFN0cmluZyFcbiAgICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBTdHJpbmchXG4gICAgICB9XG5cbiAgICAgIHR5cGUgVmVoaWNsZSB7XG4gICAgICAgIGlkOiBJRCFcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgICBwcmljZTogSW50IVxuICAgICAgICBzaG9ydERlc2NyaXB0aW9uOiBTdHJpbmchXG4gICAgICAgIGxvbmdEZXNjcmlwdGlvbjogU3RyaW5nIVxuICAgICAgICBzcGVlZDogSW50IVxuICAgICAgICBhcm1vcjogSW50IVxuICAgICAgfVxuXG4gICAgICBlbnVtIEl0ZW1UeXBlIHtcbiAgICAgICAgR0VORVJBTFxuICAgICAgICBDWUJFUkRFQ0tcbiAgICAgICAgQ09OU1VNQUJMRVxuICAgICAgICBBTU1PXG4gICAgICAgIE9USEVSXG4gICAgICB9XG5cbiAgICAgIHR5cGUgSXRlbSB7XG4gICAgICAgIGlkOiBJRCFcbiAgICAgICAgbmFtZTogU3RyaW5nIVxuICAgICAgICBwcmljZTogSW50IVxuICAgICAgICB3ZWlnaHQ6IEludCFcbiAgICAgICAgc2hvcnREZXNjcmlwdGlvbjogU3RyaW5nIVxuICAgICAgICBsb25nRGVzY3JpcHRpb246IFN0cmluZyFcbiAgICAgICAgdHlwZTogSXRlbVR5cGUhXG4gICAgICB9XG5cbiAgICAgIHR5cGUgQ2hhcmFjdGVyIHtcbiAgICAgICAgaWQ6IElEIVxuICAgICAgICBuYW1lOiBTdHJpbmchXG4gICAgICAgIGlzUHVibGljOiBCb29sZWFuIVxuICAgICAgICBzcGVlZDogSW50IVxuICAgICAgICBoaXRQb2ludHM6IEludCFcbiAgICAgICAgY2FtcGFpZ246IENhbXBhaWduXG4gICAgICAgIHN0YXRzOiBTdGF0cyFcbiAgICAgICAgc2tpbGxzOiBbU2tpbGwhXSFcbiAgICAgICAgY3liZXJuZXRpY3M6IFtDeWJlcm5ldGljIV0hXG4gICAgICAgIHdlYXBvbnM6IFtXZWFwb24hXSFcbiAgICAgICAgaXRlbXM6IFtJdGVtIV0hXG4gICAgICAgIHZlaGljbGVzOiBbVmVoaWNsZSFdIVxuICAgICAgfVxuXG4gICAgICB0eXBlIENhbXBhaWduIHtcbiAgICAgICAgaWQ6IElEIVxuICAgICAgICBuYW1lOiBTdHJpbmchXG4gICAgICAgIGNoYXJhY3RlcnM6IFtDaGFyYWN0ZXIhXSFcbiAgICAgIH1cblxuICAgICAgdHlwZSBVc2VyIHtcbiAgICAgICAgaWQ6IElEIVxuICAgICAgICBlbWFpbDogU3RyaW5nIVxuICAgICAgfVxuXG4gICAgICB0eXBlIEF1dGhQYXlsb2FkIHtcbiAgICAgICAgdXNlcjogVXNlciFcbiAgICAgIH1cblxuICAgICAgdHlwZSBDYW1wYWlnbkludml0ZVRva2VuIHtcbiAgICAgICAgdG9rZW46IFN0cmluZyFcbiAgICAgICAgZXhwaXJlc0F0OiBTdHJpbmchXG4gICAgICB9XG5cbiAgICAgIHR5cGUgUXVlcnkge1xuICAgICAgICBjaGFyYWN0ZXJzOiBbQ2hhcmFjdGVyIV0hXG4gICAgICAgIGNhbXBhaWduczogW0NhbXBhaWduIV0hXG4gICAgICAgIG93bmVyQ2FtcGFpZ25zOiBbQ2FtcGFpZ24hXSFcbiAgICAgICAgY3liZXJuZXRpY3M6IFtDeWJlcm5ldGljIV0hXG4gICAgICAgIHdlYXBvbnM6IFtXZWFwb24hXSFcbiAgICAgICAgaXRlbXM6IFtJdGVtIV0hXG4gICAgICAgIHZlaGljbGVzOiBbVmVoaWNsZSFdIVxuXG4gICAgICAgIG1lOiBVc2VyXG4gICAgICB9XG5cbiAgICAgIHR5cGUgTXV0YXRpb24ge1xuICAgICAgICByZWdpc3RlcihlbWFpbDogU3RyaW5nISwgcGFzc3dvcmQ6IFN0cmluZyEpOiBBdXRoUGF5bG9hZCFcbiAgICAgICAgbG9naW4oZW1haWw6IFN0cmluZyEsIHBhc3N3b3JkOiBTdHJpbmchKTogQXV0aFBheWxvYWQhXG4gICAgICAgIGxvZ291dDogQm9vbGVhbiFcbiAgICAgICAgam9pbkNhbXBhaWduKGNhbXBhaWduSWQ6IElEISk6IENhbXBhaWduIVxuICAgICAgICBjcmVhdGVDYW1wYWlnbkludml0ZShjYW1wYWlnbklkOiBJRCEsIGVtYWlsOiBTdHJpbmchKTogQ2FtcGFpZ25JbnZpdGVUb2tlbiFcbiAgICAgICAgYWNjZXB0Q2FtcGFpZ25JbnZpdGUodG9rZW46IFN0cmluZyEpOiBDYW1wYWlnbiFcbiAgICAgIH1cbiAgICBgLFxuICAgIHJlc29sdmVyczoge1xuICAgICAgUXVlcnk6IHtcbiAgICAgICAgY2hhcmFjdGVyczogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIF9hcmdzOiB1bmtub3duLCBjdHg6IFlvZ2FDb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlciA9IHJlcXVpcmVVc2VyKGN0eCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5kYXRhU291cmNlLmxpc3RDaGFyYWN0ZXJzRm9yVXNlcih1c2VyLmlkKTtcbiAgICAgICAgfSxcbiAgICAgICAgY2FtcGFpZ25zOiBhc3luYyAoX3BhcmVudDogdW5rbm93biwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVxdWlyZVVzZXIoY3R4KTtcbiAgICAgICAgICByZXR1cm4gY3R4LmRhdGFTb3VyY2UubGlzdENhbXBhaWduc0ZvclVzZXIodXNlci5pZCk7XG4gICAgICAgIH0sXG4gICAgICAgIG93bmVyQ2FtcGFpZ25zOiBhc3luYyAoX3BhcmVudDogdW5rbm93biwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVxdWlyZVVzZXIoY3R4KTtcbiAgICAgICAgICBjb25zdCBjYW1wYWlnbnMgPSBhd2FpdCBjdHguZGF0YVNvdXJjZS5saXN0Q2FtcGFpZ25zRm9yVXNlcih1c2VyLmlkKTtcbiAgICAgICAgICBjb25zdCBvd25lZDogQXJyYXk8Q2FtcGFpZ25SZWNvcmQ+ID0gW107XG4gICAgICAgICAgZm9yIChjb25zdCBjYW1wYWlnbiBvZiBjYW1wYWlnbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvbGUgPSBhd2FpdCBjdHguZGF0YVNvdXJjZS5nZXRDYW1wYWlnbk1lbWJlcnNoaXBSb2xlKHsgdXNlcklkOiB1c2VyLmlkLCBjYW1wYWlnbklkOiBjYW1wYWlnbi5pZCB9KTtcbiAgICAgICAgICAgIGlmIChyb2xlID09PSAnT1dORVInKSBvd25lZC5wdXNoKGNhbXBhaWduKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG93bmVkO1xuICAgICAgICB9LFxuICAgICAgICBjeWJlcm5ldGljczogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIF9hcmdzOiB1bmtub3duLCBjdHg6IFlvZ2FDb250ZXh0KSA9PiBjdHguZGF0YVNvdXJjZS5saXN0Q3liZXJuZXRpY3MoKSxcbiAgICAgICAgd2VhcG9uczogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIF9hcmdzOiB1bmtub3duLCBjdHg6IFlvZ2FDb250ZXh0KSA9PiBjdHguZGF0YVNvdXJjZS5saXN0V2VhcG9ucygpLFxuICAgICAgICBpdGVtczogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIF9hcmdzOiB1bmtub3duLCBjdHg6IFlvZ2FDb250ZXh0KSA9PiBjdHguZGF0YVNvdXJjZS5saXN0SXRlbXMoKSxcbiAgICAgICAgdmVoaWNsZXM6IGFzeW5jIChfcGFyZW50OiB1bmtub3duLCBfYXJnczogdW5rbm93biwgY3R4OiBZb2dhQ29udGV4dCkgPT4gY3R4LmRhdGFTb3VyY2UubGlzdFZlaGljbGVzKCksXG4gICAgICAgIG1lOiBhc3luYyAoX3BhcmVudDogdW5rbm93biwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IGN0eC51c2VyLFxuICAgICAgfSxcbiAgICAgIE11dGF0aW9uOiB7XG4gICAgICAgIHJlZ2lzdGVyOiBhc3luYyAoX3BhcmVudDogdW5rbm93biwgYXJnczogeyBlbWFpbDogc3RyaW5nOyBwYXNzd29yZDogc3RyaW5nIH0sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IGFyZ3MuZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgY29uc3QgcGFzc3dvcmQgPSBhcmdzLnBhc3N3b3JkO1xuXG4gICAgICAgICAgaWYgKCFpc1ZhbGlkRW1haWwoZW1haWwpKSB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdJbnZhbGlkIGVtYWlsJyk7XG4gICAgICAgICAgaWYgKHBhc3N3b3JkLmxlbmd0aCA8IDgpIHRocm93IG5ldyBHcmFwaFFMRXJyb3IoJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzJyk7XG5cbiAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGN0eC5kYXRhU291cmNlLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdVc2VyIGFscmVhZHkgZXhpc3RzJyk7XG5cbiAgICAgICAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBoYXNoUGFzc3dvcmQocGFzc3dvcmQpO1xuICAgICAgICAgIGxldCB1c2VyOiB7IGlkOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmcgfTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgdXNlciA9IGF3YWl0IGN0eC5kYXRhU291cmNlLmNyZWF0ZVVzZXIoeyBlbWFpbCwgcGFzc3dvcmRIYXNoIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlID09PSAnRFVQTElDQVRFX0VNQUlMJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdVc2VyIGFscmVhZHkgZXhpc3RzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5BVVRIX1NFQ1JFVDtcbiAgICAgICAgICBpZiAoIXNlY3JldCkgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignU2VydmVyIG1pc2NvbmZpZ3VyZWQ6IEFVVEhfU0VDUkVUIGlzIG1pc3NpbmcnKTtcblxuICAgICAgICAgIGNvbnN0IHRva2VuID0gaXNzdWVBdXRoVG9rZW4odXNlci5pZCwgc2VjcmV0KTtcbiAgICAgICAgICBjdHguaHR0cEhlYWRlcnNbJ3NldC1jb29raWUnXSA9IGJ1aWxkU2Vzc2lvbkNvb2tpZSh0b2tlbik7XG4gICAgICAgICAgcmV0dXJuIHsgdXNlciB9O1xuICAgICAgICB9LFxuICAgICAgICBsb2dpbjogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIGFyZ3M6IHsgZW1haWw6IHN0cmluZzsgcGFzc3dvcmQ6IHN0cmluZyB9LCBjdHg6IFlvZ2FDb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBhcmdzLmVtYWlsLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGNvbnN0IHBhc3N3b3JkID0gYXJncy5wYXNzd29yZDtcblxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguZGF0YVNvdXJjZS5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignSW52YWxpZCBjcmVkZW50aWFscycpO1xuXG4gICAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCB2ZXJpZnlQYXNzd29yZChwYXNzd29yZCwgdXNlci5wYXNzd29yZEhhc2gpO1xuICAgICAgICAgIGlmICghb2spIHRocm93IG5ldyBHcmFwaFFMRXJyb3IoJ0ludmFsaWQgY3JlZGVudGlhbHMnKTtcblxuICAgICAgICAgIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LkFVVEhfU0VDUkVUO1xuICAgICAgICAgIGlmICghc2VjcmV0KSB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdTZXJ2ZXIgbWlzY29uZmlndXJlZDogQVVUSF9TRUNSRVQgaXMgbWlzc2luZycpO1xuXG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBpc3N1ZUF1dGhUb2tlbih1c2VyLmlkLCBzZWNyZXQpO1xuICAgICAgICAgIGN0eC5odHRwSGVhZGVyc1snc2V0LWNvb2tpZSddID0gYnVpbGRTZXNzaW9uQ29va2llKHRva2VuKTtcbiAgICAgICAgICByZXR1cm4geyB1c2VyOiB7IGlkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCB9IH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgbG9nb3V0OiBhc3luYyAoX3BhcmVudDogdW5rbm93biwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjdHguaHR0cEhlYWRlcnNbJ3NldC1jb29raWUnXSA9IGNsZWFyU2Vzc2lvbkNvb2tpZSgpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGpvaW5DYW1wYWlnbjogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIGFyZ3M6IHsgY2FtcGFpZ25JZDogc3RyaW5nIH0sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVxdWlyZVVzZXIoY3R4KTtcbiAgICAgICAgICBjb25zdCBjYW1wYWlnbklkID0gU3RyaW5nKGFyZ3MuY2FtcGFpZ25JZCk7XG5cbiAgICAgICAgICBjb25zdCBjYW1wYWlnbiA9IGF3YWl0IGN0eC5kYXRhU291cmNlLmdldENhbXBhaWduQnlJZChjYW1wYWlnbklkKTtcbiAgICAgICAgICBpZiAoIWNhbXBhaWduKSB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdDYW1wYWlnbiBub3QgZm91bmQnKTtcblxuICAgICAgICAgIGF3YWl0IGN0eC5kYXRhU291cmNlLmFkZFVzZXJUb0NhbXBhaWduKHsgdXNlcklkOiB1c2VyLmlkLCBjYW1wYWlnbklkIH0pO1xuICAgICAgICAgIHJldHVybiBjYW1wYWlnbjtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVDYW1wYWlnbkludml0ZTogYXN5bmMgKFxuICAgICAgICAgIF9wYXJlbnQ6IHVua25vd24sXG4gICAgICAgICAgYXJnczogeyBjYW1wYWlnbklkOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmcgfSxcbiAgICAgICAgICBjdHg6IFlvZ2FDb250ZXh0LFxuICAgICAgICApID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVxdWlyZVVzZXIoY3R4KTtcbiAgICAgICAgICBjb25zdCBjYW1wYWlnbklkID0gU3RyaW5nKGFyZ3MuY2FtcGFpZ25JZCk7XG4gICAgICAgICAgY29uc3QgZW1haWwgPSBhcmdzLmVtYWlsLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgICAgaWYgKCFpc1ZhbGlkRW1haWwoZW1haWwpKSB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdJbnZhbGlkIGVtYWlsJyk7XG5cbiAgICAgICAgICBjb25zdCByb2xlID0gYXdhaXQgY3R4LmRhdGFTb3VyY2UuZ2V0Q2FtcGFpZ25NZW1iZXJzaGlwUm9sZSh7IHVzZXJJZDogdXNlci5pZCwgY2FtcGFpZ25JZCB9KTtcbiAgICAgICAgICBpZiAocm9sZSAhPT0gJ09XTkVSJykgdGhyb3cgbmV3IEdyYXBoUUxFcnJvcignTm90IGF1dGhvcml6ZWQnKTtcblxuICAgICAgICAgIGNvbnN0IHR0bE1zID0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDA7XG4gICAgICAgICAgY29uc3QgaW52aXRlID0gYXdhaXQgY3R4LmRhdGFTb3VyY2UuY3JlYXRlQ2FtcGFpZ25JbnZpdGUoeyBjYW1wYWlnbklkLCBlbWFpbCwgdHRsTXMgfSk7XG5cbiAgICAgICAgICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuQVBQX0JBU0VfVVJMID8/ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICAgICAgICAgIGNvbnN0IGludml0ZVVybCA9IGAke2Jhc2VVcmwucmVwbGFjZSgvXFwvJC8sICcnKX0vaW52aXRlP3Rva2VuPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGludml0ZS50b2tlbil9YDtcblxuICAgICAgICAgIGNvbnN0IGNhbXBhaWduID0gYXdhaXQgY3R4LmRhdGFTb3VyY2UuZ2V0Q2FtcGFpZ25CeUlkKGNhbXBhaWduSWQpO1xuICAgICAgICAgIGlmICghY2FtcGFpZ24pIHRocm93IG5ldyBHcmFwaFFMRXJyb3IoJ0NhbXBhaWduIG5vdCBmb3VuZCcpO1xuXG4gICAgICAgICAgYXdhaXQgc2VuZENhbXBhaWduSW52aXRlRW1haWwoe1xuICAgICAgICAgICAgdG86IGVtYWlsLFxuICAgICAgICAgICAgY2FtcGFpZ25OYW1lOiBjYW1wYWlnbi5uYW1lLFxuICAgICAgICAgICAgaW52aXRlVXJsLFxuICAgICAgICAgICAgZXhwaXJlc0F0SXNvOiBpbnZpdGUuZXhwaXJlc0F0LFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmV0dXJuIGludml0ZTtcbiAgICAgICAgfSxcblxuICAgICAgICBhY2NlcHRDYW1wYWlnbkludml0ZTogYXN5bmMgKF9wYXJlbnQ6IHVua25vd24sIGFyZ3M6IHsgdG9rZW46IHN0cmluZyB9LCBjdHg6IFlvZ2FDb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlciA9IHJlcXVpcmVVc2VyKGN0eCk7XG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBTdHJpbmcoYXJncy50b2tlbik7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGN0eC5kYXRhU291cmNlLmFjY2VwdENhbXBhaWduSW52aXRlKHsgdG9rZW4sIHVzZXJJZDogdXNlci5pZCwgdXNlckVtYWlsOiB1c2VyLmVtYWlsIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlID09PSAnSU5WSVRFX0VNQUlMX01JU01BVENIJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdJbnZpdGUgaXMgZm9yIGEgZGlmZmVyZW50IGVtYWlsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlID09PSAnSU5WSVRFX0VYUElSRUQnKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBHcmFwaFFMRXJyb3IoJ0ludml0ZSBoYXMgZXhwaXJlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZSA9PT0gJ0lOVklURV9BTFJFQURZX1VTRUQnKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBHcmFwaFFMRXJyb3IoJ0ludml0ZSBoYXMgYWxyZWFkeSBiZWVuIHVzZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UgPT09ICdJTlZJVEVfTk9UX0ZPVU5EJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgR3JhcGhRTEVycm9yKCdJbnZpdGUgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgQ2hhcmFjdGVyOiB7XG4gICAgICAgIGlzUHVibGljOiAoY2hhcmFjdGVyOiBDaGFyYWN0ZXJSZWNvcmQpID0+IGNoYXJhY3Rlci5pc1B1YmxpYyA/PyBmYWxzZSxcbiAgICAgICAgc3BlZWQ6IChjaGFyYWN0ZXI6IENoYXJhY3RlclJlY29yZCkgPT4gY2hhcmFjdGVyLnNwZWVkID8/IDMwLFxuICAgICAgICBoaXRQb2ludHM6IChjaGFyYWN0ZXI6IENoYXJhY3RlclJlY29yZCkgPT4gY2hhcmFjdGVyLmhpdFBvaW50cyA/PyA1LFxuICAgICAgICBjYW1wYWlnbjogYXN5bmMgKGNoYXJhY3RlcjogQ2hhcmFjdGVyUmVjb3JkLCBfYXJnczogdW5rbm93biwgY3R4OiBZb2dhQ29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhbXBhaWduSWQgPSBjaGFyYWN0ZXIuY2FtcGFpZ25JZDtcbiAgICAgICAgICBpZiAoIWNhbXBhaWduSWQpIHJldHVybiBudWxsO1xuICAgICAgICAgIHJldHVybiBjdHguZGF0YVNvdXJjZS5nZXRDYW1wYWlnbkJ5SWQoY2FtcGFpZ25JZCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXRzOiAoY2hhcmFjdGVyOiBDaGFyYWN0ZXJSZWNvcmQpOiBTdGF0c1JlY29yZCA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdHMgPSBjaGFyYWN0ZXIuc3RhdHMgPz8ge307XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJyYXduOiBzdGF0cy5icmF3biA/PyAwLFxuICAgICAgICAgICAgY2hhcm06IHN0YXRzLmNoYXJtID8/IDAsXG4gICAgICAgICAgICBpbnRlbGxpZ2VuY2U6IHN0YXRzLmludGVsbGlnZW5jZSA/PyAwLFxuICAgICAgICAgICAgcmVmbGV4ZXM6IHN0YXRzLnJlZmxleGVzID8/IDAsXG4gICAgICAgICAgICB0ZWNoOiBzdGF0cy50ZWNoID8/IDAsXG4gICAgICAgICAgICBsdWNrOiBzdGF0cy5sdWNrID8/IDAsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgc2tpbGxzOiAoY2hhcmFjdGVyOiBDaGFyYWN0ZXJSZWNvcmQpID0+IGNoYXJhY3Rlci5za2lsbHMgPz8gW10sXG4gICAgICAgIGN5YmVybmV0aWNzOiBhc3luYyAoY2hhcmFjdGVyOiBDaGFyYWN0ZXJSZWNvcmQsIF9hcmdzOiB1bmtub3duLCBjdHg6IFlvZ2FDb250ZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgYWxsQ3liZXJuZXRpY3MgPSBhd2FpdCBjdHguZGF0YVNvdXJjZS5saXN0Q3liZXJuZXRpY3MoKTtcbiAgICAgICAgICBjb25zdCBpZHMgPSBjaGFyYWN0ZXIuY3liZXJuZXRpY0lkcyA/PyBbXTtcbiAgICAgICAgICByZXR1cm4gaWRzXG4gICAgICAgICAgICAubWFwKChpZCkgPT4gYWxsQ3liZXJuZXRpY3MuZmluZCgoY3liZXJuZXRpYykgPT4gY3liZXJuZXRpYy5pZCA9PT0gaWQpKVxuICAgICAgICAgICAgLmZpbHRlcigoY3liZXJuZXRpYyk6IGN5YmVybmV0aWMgaXMgQ3liZXJuZXRpY1JlY29yZCA9PiBCb29sZWFuKGN5YmVybmV0aWMpKTtcbiAgICAgICAgfSxcbiAgICAgICAgd2VhcG9uczogYXN5bmMgKGNoYXJhY3RlcjogQ2hhcmFjdGVyUmVjb3JkLCBfYXJnczogdW5rbm93biwgY3R4OiBZb2dhQ29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFsbFdlYXBvbnMgPSBhd2FpdCBjdHguZGF0YVNvdXJjZS5saXN0V2VhcG9ucygpO1xuICAgICAgICAgIGNvbnN0IGlkcyA9IGNoYXJhY3Rlci53ZWFwb25JZHMgPz8gW107XG4gICAgICAgICAgcmV0dXJuIGlkc1xuICAgICAgICAgICAgLm1hcCgoaWQpID0+IGFsbFdlYXBvbnMuZmluZCgod2VhcG9uKSA9PiB3ZWFwb24uaWQgPT09IGlkKSlcbiAgICAgICAgICAgIC5maWx0ZXIoKHdlYXBvbik6IHdlYXBvbiBpcyBXZWFwb25SZWNvcmQgPT4gQm9vbGVhbih3ZWFwb24pKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXRlbXM6IGFzeW5jIChjaGFyYWN0ZXI6IENoYXJhY3RlclJlY29yZCwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCBhbGxJdGVtcyA9IGF3YWl0IGN0eC5kYXRhU291cmNlLmxpc3RJdGVtcygpO1xuICAgICAgICAgIGNvbnN0IGlkcyA9IGNoYXJhY3Rlci5pdGVtSWRzID8/IFtdO1xuICAgICAgICAgIHJldHVybiBpZHNcbiAgICAgICAgICAgIC5tYXAoKGlkKSA9PiBhbGxJdGVtcy5maW5kKChpdGVtKSA9PiBpdGVtLmlkID09PSBpZCkpXG4gICAgICAgICAgICAuZmlsdGVyKChpdGVtKTogaXRlbSBpcyBJdGVtUmVjb3JkID0+IEJvb2xlYW4oaXRlbSkpO1xuICAgICAgICB9LFxuICAgICAgICB2ZWhpY2xlczogYXN5bmMgKGNoYXJhY3RlcjogQ2hhcmFjdGVyUmVjb3JkLCBfYXJnczogdW5rbm93biwgY3R4OiBZb2dhQ29udGV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFsbFZlaGljbGVzID0gYXdhaXQgY3R4LmRhdGFTb3VyY2UubGlzdFZlaGljbGVzKCk7XG4gICAgICAgICAgY29uc3QgaWRzID0gY2hhcmFjdGVyLnZlaGljbGVJZHMgPz8gW107XG4gICAgICAgICAgcmV0dXJuIGlkc1xuICAgICAgICAgICAgLm1hcCgoaWQpID0+IGFsbFZlaGljbGVzLmZpbmQoKHZlaGljbGUpID0+IHZlaGljbGUuaWQgPT09IGlkKSlcbiAgICAgICAgICAgIC5maWx0ZXIoKHZlaGljbGUpOiB2ZWhpY2xlIGlzIFZlaGljbGVSZWNvcmQgPT4gQm9vbGVhbih2ZWhpY2xlKSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgQ2FtcGFpZ246IHtcbiAgICAgICAgY2hhcmFjdGVyczogYXN5bmMgKGNhbXBhaWduOiBDYW1wYWlnblJlY29yZCwgX2FyZ3M6IHVua25vd24sIGN0eDogWW9nYUNvbnRleHQpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVxdWlyZVVzZXIoY3R4KTtcbiAgICAgICAgICBjb25zdCB2aXNpYmxlQ2hhcmFjdGVycyA9IGF3YWl0IGN0eC5kYXRhU291cmNlLmxpc3RDaGFyYWN0ZXJzRm9yVXNlcih1c2VyLmlkKTtcbiAgICAgICAgICByZXR1cm4gdmlzaWJsZUNoYXJhY3RlcnMuZmlsdGVyKChjaGFyYWN0ZXIpID0+IGNoYXJhY3Rlci5jYW1wYWlnbklkID09PSBjYW1wYWlnbi5pZCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgQ3liZXJuZXRpYzoge1xuICAgICAgICBzdGF0Qm9udXNlczogKGN5YmVybmV0aWM6IEN5YmVybmV0aWNSZWNvcmQpID0+IGN5YmVybmV0aWMuc3RhdEJvbnVzZXMgPz8gW10sXG4gICAgICAgIHNraWxsQm9udXNlczogKGN5YmVybmV0aWM6IEN5YmVybmV0aWNSZWNvcmQpID0+IGN5YmVybmV0aWMuc2tpbGxCb251c2VzID8/IFtdLFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcblxuICByZXR1cm4gY3JlYXRlWW9nYSh7XG4gICAgc2NoZW1hLFxuICAgIGdyYXBocWxFbmRwb2ludDogJy9hcGkvZ3JhcGhxbCcsXG4gICAgY29udGV4dDogYXN5bmMgKHsgcmVxdWVzdCB9KSA9PiAoeyBkYXRhU291cmNlLCB1c2VyOiBhd2FpdCBnZXRVc2VyRnJvbVJlcXVlc3QocmVxdWVzdCksIGh0dHBIZWFkZXJzOiB7fSB9KSxcbiAgICBtYXNrZWRFcnJvcnM6IGZhbHNlLFxuICAgIHBsdWdpbnM6IFtcbiAgICAgIHtcbiAgICAgICAgYXN5bmMgb25SZXF1ZXN0KHsgcmVxdWVzdCwgZW5kUmVzcG9uc2UgfSkge1xuICAgICAgICAgIGlmICghKGF3YWl0IGlzR3JhcGhRTE11dGF0aW9uUmVxdWVzdChyZXF1ZXN0KSkpIHJldHVybjtcblxuICAgICAgICAgIGNvbnN0IGhlYWRlck9yaWdpbiA9IGdldEhlYWRlck9yaWdpblZhbHVlKHJlcXVlc3QpO1xuICAgICAgICAgIGNvbnN0IGFsbG93ZWQgPSBnZXRFeHBlY3RlZE9yaWdpbnNGb3JSZXF1ZXN0KHJlcXVlc3QpO1xuXG4gICAgICAgICAgLy8gRW5mb3JjZSBPcmlnaW4vUmVmZXJlciBjaGVja3MgZm9yIG11dGF0aW9uIHJlcXVlc3RzIHRvIG1pdGlnYXRlIENTUkYuXG4gICAgICAgICAgaWYgKCFoZWFkZXJPcmlnaW4pIHtcbiAgICAgICAgICAgIC8vIEJyb3dzZXJzIGluY2x1ZGUgT3JpZ2luIGZvciBmZXRjaCBQT1NUczsgbWlzc2luZyBPcmlnaW4gaXMgc3VzcGljaW91cyBpbiBwcm9kdWN0aW9uLlxuICAgICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgICAgZW5kUmVzcG9uc2UobmV3IFJlc3BvbnNlKCdGb3JiaWRkZW4nLCB7IHN0YXR1czogNDAzIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWFsbG93ZWQuaGFzKGhlYWRlck9yaWdpbikpIHtcbiAgICAgICAgICAgIGVuZFJlc3BvbnNlKG5ldyBSZXNwb25zZSgnRm9yYmlkZGVuJywgeyBzdGF0dXM6IDQwMyB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgb25FeGVjdXRpb25SZXN1bHQoeyByZXN1bHQsIHNldFJlc3VsdCwgY29udGV4dCB9KSB7XG4gICAgICAgICAgY29uc3QgaHR0cEhlYWRlcnMgPSAoY29udGV4dCBhcyB1bmtub3duIGFzIFlvZ2FDb250ZXh0KS5odHRwSGVhZGVycztcbiAgICAgICAgICBpZiAoIWh0dHBIZWFkZXJzIHx8IE9iamVjdC5rZXlzKGh0dHBIZWFkZXJzKS5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XG4gICAgICAgICAgY29uc3QgaXNBc3luY0l0ZXJhYmxlID0gdHlwZW9mIChyZXN1bHQgYXMgYW55KVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPT09ICdmdW5jdGlvbic7XG4gICAgICAgICAgaWYgKGlzQXN5bmNJdGVyYWJsZSkgcmV0dXJuO1xuXG4gICAgICAgICAgY29uc3QgcmVzID0gcmVzdWx0IGFzIGFueTtcbiAgICAgICAgICBjb25zdCBuZXh0ID0ge1xuICAgICAgICAgICAgLi4ucmVzLFxuICAgICAgICAgICAgZXh0ZW5zaW9uczoge1xuICAgICAgICAgICAgICAuLi4ocmVzLmV4dGVuc2lvbnMgPz8ge30pLFxuICAgICAgICAgICAgICBodHRwOiB7XG4gICAgICAgICAgICAgICAgLi4uKHJlcy5leHRlbnNpb25zPy5odHRwID8/IHt9KSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAuLi4ocmVzLmV4dGVuc2lvbnM/Lmh0dHA/LmhlYWRlcnMgPz8ge30pLFxuICAgICAgICAgICAgICAgICAgLi4uaHR0cEhlYWRlcnMsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICBzZXRSZXN1bHQobmV4dCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVNjaGVtYSIsImNyZWF0ZVlvZ2EiLCJHcmFwaFFMRXJyb3IiLCJjcmVhdGVEYXRhU291cmNlIiwiaGFzaFBhc3N3b3JkIiwiaXNWYWxpZEVtYWlsIiwiaXNzdWVBdXRoVG9rZW4iLCJ2ZXJpZnlBdXRoVG9rZW4iLCJ2ZXJpZnlQYXNzd29yZCIsInNlbmRDYW1wYWlnbkludml0ZUVtYWlsIiwiY3JlYXRlWW9nYVNlcnZlciIsImRhdGFTb3VyY2UiLCJTRVNTSU9OX0NPT0tJRV9OQU1FIiwicGFyc2VDb29raWVzIiwiY29va2llSGVhZGVyIiwib3V0IiwicGFydCIsInNwbGl0IiwidHJpbW1lZCIsInRyaW0iLCJlcSIsImluZGV4T2YiLCJrZXkiLCJzbGljZSIsInZhbHVlIiwiZ2V0VG9rZW5Gcm9tUmVxdWVzdCIsInJlcXVlc3QiLCJoZWFkZXJzIiwiZ2V0IiwiY29va2llcyIsImZyb21Db29raWUiLCJnZXRFeHBlY3RlZE9yaWdpbnNGb3JSZXF1ZXN0IiwiYWxsb3dlZCIsIlNldCIsImFkZCIsIlVSTCIsInVybCIsIm9yaWdpbiIsImFwcEJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiQVBQX0JBU0VfVVJMIiwiZ2V0SGVhZGVyT3JpZ2luVmFsdWUiLCJyZWZlcmVyIiwiaXNHcmFwaFFMTXV0YXRpb25SZXF1ZXN0IiwibWV0aG9kIiwidG9VcHBlckNhc2UiLCJjb250ZW50VHlwZSIsInRlc3QiLCJjbG9uZWQiLCJjbG9uZSIsImJvZHkiLCJqc29uIiwicXVlcnkiLCJidWlsZFNlc3Npb25Db29raWUiLCJ0b2tlbiIsIm5vd01zIiwiRGF0ZSIsIm5vdyIsInBheWxvYWRCNjQiLCJtYXhBZ2VTZWNvbmRzIiwicGF5bG9hZEpzb24iLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiZXhwIiwiZGVsdGFNcyIsIk1hdGgiLCJtYXgiLCJmbG9vciIsInBhcnRzIiwicHVzaCIsImpvaW4iLCJjbGVhclNlc3Npb25Db29raWUiLCJyZXF1aXJlVXNlciIsImN0eCIsInVzZXIiLCJnZXRVc2VyRnJvbVJlcXVlc3QiLCJzZWNyZXQiLCJBVVRIX1NFQ1JFVCIsInVzZXJJZCIsImdldFVzZXJCeUlkIiwic2NoZW1hIiwidHlwZURlZnMiLCJyZXNvbHZlcnMiLCJRdWVyeSIsImNoYXJhY3RlcnMiLCJfcGFyZW50IiwiX2FyZ3MiLCJsaXN0Q2hhcmFjdGVyc0ZvclVzZXIiLCJpZCIsImNhbXBhaWducyIsImxpc3RDYW1wYWlnbnNGb3JVc2VyIiwib3duZXJDYW1wYWlnbnMiLCJvd25lZCIsImNhbXBhaWduIiwicm9sZSIsImdldENhbXBhaWduTWVtYmVyc2hpcFJvbGUiLCJjYW1wYWlnbklkIiwiY3liZXJuZXRpY3MiLCJsaXN0Q3liZXJuZXRpY3MiLCJ3ZWFwb25zIiwibGlzdFdlYXBvbnMiLCJpdGVtcyIsImxpc3RJdGVtcyIsInZlaGljbGVzIiwibGlzdFZlaGljbGVzIiwibWUiLCJNdXRhdGlvbiIsInJlZ2lzdGVyIiwiYXJncyIsImVtYWlsIiwidG9Mb3dlckNhc2UiLCJwYXNzd29yZCIsImxlbmd0aCIsImV4aXN0aW5nIiwiZmluZFVzZXJCeUVtYWlsIiwicGFzc3dvcmRIYXNoIiwiY3JlYXRlVXNlciIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwiaHR0cEhlYWRlcnMiLCJsb2dpbiIsIm9rIiwibG9nb3V0Iiwiam9pbkNhbXBhaWduIiwiU3RyaW5nIiwiZ2V0Q2FtcGFpZ25CeUlkIiwiYWRkVXNlclRvQ2FtcGFpZ24iLCJjcmVhdGVDYW1wYWlnbkludml0ZSIsInR0bE1zIiwiaW52aXRlIiwiYmFzZVVybCIsImludml0ZVVybCIsInJlcGxhY2UiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ0byIsImNhbXBhaWduTmFtZSIsIm5hbWUiLCJleHBpcmVzQXRJc28iLCJleHBpcmVzQXQiLCJhY2NlcHRDYW1wYWlnbkludml0ZSIsInVzZXJFbWFpbCIsIkNoYXJhY3RlciIsImlzUHVibGljIiwiY2hhcmFjdGVyIiwic3BlZWQiLCJoaXRQb2ludHMiLCJzdGF0cyIsImJyYXduIiwiY2hhcm0iLCJpbnRlbGxpZ2VuY2UiLCJyZWZsZXhlcyIsInRlY2giLCJsdWNrIiwic2tpbGxzIiwiYWxsQ3liZXJuZXRpY3MiLCJpZHMiLCJjeWJlcm5ldGljSWRzIiwibWFwIiwiZmluZCIsImN5YmVybmV0aWMiLCJmaWx0ZXIiLCJCb29sZWFuIiwiYWxsV2VhcG9ucyIsIndlYXBvbklkcyIsIndlYXBvbiIsImFsbEl0ZW1zIiwiaXRlbUlkcyIsIml0ZW0iLCJhbGxWZWhpY2xlcyIsInZlaGljbGVJZHMiLCJ2ZWhpY2xlIiwiQ2FtcGFpZ24iLCJ2aXNpYmxlQ2hhcmFjdGVycyIsIkN5YmVybmV0aWMiLCJzdGF0Qm9udXNlcyIsInNraWxsQm9udXNlcyIsImdyYXBocWxFbmRwb2ludCIsImNvbnRleHQiLCJtYXNrZWRFcnJvcnMiLCJwbHVnaW5zIiwib25SZXF1ZXN0IiwiZW5kUmVzcG9uc2UiLCJoZWFkZXJPcmlnaW4iLCJSZXNwb25zZSIsInN0YXR1cyIsImhhcyIsIm9uRXhlY3V0aW9uUmVzdWx0IiwicmVzdWx0Iiwic2V0UmVzdWx0IiwiT2JqZWN0Iiwia2V5cyIsImlzQXN5bmNJdGVyYWJsZSIsIlN5bWJvbCIsImFzeW5jSXRlcmF0b3IiLCJyZXMiLCJuZXh0IiwiZXh0ZW5zaW9ucyIsImh0dHAiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/graphql/yoga.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:events");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:http":
/*!****************************!*\
  !*** external "node:http" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:http");

/***/ }),

/***/ "node:https":
/*!*****************************!*\
  !*** external "node:https" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:https");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/promises":
/*!***************************************!*\
  !*** external "node:stream/promises" ***!
  \***************************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream/promises");

/***/ }),

/***/ "node:tls":
/*!***************************!*\
  !*** external "node:tls" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:tls");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:url");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:util");

/***/ }),

/***/ "node:zlib":
/*!****************************!*\
  !*** external "node:zlib" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:zlib");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/nodemailer","vendor-chunks/graphql","vendor-chunks/@graphql-tools","vendor-chunks/@whatwg-node","vendor-chunks/graphql-yoga","vendor-chunks/lru-cache","vendor-chunks/@fastify","vendor-chunks/@envelop","vendor-chunks/urlpattern-polyfill","vendor-chunks/tslib","vendor-chunks/cross-inspect","vendor-chunks/@graphql-yoga"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fgraphql%2Froute&page=%2Fapi%2Fgraphql%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgraphql%2Froute.ts&appDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftaylorwofford%2FDesktop%2Fcyberdallas_2069&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();